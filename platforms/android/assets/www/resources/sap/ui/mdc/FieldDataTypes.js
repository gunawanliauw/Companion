/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global'],function(q){"use strict";var D={};D.enrich=function(f,d){if(f._sEnrichedDataType&&f._sEnrichedDataType!=d){this.initialize(f);}else if(f._sEnrichedDataType==d){return;}f._sEnrichedDataType=d;function _(n,u){var O=this._vInternalValue;var i=q(this.$().children("input"));var c=i.cursorPos();var C=b.call(this);this._checkInternalValue(O);if(O&&this.getEditable()){var e=U.getInstance(new Date(O.getTime()),C);O=U.getInstance(new Date(O.getTime()),C);switch(u){case"day":e.setDate(e.getDate()+n);break;case"month":e.setMonth(e.getMonth()+n);var m=(O.getMonth()+n)%12;if(m<0){m=12+m;}while(e.getMonth()!=m){e.setDate(e.getDate()-1);}break;case"year":e.setFullYear(e.getFullYear()+n);while(e.getMonth()!=O.getMonth()){e.setDate(e.getDate()-1);}break;default:break;}if(!q.sap.equal(this._vInternalValue,e.getJSDate())){this._setInternalValue(new Date(e.getTime()),false);i.cursorPos(c);}}}function a(){var O=this.getDataTypeOptions();if(!O){O=o;}return O;}function b(){var O=a.call(this);var B=this.getBinding("value");if(B&&B.oType&&B.oType.oFormatOptions){return B.oType.oFormatOptions.calendarType;}else{return O.externalType;}}switch(d){case"Date":var o={style:"medium",internalPattern:"yyyy-MM-dd",internalType:sap.ui.core.CalendarType.Gregorian};q.sap.require("sap.ui.model.type.Date");q.sap.require("sap.ui.core.date.UniversalDate");var U=sap.ui.core.date.UniversalDate;f.parseValue=function(v){var c=v;var B=this.getBinding("value");if(B&&B.oType&&B.oType.oOutputFormat){c=B.oType.oOutputFormat.parse(v);}else{var O=a.call(this);var F=sap.ui.core.format.DateFormat.getInstance({style:O.style,pattern:O.pattern,calendarType:O.externalType,strictParsing:true});c=F.parse(v);}return c;};f.formatValue=function(c){this._checkInternalValue(c);var F;var B=this.getBinding("value");if(B&&B.oType&&B.oType.formatValue){F=B.oType.formatValue(c,B.sInternalType);}else{var O=a.call(this);var e=sap.ui.core.format.DateFormat.getInstance({style:O.style,pattern:O.pattern,calendarType:O.externalType,strictParsing:true});F=e.format(c);}return F;};f._orgDetermineInternalValue=f._determineInternalValue;f._determineInternalValue=function(v){var i=this._orgDetermineInternalValue.apply(this,arguments);if(typeof i=="string"){var O=a.call(this);var F=sap.ui.core.format.DateFormat.getInstance({style:O.style,pattern:O.pattern,calendarType:O.internalType,strictParsing:true});i=F.parse(i);}this._checkInternalValue(i);return i;};f._orgDetermineExternalValue=f._determineExternalValue;f._determineExternalValue=function(i){this._checkInternalValue(i);var e=this._orgDetermineExternalValue.apply(this,arguments);if(e instanceof Date){var O=a.call(this);if(O.internalPattern||O.internalStyle){var F=sap.ui.core.format.DateFormat.getInstance({style:O.internalStyle,pattern:O.internalPattern,calendarType:O.internalType,strictParsing:true});e=F.format(e);}}return e;};f._checkInternalValue=function(i){if(i&&!(i instanceof Date)){throw new Error("internalValue must be a JS-Date object "+this);}return this;};f._orgOnsappageup=f.onsappageup;f.onsappageup=function(e){_.call(this,1,"day");e.preventDefault();};f._orgOnsappageupmodifiers=f.onsappageupmodifiers;f.onsappageupmodifiers=function(e){if(!e.ctrlKey&&e.shiftKey){_.call(this,1,"month");}else{_.call(this,1,"year");}e.preventDefault();};f._orgOnsappagedown=f.onsappagedown;f.onsappagedown=function(e){_.call(this,-1,"day");e.preventDefault();};f._orgOnsappagedownmodifiers=f.onsappagedownmodifiers;f.onsappagedownmodifiers=function(e){if(!e.ctrlKey&&e.shiftKey){_.call(this,-1,"month");}else{_.call(this,-1,"year");}e.preventDefault();};f._orgGetDataTypeOptionsForFieldHelp=f._getDataTypeOptionsForFieldHelp;f._getDataTypeOptionsForFieldHelp=function(){var F={};var c=b.call(this);if(c){F.calendarType=c;}return F;};f._orgGetDefaultPlaceholder=f._getDefaultPlaceholder;f._getDefaultPlaceholder=function(){var p;var B=this.getBinding("value");if(B&&B.oType&&B.oType.oFormatOptions){p=B.oType.getOutputPattern();}else{var O=a.call(this);if(O.style){var l=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale();var L=sap.ui.core.LocaleData.getInstance(l);p=L.getDatePattern(O.style);}else{p=O.pattern;}}return p;};break;default:break;}};D.initialize=function(f){if(f._sEnrichedDataType){f._sEnrichedDataType=undefined;}if(f._orgDetermineExternalValue){f._determineExternalValue=f._orgDetermineExternalValue;f._orgDetermineExternalValue=undefined;}if(f._orgDetermineInternalValue){f._determineInternalValue=f._orgDetermineInternalValue;f._orgDetermineInternalValue=undefined;}if(f.parseValue){f.parseValue=undefined;}if(f.formatValue){f.formatValue=undefined;}if(f._checkInternalValue){f._checkInternalValue=undefined;}if(f._orgOnsappageup){f.onsappageup=f._orgOnsappageup;f._orgOnsappageup=undefined;}if(f._orgOnsappageupmodifiers){f.onsappageupmodifiers=f._orgOnsappageupmodifiers;f._orgOnsappageupmodifiers=undefined;}if(f._orgOnsappagedown){f.onsappagedown=f._orgOnsappagedown;f._orgOnsappagedown=undefined;}if(f._orgOnsappagedownmodifiers){f.onsappagedownmodifiers=f._orgOnsappagedownmodifiers;f._orgOnsappagedownmodifiers=undefined;}if(f._orgGetDataTypeOptionsForFieldHelp){f._getDataTypeOptionsForFieldHelp=f._orgGetDataTypeOptionsForFieldHelp;f._orgGetDataTypeOptionsForFieldHelp=undefined;}if(f._orgGetDefaultPlaceholder){f._getDefaultPlaceholder=f._orgGetDefaultPlaceholder;f._orgGetDefaultPlaceholder=undefined;}};D.enrichFieldHelp=function(f,d){if(f._sEnrichedDataType==d){return;}f._sEnrichedDataType=d;switch(d){case"Date":f._extendOpen=function(){var c=this._oPopover.getContent()[0];if(c.focusDate){var o=this._oPopover.getModel("$fieldHelp").getProperty("/currentValue");if(!o){o=new Date();}c.focusDate(o);c.setPopupMode=true;var O=this.getDataTypeOptions();if(O.calendarType){c.setPrimaryCalendarType(O.calendarType);}else if(c.getPrimaryCalendarType()){c.setPrimaryCalendarType();}}};f._checkCurrentValue=function(c){if(c&&!(c instanceof Date)){throw new Error("currentValue must be a JS-Date object "+this);}return this;};break;default:break;}};return D;},true);
