/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(["./ModelAdapter"],function(M){"use strict";var O=M.extend("sap.ui.mdc.experimental.provider.model.ODataAdapter",{_schemaCache:{},constructor:function(m,s,a){M.prototype.constructor.apply(this,arguments);}});O.prototype.afterMetaContextSwitch=function(m){if(!this._schemaCache[m]){this._schemaCache[m]=this.oMetaModel.getProperty(m);this.schema=this._schemaCache[m];this._precalucateFieldControl();}else{this.schema=this._schemaCache[m];}};O.prototype.ui5Type=function(){if(this.oMetaModel.getUI5Type){return this.oMetaModel.getUI5Type(this.sMetaContext);}switch(this.schema.type){case"Edm.Boolean":return"sap.ui.model.odata.type.Boolean";case"Edm.Byte":return"sap.ui.model.odata.type.Byte";case"Edm.Date":return"sap.ui.model.odata.type.Date";case"Edm.DateTimeOffset":return"sap.ui.model.odata.type.DateTimeOffset";case"Edm.Decimal":return"sap.ui.model.odata.type.Decimal";case"Edm.Double":return"sap.ui.model.odata.type.Double";case"Edm.Guid":return"sap.ui.model.odata.type.Guid";case"Edm.Int16":return"sap.ui.model.odata.type.Int16";case"Edm.Int32":return"sap.ui.model.odata.type.Int32";case"Edm.Int64":return"sap.ui.model.odata.type.Int64";case"Edm.SByte":return"sap.ui.model.odata.type.SByte";case"Edm.Single":return"sap.ui.model.odata.type.Single";case"Edm.String":return"sap.ui.model.odata.type.String";case"Edm.TimeOfDay":return"sap.ui.model.odata.type.TimeOfDay";default:return"sap.ui.model.odata.type.String";}};O.prototype.eMail=function(){return this._getAnnotation("com.sap.vocabularies.Communication.v1.IsEmailAddress")!=null;};O.prototype.password=function(){return this._getAnnotation("com.sap.vocabularies.Common.v1.Masked")!=null;};O.prototype.phoneNumber=function(){return this._getAnnotation("com.sap.vocabularies.Communication.v1.IsPhoneNumber")!=null;};O.prototype.url=function(){return this._getAnnotation("com.sap.vocabularies.Communication.v1.IsUrl")!=null;};O.prototype.visible=function(){var h=this._isAnnotationBoolean("com.sap.vocabularies.UI.v1.Hidden");var v=h?!h:true;if(v&&this.schema._fieldControl){v=this.schema._fieldControl.visible;}return v;};O.prototype.hidden=function(){var h=this._isAnnotationBoolean("com.sap.vocabularies.UI.v1.Hidden");var H=h?h:false;if(!H&&this.schema._fieldControl){H=this.schema._fieldControl.hidden;}return H;};O.prototype.enabled=function(){var u=this._getAnnotation("Org.OData.Core.V1.Immutable/Bool")||this._getAnnotation("Org.OData.Core.V1.Computed/Bool");var e=u?u=="false":true;if(e&&this.schema._fieldControl){e=this.schema._fieldControl.editable;}return e;};O.prototype.disabled=function(){var u=this._getAnnotation("Org.OData.Core.V1.Immutable/Bool")||this._getAnnotation("Org.OData.Core.V1.Computed/Bool");var d=u?u=="true":false;if(!d&&this.schema._fieldControl){d=this.schema._fieldControl.readonly;}return d;};O.prototype.required=function(){var r=this._getAnnotation("nullable");var R=r?r=="false":false;if(this.schema._fieldControl){R=this.schema._fieldControl.required;}else{R=R&&this.enabled;}return R;};O.prototype.tooltip=function(){return this._getAnnotation("com.sap.vocabularies.Common.v1.QuickInfo/String");};O.prototype.label=function(){return this._getAnnotation("com.sap.vocabularies.Common.v1.Label/String");};O.prototype._getAnnotation=function(a){var A=this.schema;var p=a.split("/");var i=0;while(A&&p[i]){A=A[p[i]];i++;}return A;};O.prototype._isAnnotationBoolean=function(a){var A=this._getAnnotation(a);var i=false;if(A!=null){i=A.Bool?(A.Bool=="true"):true;}return i;};O.prototype._precalucateFieldControl=function(){var f=this._getAnnotation("com.sap.vocabularies.Common.v1.FieldControl");if(f){var a={};this._schemaCache[this.sMetaContext]._fieldControl=a;if(f.EnumMember){switch(f.EnumMember){case"com.sap.vocabularies.Common.v1.FieldControlType/Hidden":a.visible=false;a.hidden=true;a.editable=false;a.readonly=true;a.required=false;break;case"com.sap.vocabularies.Common.v1.FieldControlType/Mandatory":a.visible=true;a.hidden=false;a.editable=true;a.readonly=false;a.required=true;break;case"com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly":a.visible=true;a.hidden=false;a.editable=false;a.readonly=true;a.required=false;break;default:a.visible=true;a.hidden=false;a.editable=true;a.readonly=true;a.required=false;break;}}else{var p=f.Path;if(this.getModelName()){p=this.getModelName()+">"+p;}a.visible="{= ${"+p+"} !== 0}";a.hidden="{= ${"+p+"} === 0}";a.editable="{= ${"+p+"} !== 1}";a.readonly="{= ${"+p+"} === 1}";a.required="{= ${"+p+"} === 7}";}}};return O;});
