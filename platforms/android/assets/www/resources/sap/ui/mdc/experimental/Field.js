/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','sap/ui/core/Control','sap/ui/model/base/ManagedObjectModel','sap/ui/model/BindingMode','sap/m/Input','sap/m/Text'],function(q,C,M,B,I,T){"use strict";var D;var F=C.extend("sap.ui.mdc.experimental.Field",{metadata:{interfaces:["sap.ui.core.IFormContent"],library:"sap.ui.mdc",properties:{value:{type:"any",defaultValue:null},additionalValue:{type:"any",defaultValue:null},dataType:{type:"string",group:"Data",defaultValue:'sap.ui.model.type.String'},dataTypeConstraints:{type:"object",group:"Data",defaultValue:null},dataTypeFormatOptions:{type:"object",group:"Data",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:""},editMode:{type:"sap.ui.mdc.EditMode",group:"Data",defaultValue:sap.ui.mdc.EditMode.Editable},required:{type:"boolean",group:"Data",defaultValue:false},icon:{type:"sap.ui.core.URI",group:"Appearance",defaultValue:null},display:{type:"sap.ui.mdc.FieldDisplay",defaultValue:sap.ui.mdc.FieldDisplay.Value},textAlign:{type:"sap.ui.core.TextAlign",group:"Appearance",defaultValue:sap.ui.core.TextAlign.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:sap.ui.core.TextDirection.Inherit},placeholder:{type:"string",group:"Misc",defaultValue:null},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:sap.ui.core.ValueState.None},valueStateText:{type:"string",group:"Misc",defaultValue:null}},events:{validate:{},change:{parameters:{value:{type:"string"},valid:{type:"boolean"}}},dataChanged:{}},aggregations:{content:{type:"sap.ui.core.Control",multiple:false},_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},publicMethods:[],defaultAggregation:"content",defaultProperty:"value"},_oManagedObjectModel:null});F.prototype.init=function(){this._oManagedObjectModel=new M(this);};F.prototype.exit=function(){this._oManagedObjectModel.destroy();delete this._oManagedObjectModel;};F.prototype.onBeforeRendering=function(){_.call(this);};F.formatText=c;function _(){if(!this._getContent()){var E=this.getEditMode();var s=this.getDataType();var o;var i=this.getId()+"-inner";switch(E){case sap.ui.mdc.EditMode.Display:switch(s){case"Edm.DateTimeOffset":o=new T(i,{text:{path:"$field>value",type:this._getDataType()},textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}"});break;default:o=new T(i,{text:{parts:[{path:"$field>value"},{path:"$field>additionalValue"},{path:"$field>display"}],formatter:c},textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}"});break;}break;default:switch(s){case"Edm.DateTimeOffset":o=f.call(this,i);break;default:o=new I(i,{value:"{$field>value}",placeholder:"{$field>placeholder}",textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}",required:"{$field>required}",editable:{path:"$field>editMode",formatter:a},enabled:{path:"$field>editMode",formatter:b},valueState:"{$field>valueState}",valueStateText:"{$field>valueStateText}",change:h.bind(this)});break;}break;}if(o){this.setAggregation("_content",o,true);g.call(this,o);}}}F.prototype._getContent=function(){return this.getContent()||this.getAggregation("_content");};function a(E){if(E&&E==sap.ui.mdc.EditMode.Editable){return true;}else{return false;}}function b(E){if(E&&E!=sap.ui.mdc.EditMode.Disabled){return true;}else{return false;}}function c(v,A,s){switch(s){case sap.ui.mdc.FieldDisplay.Description:return A;case sap.ui.mdc.FieldDisplay.ValueDescription:return v+(A?" ("+A+")":"");case sap.ui.mdc.FieldDisplay.DescriptionValue:return(A?A:"")+" ("+v+")";default:return v;}}function d(D,i){var o=new D(i,{value:{path:"$field>value",type:this._getDataType()},placeholder:"{$field>placeholder}",textAlign:"{$field>textAlign}",textDirection:"{$field>textDirection}",required:"{$field>required}",editable:{path:"$field>editMode",formatter:a},enabled:{path:"$field>editMode",formatter:b},valueState:"{$field>valueState}",valueStateText:"{$field>valueStateText}",change:h.bind(this)});return o;}function e(D){var i=this.getId()+"-inner";var o=d.call(this,D,i);this.setAggregation("_content",o);g.call(this,o);}function f(i){if(!D){D=sap.ui.require("sap/m/DatePicker");if(!D){sap.ui.require(["sap/m/DatePicker"],e.bind(this));return null;}}return d.call(this,D,i);}function g(o){o.setModel(this._oManagedObjectModel,"$field");o.bindElement({path:"/",model:"$field"});}F.prototype.setEditMode=function(E){var o=this.getEditMode();if(o!=E){if(this.getAggregation("_content")){this.destroyAggregation("_content");}this.setProperty("editMode",E);_.call(this);}return this;};F.prototype.setContent=function(o){var O=this.getContent();if(O){O.unbindElement("$field");if(O.getMetadata().getEvents().change){O.detachEvent("change",h,this);}}if(this.getAggregation("_content")){this.destroyAggregation("_content");}this.setAggregation("content",o);if(o){g.call(this,o);if(o.getMetadata().getEvents().change){o.attachEvent("change",h,this);}}else{_.call(this);}return this;};F.prototype.destroyContent=function(){var o=this.getContent();if(o){o.unbindElement("$field");if(o.getMetadata().getEvents().change){o.detachEvent("change",h,this);}}this.destroyAggregation("content");_.call(this);return this;};F.prototype.getIdForLabel=function(){var i;var o=this._getContent();if(o){i=o.getId();}else{i=this.getId();}return i;};F.prototype.updateModelProperty=function(n,v,o){if(this.isBound(n)){var i=this.getBinding(n);if(i&&i.getBindingMode()===B.TwoWay){var t=typeof v;if(t==="string"){i.sInternalType="string";}else if(t==="number"){i.sInternalType="float";}else if(v instanceof Date){i.sInternalType="string";}}}return C.prototype.updateModelProperty.apply(this,arguments);};function h(E){var v=this.getValue();var V=true;if("valid"in E.getParameters()){V=E.getParameter("valid");}this.fireChange({value:v,valid:V});}F.prototype.getFocusDomRef=function(){var o=this._getContent();if(o){return o.getFocusDomRef();}else{return this.getDomRef();}};F.prototype.setDataType=function(v){delete this._oDataType;this.setProperty("dataType",v,true);};F.mapEdmTypes={"Edm.Boolean":"sap.ui.model.odata.type.Boolean","Edm.Byte":"sap.ui.model.odata.type.Byte","Edm.Date":"sap.ui.model.odata.type.Date","Edm.DateTime":"sap.ui.model.odata.type.DateTime","Edm.DateTimeOffset":"sap.ui.model.odata.type.DateTimeOffset","Edm.Decimal":"sap.ui.model.odata.type.Decimal","Edm.Double":"sap.ui.model.odata.type.Double","Edm.Float":"sap.ui.model.odata.type.Single","Edm.Guid":"sap.ui.model.odata.type.Guid","Edm.Int16":"sap.ui.model.odata.type.Int16","Edm.Int32":"sap.ui.model.odata.type.Int32","Edm.Int64":"sap.ui.model.odata.type.Int64","Edm.SByte":"sap.ui.model.odata.type.SByte","Edm.Single":"sap.ui.model.odata.type.Single","Edm.String":"sap.ui.model.odata.type.String","Edm.Time":"sap.ui.model.odata.type.Time","Edm.TimeOfDay":"sap.ui.model.odata.type.TimeOfDay"};F.prototype._createDataType=function(t){var O=q.sap.getObject(t);if(!O){var n=F.mapEdmTypes[t];if(!n){q.sap.log.error("Field","dataType for "+t+" can not be created!");return null;}return this._createDataType(n);}return new O(this.getDataTypeFormatOptions(),this.getDataTypeConstraints());};F.prototype._getDataType=function(t){if(!this._oDataType){this._oDataType=this.getProperty("dataType");if(typeof this._oDataType==="string"){this._oDataType=this._createDataType(this._oDataType);}}return this._oDataType;};return F;},true);
