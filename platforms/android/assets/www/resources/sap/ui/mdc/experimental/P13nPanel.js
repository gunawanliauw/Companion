/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(['jquery.sap.global','sap/m/library','sap/ui/core/FragmentControl','./P13nPanelFormatter'],function(q,M,F,P){"use strict";var a=F.extend("sap.ui.mdc.experimental.P13nPanel",{formatter:P,metadata:{"abstract":true,library:"sap.ui.mdc",defaultAggregation:"items",aggregations:{items:{type:"sap.ui.mdc.experimental.P13nItem",multiple:true,singularName:"item"}}}});a.prototype.init=function(){this.setModel(new sap.ui.model.resource.ResourceModel({bundleUrl:sap.ui.getCore().getLibraryResourceBundle("sap.m").oUrlInfo.url}),"i18n");this._proxyOnModelContextChange=q.proxy(this._onModelContextChange,this);this.attachModelContextChange(this._proxyOnModelContextChange);};a.prototype._onModelContextChange=function(){if(!this.getModel()){return;}this.detachModelContextChange(this._proxyOnModelContextChange);this._updateCounts();this._updateControlLogic();};a.prototype.onSearchFieldLiveChange=function(e){this._filterTableItems();this._updateControlLogic();};a.prototype.onItemPressed=function(){this._updateControlLogic();};a.prototype.onSelectionChange=function(){this._updateCounts();this._updateControlLogic();};a.prototype._filterTableItems=function(){var f=[];var s=this._getSearchText();if(s){f.push(new sap.ui.model.Filter([new sap.ui.model.Filter("text",sap.ui.model.FilterOperator.Contains,s),new sap.ui.model.Filter("tooltip",sap.ui.model.FilterOperator.Contains,s)],false));}this._getTable().getBinding("items").filter(f);};a.prototype._getTable=function(){return sap.ui.getCore().byId(this.getId()+"--IDTable")||null;};a.prototype._getSearchField=function(){return sap.ui.getCore().byId(this.getId()+"--IDSearchField")||null;};a.prototype._getSearchText=function(){var s=this._getSearchField();return s?s.getValue():"";};a.prototype._isFilteredBySearchText=function(){return!!this._getSearchText().length;};a.prototype._updateControlLogic=function(){};a.prototype._updateCounts=function(){var c=0;this.getItems().forEach(function(i){if(i.getSelected()){c++;}});this._getManagedObjectModel().setProperty("/@custom/countOfSelectedItems",c);this._getManagedObjectModel().setProperty("/@custom/countOfItems",this.getItems().length);};return a;},true);
