/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(['sap/ui/base/ManagedObject','sap/ui/dt/ElementUtil','sap/ui/dt/OverlayRegistry','sap/ui/fl/registry/ChangeRegistry'],function(M,E,O,C){"use strict";var g=function(s,l){var r=C.getInstance().getRegistryItems({controlType:s,changeTypeName:l});if(r&&r[s]&&r[s][l]){var R=r[s][l];return R.getChangeTypeMetadata().getChangeHandler();}else{jQuery.sap.log.warning("No '"+l+"' change handler for "+s+" registered");}};var c=function(o,l,A){var s;if(typeof(A)==="string"){s=A;}else{s=A&&A.changeType;}if(!s){return false;}var n=o.getMetadata().getName();var p=g(n,s);if(!p){return false;}l.setChangeHandler(p);l.setChangeType(s);return true;};var f=function(o,s,D){var n=s.element||sap.ui.getCore().byId(s.element.id);var A=D.getAggregationAction("createContainer",n)[0];return A;};var a=function(o,s,D){var l=s.movedElements[0].element||sap.ui.getCore().byId(s.movedElements[0].id);var A=D.getAction("move",l);if(!A&&D.getMetadata().getName()==="sap.ui.dt.ElementDesignTimeMetadata"){var S=s.source.aggregation;var n=D.createAggregationDesignTimeMetadata(S);A=n.getAction("move",l);n.destroy();}return A;};var b=function(o,s,D){var r=s.renamedElement;var A=D.getAction("rename",r);return A;};var d=function(o,s,D){var r=s.removedElement;if(!r){r=o;}else if(!(r instanceof M)){throw new Error("No valid 'removedElement' found");}var A=D.getAction("remove",r);return A;};var e=function(o,s,D){var l=s.source;var A=D.getAction("combine",l);return A;};var h=function(o,s,D){var S=s.source;var A=D.getAction("split",S);return A;};var i=function(o,s,D){var n=s.element;var A=D.getAction("addODataProperty",n);return A;};var j=function(o,s,D){var r=s.directParent;var A=D.getAction("reveal",r);return A;};var m={"composite":{clazz:'sap.ui.rta.command.CompositeCommand'},"property":{clazz:'sap.ui.rta.command.Property'},"bindProperty":{clazz:'sap.ui.rta.command.BindProperty'},"createContainer":{clazz:'sap.ui.rta.command.CreateContainer',configure:f},"move":{clazz:'sap.ui.rta.command.Move',configure:a},"remove":{clazz:'sap.ui.rta.command.Remove',configure:d},"rename":{clazz:'sap.ui.rta.command.Rename',configure:b},"addODataProperty":{clazz:'sap.ui.rta.command.AddODataProperty',configure:i},"reveal":{clazz:'sap.ui.rta.command.Reveal',configure:j},"combine":{clazz:'sap.ui.rta.command.Combine',configure:e},"split":{clazz:'sap.ui.rta.command.Split',configure:h},"settings":{clazz:'sap.ui.rta.command.Settings'}};var _=function(v,s,S,D,F){s=s[0].toLowerCase()+s.slice(1);var l=m[s];if(!l){throw new Error("Command '"+s+"' doesn't exist, check typing");}var n=l.clazz;jQuery.sap.require(n);var o=jQuery.sap.getObject(n);var I=v instanceof sap.ui.base.ManagedObject;S=jQuery.extend(S,{element:I?v:undefined,selector:I?undefined:v,name:s});var A;if(l.configure){A=l.configure(v,S,D);}var p;if(A&&A.changeOnRelevantContainer){p=O.getOverlay(v);S=jQuery.extend(S,{element:p.getRelevantContainer()});v=S.element;}if(A&&A.getState){S=jQuery.extend(S,{fnGetState:A.getState});}if(A&&A.restoreState){S=jQuery.extend(S,{fnRestoreState:A.restoreState});}var q=new o(S);var r=true;if(l.configure){r=c(v,q,A);}if(r){q.prepare(F);return q;}else{q.destroy();}};var k=M.extend("sap.ui.rta.command.CommandFactory",{metadata:{library:"sap.ui.rta",properties:{"flexSettings":{type:"object"}},associations:{},events:{}}});k.prototype.init=function(){this.setProperty("flexSettings",{layer:"CUSTOMER",developerMode:true});};k.prototype.setFlexSettings=function(F){this.setProperty("flexSettings",jQuery.extend(this.getFlexSettings(),F));};k.prototype.getCommandFor=function(v,s,S,D){return _(v,s,S,D,this.getFlexSettings());};k.getCommandFor=function(v,s,S,D,F){return _(v,s,S,D,F);};return k;},true);
