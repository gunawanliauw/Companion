sap.ui.predefine('sap/ui/vk/DockContainer',["jquery.sap.global","./library","sap/ui/core/Control"],function(q,l,C){"use strict";
var D=C.extend("sap.ui.vk.DockContainer",{
metadata:{library:"sap.ui.vk",publicMethods:["getMinimumWidth","getMinimumHeight","setOrientation","getOrientation","removeChild","addChild","resize","getSplitterPosition","setSplitterPosition","update"],properties:{},events:{dock:{parameters:{pane:{type:"object"}}},undock:{parameters:{pane:{type:"object"}}}}},
constructor:function(d,p,i){if(typeof D._counter=="undefined"){D._counter=0;}this._id="DockContainer_"+D._counter;D._counter++;var x=0,y=0,w=d._elem.offsetWidth,h=d._elem.offsetHeight;if(p){w=p._elem.offsetWidth;h=p._elem.offsetHeight;}var e=document.createElement("div");e.setAttribute("id",this._id);e.style.position="absolute";e.style.left=x+"px";e.style.top=y+"px";e.style.width=w+"px";e.style.height=h+"px";e.style.backgroundColor="blue";e.style.zIndex=30;var s=document.createElement("div");s.setAttribute("id",this._id+"_splitter");s.style.position="absolute";s.style.opacity=0;s.style.backgroundColor="blue";s.style.zIndex=60;s.style.visibility="hidden";this._elem=e;this._splitter=s;this._manager=d;this._parent=p;this._left=null;this._right=null;this._dir=0;this._elem.appendChild(this._splitter);d.addDockContainer(p,this,i);}
});
D.prototype._setRect=function(e,x,y,w,h){e.style.left=x+"px";e.style.top=y+"px";if(w!=null){e.style.width=w+"px";}if(h!=null){e.style.height=h+"px";}};
D.prototype.getMinimumWidth=function(){var w=0;if(this._left!=null){w=this._left.getMinimumWidth();}if(this._right!=null){var a=this._right.getMinimumWidth();if(this._dir==0){if(w>a){w=a;}}else{w+=a;}}return w;};
D.prototype.getMinimumHeight=function(){var h=0;if(this._left!=null){h=this._left.getMinimumHeight();}if(this._right!=null){var a=this._right.getMinimumHeight();if(this._dir==1){if(h>a){h=a;}}else{h+=a;}}return h;};
D.prototype.setOrientation=function(d){this._dir=d;this.update();};
D.prototype.getOrientation=function(){return this._dir;};
D.prototype.removeChild=function(i){if(i==1&&this._right!=null){this._elem.removeChild(this._right._elem);this._right=null;}else if(i==0){if(this._right!=null){this._elem.removeChild(this._left._elem);this._left=this._right;this._right=null;}else{this._elem.removeChild(this._left._elem);this._right=null;}}this.update();};
D.prototype.addChild=function(c,i){if(this._left==null){i=0;}if(i==0){if(this._left!=null){this._right=this._left;}this._left=c;}else if(i==1){this._right=c;}else{return;}c._parent=this;c.update();this._elem.appendChild(c._elem);this.update();};
D.prototype.resize=function(w,h,s){this._elem.style.width=w+"px";this._elem.style.height=h+"px";if(this._left!=null&&this._right!=null){var o,a,m,b,n,c;if(this._dir==0){o=this._left._elem.offsetHeight;a=this._right._elem.offsetHeight;m=this._left.getMinimumHeight();b=this._right.getMinimumHeight();n=(s!=null)?s:h*o/(o+a);if(n<m){n=m;}c=h-n;if(c<b){c=b;n=h-c;}this._left.resize(w,n);this._right.resize(w,c);this._setRect(this._left._elem,0,0);this._setRect(this._right._elem,0,n);this._setRect(this._splitter,0,n-6,w,12);this._splitter.style.cursor="ns-resize";}else{o=this._left._elem.offsetWidth;a=this._right._elem.offsetWidth;m=this._left.getMinimumWidth();b=this._right.getMinimumWidth();n=(s!=null)?s:w*o/(o+a);if(n<m){n=m;}c=w-n;if(c<b){c=b;n=w-c;}this._left.resize(n,h);this._right.resize(c,h);this._setRect(this._left._elem,0,0);this._setRect(this._right._elem,n,0);this._setRect(this._splitter,n-6,0,12,w);this._splitter.style.cursor="ew-resize";}this._splitter.style.visibility="visible";}else if(this._left!=null){this._left.resize(w,h);this._left._elem.style.left=0;this._left._elem.style.top=0;this._splitter.style.visibility="hidden";}else{this._splitter.style.visibility="hidden";}};
D.prototype.getSplitterPosition=function(){return(this._dir==0)?this._splitter.offsetTop+6:this._splitter.offsetLeft+6;};
D.prototype.setSplitterPosition=function(p){this.resize(this._elem.offsetWidth,this._elem.offsetHeight,p);};
D.prototype.update=function(){this.resize(this._elem.offsetWidth,this._elem.offsetHeight);};
return D;},true);
sap.ui.predefine('sap/ui/vk/DockManager',["jquery.sap.global","./library","sap/ui/core/Control","./DockContainer","./DockPane","./Loco","sap/ui/core/ResizeHandler"],function(q,l,C,D,a,L,R){"use strict";
var b=C.extend("sap.ui.vk.DockManager",{metadata:{library:"sap.ui.vk",publicMethods:["getDomElement","addDockPane","removeDockPane","addDockContainer","removeDockContainer","dock","undock","bringToFront","beginGesture","move","endGesture","resize"],properties:{width:{type:"sap.ui.core.CSSSize",defaultValue:"auto"},height:{type:"sap.ui.core.CSSSize",defaultValue:"auto"}}}});
b.prototype.init=function(){if(typeof b._counter=="undefined"){b._counter=0;}this._id="DockManager_"+b._counter;b._counter++;var e=document.createElement("div");e.setAttribute("id",this._id);e.style.width="100%";e.style.height="100%";e.style.overflow="hidden";e.style.position="relative";e.style.backgroundColor="blue";this._elem=e;this._root=null;this._panes=[];this._containers=[];this._dockIcons=null;this._gesture=false;this._oPane=null;this._oParent=null;this._oDir=null;this._oContainer=null;this._oResize=null;this._oResizeDir=0;this._oIsTab=false;this._rendered=false;this._loco=new L();this._loco.addHandler(this);};
b.prototype.exit=function(){this._loco.removeHandler(this._viewportHandler);if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}};
b.prototype.isRendered=function(){return this._rendered;};
b.prototype.alwaysOnTop=function(){this._loco=new L();this._loco.removeHandler(this);this._loco.addHandler(this);};
b.prototype.onBeforeRendering=function(){if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}this._rendered=false;};
b.prototype.onAfterRendering=function(){var d=document.getElementById(this.getId());d.appendChild(this._elem);this._resizeListenerId=R.register(this,this._handleResize.bind(this));this._handleResize({size:{width:d.clientWidth,height:d.clientHeight}});this._rendered=true;var c=this._panes.length;for(var i=0;i<c;i++){this._panes[i].renderContent();}};
b.prototype._handleResize=function(e){this.resize(e.size.width,e.size.height);};
b.prototype._setRect=function(e,x,y,w,h){e.style.left=x+"px";e.style.top=y+"px";if(w!=null){e.style.width=w+"px";}if(h!=null){e.style.height=h+"px";}};
b.prototype.getDomElement=function(){return this._elem;};
b.prototype._getBounding=function(o,c){var d=o.getBoundingClientRect();var p={x:d.left,y:d.top,w:o.offsetWidth,h:o.offsetHeight};if(c!==undefined){var r=c.getBoundingClientRect();p.x-=r.left;p.y-=r.top;}return p;};
b.prototype._isInside=function(c,x,y){return(x>=c.x&&x<=c.x+c.w&&y>=c.y&&y<=c.y+c.h);};
b.prototype._createDockIcon=function(i,x,y,h){var d=document.createElement("div");d.setAttribute("id",this._id+"_dockIcon_"+i);d.style.position="absolute";this._setRect(d,x,y,48,48);d.style.backgroundColor="white";d.style.border="1px solid darkgrey";d.style.opacity=0.9;d.style.cursor="default";d.style.zIndex=100;d.pointerEvents="none";if(h){d.style.display="none";}this._dockIcons.push(d);this._elem.appendChild(d);};
b.prototype._showDockIconsAt=function(e,c,h,d){var p=this._getBounding(e,this._elem);if(c){var f={x:p.x+p.w/2-24,y:p.y+p.h/2-24};if(f.x<110){f.x=110;}else if(f.x>this._elem.offsetWidth-158){f.x=this._elem.offsetWidth-158;}if(f.y<110){f.y=110;}else if(f.y>this._elem.offsetHeight-158){f.y=this._elem.offsetHeight-158;}this._createDockIcon("center",f.x,f.y,h);this._createDockIcon("top",f.x,f.y-49,d);this._createDockIcon("right",f.x+49,f.y,d);this._createDockIcon("bottom",f.x,f.y+49,d);this._createDockIcon("left",f.x-49,f.y,d);}else{this._createDockIcon("root_top",p.x+p.w/2-24,p.y+8);this._createDockIcon("root_right",p.x+p.w-48-8,p.y+p.h/2-24);this._createDockIcon("root_bottom",p.x+p.w/2-24,p.y+p.h-48-8);this._createDockIcon("root_left",p.x+8,p.y+p.h/2-24);}};
b.prototype._showDockShadow=function(e,d){var c=this._dockShadow;if(c==null){c=document.createElement("div");c.setAttribute("id",this._id+"_dockShadow");c.style.position="absolute";c.style.backgroundColor="blue";c.style.opacity=0.3;c.style.zIndex=90;c.style.cursor="default";c.pointerEvents="none";this._elem.appendChild(c);this._dockShadow=c;}var p=e?this._getBounding(e,this._elem):{};var w=(p.w>480)?240:(p.w/2);var h=(p.h>320)?160:(p.h/2);switch(d){case 0:this._setRect(c,p.x,p.y,p.w,p.h);break;case 1:this._setRect(c,p.x,p.y,p.w,h);break;case 2:this._setRect(c,p.x+(p.w-w),p.y,w,p.h);break;case 3:this._setRect(c,p.x,p.y+p.h-h,p.w,h);break;case 4:this._setRect(c,p.x,p.y,w,p.h);break;default:c.style.visibility="hidden";return;}c.style.visibility="visible";};
b.prototype._showDockIcons=function(s){if(s){if(this._dockIcons==null||this._dockParent!=this._dockParentCurr){this._showDockIcons(false);this._dockIcons=[];this._showDockIconsAt(this._elem);if(this._dockParent!=null&&this._containers.length>1){this._showDockIconsAt(this._dockParent._elem,true,!this._dockParent._movable,this._dockParent._parent==null);}this._dockParentCurr=this._dockParent;}}else if(!s&&this._dockIcons!=null){for(var i in this._dockIcons){this._elem.removeChild(this._dockIcons[i]);}this._dockIcons=null;}};
b.prototype.addDockPane=function(d){this._panes.push(d);this._elem.appendChild(d._elem);this._updateZIndex();};
b.prototype.removeDockPane=function(d){var i=this._panes.indexOf(d);if(i>-1){this._panes.splice(i,1);this._elem.removeChild(d._elem);}else{q.sap.log.error("DockManager.removeDockPane failed, element does not exist - "+d._id);}this._updateZIndex();};
b.prototype.addDockContainer=function(p,d,i){this._containers.push(d);if(p){if(p._left!=null){var o;if(i==0){o=p._left;d._elem.style.width=o._elem.offsetWidth+"px";d._elem.style.height=o._elem.offsetHeight+"px";p._elem.removeChild(o._elem);if(p._right){p._elem.insertBefore(d._elem,p._right._elem);}else{p._elem.appendChild(d._elem);}p._left=d;o._parent=d;d._left=o;d._elem.appendChild(o._elem);}else if(i==1){o=p._right;d._elem.style.width=o._elem.offsetWidth+"px";d._elem.style.height=o._elem.offsetHeight+"px";p._elem.removeChild(o._elem);p._elem.appendChild(d._elem);p._right=d;o._parent=d;d._left=o;d._elem.appendChild(o._elem);}p.update();}else{p.addChild(d,0);}}else{this._root=d;this._elem.appendChild(d._elem);d.resize(this._elem.offsetWidth,this._elem.offsetHeight);}};
b.prototype.removeDockContainer=function(d){var i=this._containers.indexOf(d);if(i>-1){this._containers.splice(i,1);}else{q.sap.log.error("DockManager.removeDockContainer failed, element does not exist - "+d._id);}};
b.prototype._dock=function(d,c,e){if(d._parent!=null){this.undock(d);}var i=0;if(e==2||e==3){i=1;}d._parent=c;if(d._saveSize){d._saveSize();}c.setOrientation((e==1||e==3)?0:1);c.addChild(d,i);};
b.prototype.dock=function(d,p,c){if(d._parent!=null){this.undock(d);}if(p==null){var o=this._root;this._elem.removeChild(o._elem);p=new D(this,null);this._dock(o,p,1);this._dock(d,p,c);}else if(c==0){p.addTab(d);}else{var e=p._parent;var i=(e._left==p)?0:1;var f=new D(this,e,i);this._dock(d,f,c);}};
b.prototype.undock=function(d,i){if(d._tabParent!=null){d._tabParent.removeTab(d);return;}else if(i&&d._tabs.length>0){d.removeTab(d);return;}var p=d._parent;if(p==null){q.sap.log.error("DockManager::undock: cannot undock a floating DockPane - "+d._id);return;}if(p._left&&p._right){var o=null;if(p._left==d){o=p._right;}else if(p._right==d){o=p._left;}else{q.sap.log.error("DockManager::undock: internal error, tree mis-match - "+this._id);}p.removeChild(1);p.removeChild(0);var c=p._parent;if(c){if(c._left==p){c._elem.removeChild(p._elem);if(c._right){c._elem.insertBefore(o._elem,c._right._elem);}else{c._elem.appendChild(o._elem);}c._left=o;o._parent=c;}else if(c._right==p){c._elem.removeChild(p._elem);c._elem.appendChild(o._elem);c._right=o;o._parent=c;}c.update();}else if(this._root==p){this._elem.removeChild(p._elem);this._elem.appendChild(o._elem);this._root=o;o._parent=null;o._elem.style.left=0;o._elem.style.top=0;o.resize(this._elem.offsetWidth,this._elem.offsetHeight);o.update();}this.removeDockContainer(p);d._parent=null;this._elem.appendChild(d._elem);d._restoreSize();d.update();}};
b.prototype.bringToFront=function(d){if(d._parent==null){var i=this._panes.indexOf(d);if(i>-1){this._panes.splice(i,1);this._panes.push(d);this._updateZIndex();}}};
b.prototype._updateZIndex=function(){var c=this._panes.length;for(var i=0;i<c;i++){this._panes[i]._elem.style.zIndex=50+i;}};
b.prototype._tabBoxGesture=function(d,e){if(d._tabs.length>0){var t=this._getBounding(d._tabBox);if(this._isInside(t,e.x,e.y)){var c=d._tabs.length+1;var i=Math.floor((e.x-t.x)/(d._elem.offsetWidth-2)*c);if(i>d._tabs.length){i=d._tabs.length;}var f=(i==0)?d:d._tabs[i-1];d.bringTabToFront(f);this._oPane=f;this._snapX=this._ox;this._snapY=this._oy;this._snapRect=this._getBounding(d._elem);return true;}}return false;};
b.prototype.beginGesture=function(c){var e=c;if(e.n==1&&!this._gesture){this._ox=e.x;this._oy=e.y;this._oIsTab=false;if(this._isInside(this._getBounding(this._elem),e.x,e.y)){this._dockParent=null;var i,d;for(i=this._panes.length-1;i>=0;i--){d=this._panes[i];if(d._parent!=null&&this._isInside(this._getBounding(d._elem),e.x,e.y)){this._dockParent=d;break;}}var f=false;for(i=this._panes.length-1;i>=0;i--){d=this._panes[i];if(d._parent==null&&d._movable){var g=this._getBounding(d._elem);if(this._isInside(g,e.x,e.y)){this.bringToFront(d);var h={x:g.x+8,y:g.y+8,w:g.w-16,h:g.h-16};if(!this._isInside(h,e.x,e.y)){this._oResize=d;if(e.x<=h.x){if(e.y<=h.y){this._oResizeDir=5;}else if(e.y>=h.y+h.h){this._oResizeDir=8;}else{this._oResizeDir=4;}}else if(e.x>=h.x+h.w){if(e.y<=h.y){this._oResizeDir=6;}else if(e.y>=h.y+h.h){this._oResizeDir=7;}else{this._oResizeDir=2;}}else if(e.y<=h.y){this._oResizeDir=1;}else if(e.y>=h.y+h.h){this._oResizeDir=3;}else{this._oResizeDir=0;}f=true;break;}if(this._isInside(this._getBounding(d._title),e.x,e.y)){if(this._isInside(this._getBounding(d._btnClose),e.x,e.y)){f=true;d.close();}else{f=true;this._oPane=d;this._showDockIcons(true);}break;}this._oIsTab=this._tabBoxGesture(d,e);if(this._oIsTab){f=true;}break;}}}if(!f){for(i=0;i<this._containers.length;i++){var j=this._containers[i];if(j._right!=null&&this._isInside(this._getBounding(j._splitter),e.x,e.y)){this._oContainer=j;this._oContainer._splitter.style.opacity=0.3;this._snapX=this._ox;this._snapY=this._oy;f=true;break;}}}if(!f){for(i=this._panes.length-1;i>=0;i--){d=this._panes[i];if(d._parent!=null&&d._movable&&this._isInside(this._getBounding(d._title),e.x,e.y)){if(this._isInside(this._getBounding(d._btnClose),e.x,e.y)){d.close();}else{this._oPane=d;this._snapX=this._ox;this._snapY=this._oy;this._snapRect=this._getBounding(d._elem);}f=true;break;}this._oIsTab=this._tabBoxGesture(d,e);if(this._oIsTab){f=true;break;}}}c.handled=f;this._gesture=f;}}};
b.prototype.move=function(c){var e=c;if(e.n==1&&this._gesture){var d=e.x-this._ox;var f=e.y-this._oy;this._ox=e.x;this._oy=e.y;var g,x,y;if(this._oResize){g=this._oResize;var o=this._oResizeDir;x=g._elem.offsetLeft;y=g._elem.offsetTop;var w=g._elem.offsetWidth;var h=g._elem.offsetHeight;var m=g.getMinimumWidth();var j=g.getMinimumHeight();switch(o){case 1:if(h-f>=j){g._elem.style.top=(y+f)+"px";g.resize(w,h-f);}break;case 2:if(w+d>=m){g.resize(w+d,h);}break;case 3:if(h+f>=j){g.resize(w,h+f);}break;case 4:if(w-d>=m){g._elem.style.left=(x+d)+"px";g.resize(w-d,h);}break;case 5:if(w-d>=m&&h-f>=j){g._elem.style.top=(y+f)+"px";g._elem.style.left=(x+d)+"px";g.resize(w-d,h-f);}else if(w-d>m){g._elem.style.left=(x+d)+"px";g.resize(w-d,h);}else if(h-f>j){g._elem.style.top=(y+f)+"px";g.resize(w,h-f);}break;case 6:if(w+d>=m&&h-f>=j){g._elem.style.top=(y+f)+"px";g.resize(w+d,h-f);}else if(w+d>=m){g.resize(w+d,h);}else if(h-f>=j){g._elem.style.top=(y+f)+"px";g.resize(w,h-f);}break;case 7:if(w+d>=m&&h+f>=j){g.resize(w+d,h+f);}else if(w+d>=m){g.resize(w+d,h);}else if(h+f>=j){g.resize(w,h+f);}break;case 8:if(w-d>=m&&h+f>=j){g._elem.style.left=(x+d)+"px";g.resize(w-d,h+f);}else if(w-d>=m){g._elem.style.left=(x+d)+"px";g.resize(w-d,h);}else if(h+f>=j){g.resize(w,h+f);}break;default:break;}return;}this._dockParent=null;var i;for(i=this._panes.length-1;i>=0;i--){g=this._panes[i];if(g._parent!=null&&g!=this._oPane&&this._isInside(this._getBounding(g._elem),e.x,e.y)){this._dockParent=g;break;}}if(this._dockIcons!=null){this._showDockIcons(true);}g=this._oPane;if(g){if(g._parent==null&&g._tabParent==null&&!(this._oIsTab&&g._tabs.length>0)){x=g._elem.offsetLeft+d;y=g._elem.offsetTop+f;g._elem.style.left=x+"px";g._elem.style.top=y+"px";}else if(Math.abs(this._snapX-e.x)>16||Math.abs(this._snapY-e.y)>16){var s=(g._tabParent!=null||this._oIsTab);this.undock(g,this._oIsTab);var p=this._getBounding(this._elem);var n=this._snapRect.x-(this._snapX-e.x)-16-p.x;var k=this._snapRect.y-(this._snapY-e.y)-16-p.y;var r=this._snapRect.x+this._snapRect.w/2-e.x;g._elem.style.left=(n+(this._snapRect.w-g._elem.offsetWidth)/2-r)+"px";if(s){g._elem.style.top=(k+this._snapRect.h-24)+"px";}else{g._elem.style.top=k+"px";}this.bringToFront(g);this._showDockIcons(true);}}var t=this._oContainer;if(t){x=t.getSplitterPosition();if(t.getOrientation()==0){x+=f;}else{x+=d;}t.setSplitterPosition(x);}this._oParent=null;this._oDir=-1;if(this._dockIcons!=null){var u=null;var v=-1;for(i=0;i<this._dockIcons.length;i++){var z=this._dockIcons[i];var A=this._getBounding(z);if(this._isInside(A,e.x,e.y)){if(i<4){u=this._elem;v=i+1;this._oParent=null;this._oDir=v;}else if(i>=4&&this._dockParent!=null){u=this._dockParent._elem;v=i-4;this._oParent=this._dockParent;this._oDir=v;}break;}}this._showDockShadow(u,v);}else{this._showDockShadow(null,-1);}c.handled=true;}};
b.prototype.endGesture=function(e){if(this._dockIcons!=null&&this._oPane!=null&&this._oDir>-1){this.dock(this._oPane,this._oParent,this._oDir);e.handled=true;}if(this._oContainer!=null){this._oContainer._splitter.style.opacity=0;e.handled=true;}var t=this._oResize?this._oResize:this._oPane;if(t){var c=t._elem;if(c.offsetTop<-8){c.style.top="-8px";}else if(c.offsetTop>this._elem.offsetHeight-8){c.style.top=(this._elem.offsetHeight-8)+"px";}if(c.offsetLeft+c.offsetWidth<32){c.style.left=(-c.offsetWidth+32)+"px";}else if(c.offsetLeft>this._elem.offsetWidth-32){c.style.left=(this._elem.offsetWidth-32)+"px";}e.handled=true;}this._oContainer=null;this._oPane=null;this._oParent=null;this._oDir=-1;this._showDockIcons(false);this._showDockShadow(this._elem,-1);this._gesture=false;this._oResize=null;};
b.prototype.click=function(e){};
b.prototype.doubleClick=function(e){};
b.prototype.contextMenu=function(e){};
b.prototype.getViewport=function(){return this;};
b.prototype.getId=function(){return this._id;};
b.prototype.resize=function(w,h){if(this._root){this._root.resize(w,h);}};
return b;},true);
sap.ui.predefine('sap/ui/vk/DockPane',["jquery.sap.global","./library","sap/ui/core/Control","./DockContainer"],function(q,l,C,D){"use strict";
var a=C.extend("sap.ui.vk.DockPane",{
metadata:{library:"sap.ui.vk",publicMethods:["getDomElement","setMinimumWidth","getMinimumWidth","setMinimumHeight","getMinimumHeight","setMinimumSize","close","resize","update","addTab","removeTab","bringTabToFront"],properties:{width:{type:"sap.ui.core.CSSSize",defaultValue:"auto"},height:{type:"sap.ui.core.CSSSize",defaultValue:"auto"}},events:{size:{parameters:{newSize:{type:"object"}}},close:{}},aggregations:{content:{type:"sap.ui.core.Control",multiple:false,singularName:"content"}}},
constructor:function(d,x,y,w,h,t,f){C.apply(this);if(typeof a._counter=="undefined"){a._counter=0;}this._id="DockPane_"+a._counter;a._counter++;var e=document.createElement("div");e.setAttribute("id",this._id);e.style.position="absolute";e.style.left=x+"px";e.style.top=y+"px";e.style.width=w+"px";e.style.height=h+"px";e.style.backgroundColor="darkgrey";e.style.zIndex=50;e.style.overflow="hidden";this._elem=e;this._manager=d;this._parent=null;this._movable=(f===undefined||f==false)?true:false;this._minWidth=64;this._minHeight=64;this._width=w;this._height=h;this._resizable=true;this._text=(t!=null)?t:(""+this._id);this._tabs=[];this._activeTab=this;this._tabParent=null;this._telem=[];this._tcontent=[];this._hasBorder=false;this._hasTabs=false;if(this._movable){t=document.createElement("div");t.setAttribute("id",this._id+"_title");t.style.position="absolute";t.style.left=0;t.style.top=0;t.style.width="100%";t.style.height="25px";t.style.boxSizing="border-box";t.style.padding="3px 4px";t.style.backgroundColor="black";t.style.color="white";t.style.cursor="default";t.style.userSelect="none";t.style.overflow="hidden";t.innerHTML=this._text;e.appendChild(t);this._title=t;var b=document.createElement("div");b.setAttribute("id",this._id+"_close");b.style.position="absolute";b.style.right="4px";b.style.top="4px";b.style.width="18px";b.style.height="18px";b.style.backgroundColor="red";b.style.opacity=0.5;b.style.textAlign="center";b.innerHTML="X";this._title.appendChild(b);this._btnClose=b;var c=document.createElement("div");c.setAttribute("id",this._id+"_border");c.style.position="absolute";c.style.left=0;c.style.top=0;c.style.width="100%";c.style.height="100%";c.style.boxSizing="border-box";c.style.zIndex=10;c.style.pointerEvents="none";this._border=c;var r=document.createElement("div");r.style.position="absolute";r.style.left="8px";r.style.top=0;r.style.right="8px";r.style.height="8px";r.style.cursor="ns-resize";c.appendChild(r);var g=document.createElement("div");g.style.position="absolute";g.style.left="8px";g.style.bottom=0;g.style.right="8px";g.style.height="8px";g.style.cursor="ns-resize";c.appendChild(g);var i=document.createElement("div");i.style.position="absolute";i.style.left=0;i.style.top="8px";i.style.width="8px";i.style.bottom="8px";i.style.cursor="ew-resize";c.appendChild(i);var j=document.createElement("div");j.style.position="absolute";j.style.right=0;j.style.top="8px";j.style.width="8px";j.style.bottom="8px";j.style.cursor="ew-resize";c.appendChild(j);var k=document.createElement("div");k.style.position="absolute";k.style.left=0;k.style.top=0;k.style.width="8px";k.style.height="8px";k.style.cursor="nwse-resize";c.appendChild(k);var m=document.createElement("div");m.style.position="absolute";m.style.right=0;m.style.top=0;m.style.width="8px";m.style.height="8px";m.style.cursor="nesw-resize";c.appendChild(m);var n=document.createElement("div");n.style.position="absolute";n.style.left=0;n.style.bottom=0;n.style.width="8px";n.style.height="8px";n.style.cursor="nesw-resize";c.appendChild(n);var o=document.createElement("div");o.style.position="absolute";o.style.right=0;o.style.bottom=0;o.style.width="8px";o.style.height="8px";o.style.cursor="nwse-resize";c.appendChild(o);}var p=document.createElement("div");p.setAttribute("id",this._id+"_tabbox");p.style.position="absolute";p.style.left=0;p.style.right=0;p.style.bottom=0;p.style.height="24px";p.style.overflow="hidden";this._tabBox=p;var s=document.createElement("div");s.setAttribute("id",this._id+"_content");s.style.position="absolute";s.style.left=0;s.style.top=this._movable?"25px":"0";s.style.right=0;s.style.bottom=0;s.style.boxSizing="border-box";s.style.backgroundColor=this._movable?"lightgrey":"grey";s.style.border="1px solid darkgrey";s.style.overflow="hidden";e.appendChild(s);this._content=s;this.update();d.addDockPane(this);}
});
a.prototype.setContent=function(c){this.setAggregation("content",c);this.renderContent();};
a.prototype.renderContent=function(){if(this._manager.isRendered()){var c=this.getAggregation("content");if(c!=null){sap.ui.getCore().getRenderManager().render(c,this._content);}}};
a.prototype.destroy=function(){this._manager.removeDockPane(this);};
a.prototype.getDomElement=function(){return this._elem;};
a.prototype.setMinimumWidth=function(w){this._minWidth=w;if(this._parent!=null){this._parent.update();}else{this.update();}};
a.prototype.getMinimumWidth=function(){return this._minWidth;};
a.prototype.setMinimumHeight=function(h){this._minHeight=h;if(this._parent!=null){this._parent.update();}else{this.update();}};
a.prototype.getMinimumHeight=function(){return this._minHeight;};
a.prototype.setMinimumSize=function(w,h){this._minWidth=w;this._minHeight=h;if(this._parent!=null){this._parent.update();}else{this.update();}};
a.prototype.close=function(){if(this._parent!=null){this._manager.undock(this);}this._manager.removeDockPane(this);};
a.prototype._saveSize=function(){this._floatW=this._elem.offsetWidth;this._floatH=this._elem.offsetHeight;};
a.prototype._restoreSize=function(){this.resize(this._floatW,this._floatH);};
a.prototype.resize=function(w,h){this._elem.style.width=w+"px";this._elem.style.height=h+"px";this._updateTabs(w);};
a.prototype.update=function(){if(this._parent==null){this._elem.style.boxShadow="2px 6px 20px 3px rgba(0,0,0,0.5)";this._elem.style.borderTopLeftRadius="6px";this._elem.style.borderTopRightRadius="6px";if(this._border!=null&&!this._hasBorder){this._elem.appendChild(this._border);this._hasBorder=true;}}else{this._elem.style.boxShadow="";this._elem.style.borderRadius="0";if(this._border!=null&&this._hasBorder){this._elem.removeChild(this._border);this._hasBorder=false;}}if(this._tcontent.length>0){this._content.style.bottom="24px";this._content.style.borderBottom="0";for(var i=0;i<this._tcontent.length;i++){var t=this._tcontent[i];t.style.bottom="24px";t.style.borderBottom="0";}}else{this._content.style.bottom=0;this._content.style.borderBottom="1px solid darkgrey";}this._updateTabs();};
a.prototype._updateTabs=function(_){if(this._tabs.length>0){if(!this._hasTabs){this._hasTabs=true;this._elem.appendChild(this._tabBox);}var c=this._telem.length;var w=0;if(_==undefined){_=this._tabBox.offsetWidth;}var t=(_-2)/c;for(var i=0;i<c;i++){var e=this._telem[i];var b=((i==0&&this._activeTab==this)||(i>0&&this._activeTab==this._tabs[i-1]));e.style.position="absolute";e.style.left=w+"px";e.style.top=0;if(i==c-1){t=this._tabBox.offsetWidth-w;}e.style.width=t+"px";e.style.height="24px";e.style.boxSizing="border-box";e.style.overflow="hidden";e.style.padding="0 4px";e.style.backgroundColor=b?"lightgrey":"darkgrey";e.style.border="1px solid grey";e.style.fontWeight=b?"bold":"normal";if(b){e.style.borderTop="0";}var d=(i==0)?this._content:this._tcontent[i-1];d.style.visibility=(b)?"visible":"hidden";if(b){this._title.innerHTML=e.innerHTML;}w+=t;}}else if(this._movable){if(this._hasTabs){this._hasTabs=false;this._elem.removeChild(this._tabBox);}this._content.style.visibility="visible";this._title.innerHTML=this._text;}};
a.prototype.addTab=function(c){if(this._tabs.length==0){var t=document.createElement("div");t.innerHTML=this._text;this._tabBox.appendChild(t);this._telem.push(t);}else if(this._tabs.indexOf(c)>=0){return;}this._tabs.push(c);var b=document.createElement("div");b.innerHTML=c._text;this._tabBox.appendChild(b);this._telem.push(b);this._tcontent.push(c._content);this._activeTab=c;c._tabParent=this;c._elem.removeChild(c._content);this._elem.appendChild(c._content);c._saveSize();c._elem.style.display="none";var d=c._tabs.length;if(d>0){for(var i=0;i<d;i++){this._tabs.push(c._tabs[i]);c._tabBox.removeChild(c._telem[i+1]);this._tabBox.appendChild(c._telem[i+1]);this._telem.push(c._telem[i+1]);this._tcontent.push(c._tabs[i]._content);c._tabs[i]._tabParent=this;c._elem.removeChild(c._tabs[i]._content);this._elem.appendChild(c._tabs[i]._content);}c._tabs=[];c._tcontent=[];c._telem=[];}this.update();};
a.prototype._removeSelfMigrate=function(){var c=this._tabs.length;if(c>0){var p=this._parent;var b=this._elem.offsetWidth,d=this._elem.offsetHeight;var n=this._tabs[0];n._elem.style.top=this._elem.offsetTop+"px";n._elem.style.left=this._elem.offsetLeft+"px";this.removeTab(n);for(var i=1;i<c;i++){var t=this._tabs[0];this.removeTab(t);n.addTab(t);}if(p!=null){if(p._left==this){p._left=n;}else if(p._right==this){p._right=n;}p._elem.removeChild(this._elem);this._manager._elem.appendChild(this._elem);this._parent=null;this._manager._elem.removeChild(n._elem);p._elem.appendChild(n._elem);n._parent=p;n._elem.style.width=b+"px";n._elem.style.height=d+"px";this._restoreSize();p.update();n.update();this.update();}}};
a.prototype.removeTab=function(c){if(c==this){this._removeSelfMigrate();return;}var i=this._tabs.indexOf(c);if(i>=0){this._tabBox.removeChild(this._telem[i+1]);this._tabs.splice(i,1);this._telem.splice(i+1,1);var t=this._tcontent[i];t.style.bottom=0;t.style.borderBottom="1px solid darkgrey";c._elem.appendChild(t);c._tabParent=null;this._tcontent.splice(i,1);c._elem.style.display="inherit";c._restoreSize();if(this._tabs.length==0){this._activeTab=this;this._tabBox.removeChild(this._telem[0]);this._telem=[];}else if(i==0){this._activeTab=this;}else{this._activeTab=this._tabs[i-1];}this.update();}};
a.prototype.bringTabToFront=function(c){if(c==this||this._tabs.indexOf(c)>=0){this._activeTab=c;this.update();}};
return a;},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine('sap/ui/vk/ContainerBase',["jquery.sap.global","./library","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/core/Popup","sap/ui/Device","sap/m/library"],function(q,l,C,I,P,D,m){"use strict";
var a=C.extend("sap.ui.vk.ContainerBase",{metadata:{library:"sap.ui.vk",properties:{"showFullScreen":{type:"boolean",group:"Misc",defaultValue:true},"showSettings":{type:"boolean",group:"Misc",defaultValue:true},"showSelection":{type:"boolean",group:"Misc",defaultValue:true},"fullScreen":{type:"boolean",group:"Misc",defaultValue:false},"title":{type:"string",group:"Misc",defaultValue:""},"autoAdjustHeight":{type:"boolean",group:"Misc",defaultValue:false}},defaultAggregation:"content",aggregations:{content:{type:"sap.ui.vk.ContainerContent",multiple:true,singularName:"content"},"toolbar":{type:"sap.m.Toolbar",multiple:false,visibility:"hidden"}},associations:{},events:{"contentChange":{parameters:{selectedItemId:"string"}},"settingsPressed":{}}}});
a.prototype.switchContent=function(c){this.setSelectedContent(c);this.rerender();};
a.prototype.updateContainer=function(){this._contentChanged=true;this.rerender();};
a.prototype.setSelectedContent=function(c){this._oSelectedContent=c;};
a.prototype.getSelectedContent=function(){return this._oSelectedContent;};
a.prototype.init=function(){this._selectionState="SINGLE";this._firstTime=true;this._aContentIcons=[];this._selectedContent=null;this._oSelectedContent=null;this._bSegmentedButtonSaveSelectState=false;this._oMenu=null;var L=new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.High});var b=sap.m.ButtonType.Transparent;this._oFullScreenButton=new sap.m.OverflowToolbarButton({layoutData:L,type:b,icon:"sap-icon://full-screen",text:sap.ui.vk.getResourceBundle().getText("CONTAINERBASE_FULLSCREEN"),tooltip:sap.ui.vk.getResourceBundle().getText("CONTAINERBASE_FULLSCREEN"),press:function(){this._bSegmentedButtonSaveSelectState=true;this._toggleFullScreen();}.bind(this)});this._oSettingsButton=new sap.m.OverflowToolbarButton({layoutData:L.clone(),type:b,icon:"sap-icon://action-settings",text:sap.ui.vk.getResourceBundle().getText("CONTAINERBASE_SETTINGS"),tooltip:sap.ui.vk.getResourceBundle().getText("CONTAINERBASE_SETTINGS"),press:function(){this._bSegmentedButtonSaveSelectState=true;this.fireSettingsPressed();}.bind(this)});this._oSelectionButtonSingle=new sap.m.SegmentedButtonItem({icon:"sap-icon://map-container/selection-single",tooltip:sap.ui.vk.getResourceBundle().getText("CONTAINERBASE_MENU_SINGLE"),press:this._handleSelection.bind(this,"SINGLE")});this._oSelectionButtonRectangle=new sap.m.SegmentedButtonItem({icon:"sap-icon://map-container/selection-rectangle",tooltip:sap.ui.vk.getResourceBundle().getText("CONTAINERBASE_MENU_RECT"),press:this._handleSelection.bind(this,"RECT")});this._oSelectionButtonLasso=new sap.m.SegmentedButtonItem({icon:"sap-icon://map-container/selection-lasso",tooltip:sap.ui.vk.getResourceBundle().getText("CONTAINERBASE_MENU_LASSO"),press:this._handleSelection.bind(this,"LASSO")});this._selectionMenu=new sap.m.SegmentedButton({items:[this._oSelectionButtonSingle,this._oSelectionButtonRectangle,this._oSelectionButtonLasso]});this._oPopup=new P({modal:true,shadow:false,autoClose:false});this._oContentSegmentedButton=new sap.m.SegmentedButton({layoutData:L.clone(),select:this._onContentButtonSelect.bind(this)});this._oContTitle=new sap.m.Label();this._oToolbar=new sap.m.OverflowToolbar({width:"auto"}).addStyleClass("sapUiVkContainerBaseToolbar");this.setAggregation("toolbar",this._oToolbar);this.sResizeListenerId=null;if(D.system.desktop){this.sResizeListenerId=sap.ui.core.ResizeHandler.register(this,q.proxy(this._performHeightChanges,this));}else{D.orientation.attachHandler(this._performHeightChanges,this);D.resize.attachHandler(this._performHeightChanges,this);}q.sap.require("sap.ui.thirdparty.URI");var c=[{name:"selection-lasso",unicode:"E000"},{name:"selection-rectangle",unicode:"E001"},{name:"selection-single",unicode:"E002"}],d="map-container",f="map-container";c.forEach(function(i){sap.ui.core.IconPool.addIcon(i.name,d,f,i.unicode);});};
a.prototype.exit=function(){if(this._oFullScreenButton){this._oFullScreenButton.destroy();this._oFullScreenButton=undefined;}if(this._oPopup){this._oPopup.destroy();this._oPopup=undefined;}if(this._oContentSegmentedButton){this._oContentSegmentedButton.destroy();this._oContentSegmentedButton=undefined;}if(this._oSelectedContent){this._oSelectedContent.destroy();this._oSelectedContent=undefined;}if(this._oToolbar){this._oToolbar.destroy();this._oToolbar=undefined;}if(D.system.desktop&&this.sResizeListenerId){sap.ui.core.ResizeHandler.deregister(this.sResizeListenerId);this.sResizeListenerId=null;}else{D.orientation.detachHandler(this._performHeightChanges,this);D.resize.detachHandler(this._performHeightChanges,this);}};
a.prototype.setFullScreen=function(f){if(this._firstTime){return;}if(this.getFullScreen()==f){return;}var b=this.getProperty("fullScreen");if(b!==f){this._toggleFullScreen();}};
a.prototype.onAfterRendering=function(){var t=this;if((this.sResizeListenerId===null)&&(D.system.desktop)){this.sResizeListenerId=sap.ui.core.ResizeHandler.register(this,q.proxy(this._performHeightChanges,this));}if(this.getAutoAdjustHeight()||this.getFullScreen()){q.sap.delayedCall(500,this,function(){t._performHeightChanges();});}this._firstTime=false;if(this.getSelectedContent()!==null){var c=this.getSelectedContent().getContent();if(c instanceof sap.ui.vbm.GeoMap||c instanceof sap.ui.vbm.AnalyticMap){if(this.getShowSelection()){if(this._selectionState==="LASSO"){c.setLassoSelection(true);}else if(this._selectionState==="RECT"){c.setRectangularSelection(true);}else if(this._selectionState==="SINGLE"){c.setRectangularSelection(false);c.setLassoSelection(false);}}}}};
a.prototype.onBeforeRendering=function(){if(this._contentChanged){this._contentChange();}this._oToolbar.removeAllContent();this._addToolbarContent();};
a.prototype.setTitle=function(v){this._oContTitle.setText(v);this.setProperty("title",v,true);};
a.prototype.addContent=function(o){this.addAggregation("content",o);this._contentChanged=true;};
a.prototype.insertContent=function(o,i){this.insertAggregation("content",o,i);this._contentChanged=true;};
a.prototype.updateContent=function(){this.updateAggregation("content");this._contentChanged=true;};
a.prototype._toggleFullScreen=function(){var f=this.getProperty("fullScreen");var s;var h;var c;if(f){this._closeFullScreen();this.setProperty("fullScreen",false,true);c=this.getSelectedContent().getContent();s=c.getId();c.setWidth("100%");h=this._contentHeight[s];if(h){c.setHeight(h);}this.invalidate();}else{var o=this.getAggregation("content");this._contentHeight={};if(o){for(var i=0;i<o.length;i++){c=o[i].getContent();s=c.getId();if(q.isFunction(c.getHeight)){h=c.getHeight();}else{h=0;}this._contentHeight[s]=h;}}this._openFullScreen(true);this.setProperty("fullScreen",true,true);}var b=(f?"sap-icon://full-screen":"sap-icon://exit-full-screen");this._oFullScreenButton.setIcon(b);this._oFullScreenButton.focus();};
a.prototype._openFullScreen=function(n){if((n!==null)&&(n===true)){this._oScrollEnablement=new sap.ui.core.delegate.ScrollEnablement(this,this.getId()+"-wrapper",{horizontal:true,vertical:true});}this.$content=this.$();if(this.$content){this.$tempNode=q("<div></div>");this.$content.before(this.$tempNode);this._$overlay=q("<div id='"+q.sap.uid()+"'></div>");this._$overlay.addClass("sapUiVkContainerBaseOverlay");this._$overlay.append(this.$content);this._oPopup.setContent(this._$overlay);}else{q.sap.log.warn("Overlay: content does not exist or contains more than one child");}this._oPopup.open(200,undefined,undefined,q("body"));};
a.prototype._closeFullScreen=function(){if(this._oScrollEnablement!==null){this._oScrollEnablement.destroy();this._oScrollEnablement=null;}this.$tempNode.replaceWith(this.$content);this._oToolbar.setDesign(sap.m.ToolbarDesign.Auto);this._oPopup.close();this._$overlay.remove();};
a.prototype._performHeightChanges=function(){if(this.getAutoAdjustHeight()||this.getFullScreen()){var $=this.$();if(($.find(".sapUiVkContainerBaseToolbarArea").children()[0])&&($.find(".sapUiVkContainerBaseContentArea").children()[0])){var o=this.getSelectedContent().getContent();if(o.getDomRef().offsetWidth!==this.getDomRef().clientWidth){this.rerender();}}}};
a.prototype._switchContent=function(c){var o=this._findContentById(c);this.setSelectedContent(o);this.fireContentChange({selectedItemId:c});this.rerender();};
a.prototype._contentChange=function(){var c=this.getContent();this._oContentSegmentedButton.removeAllButtons();this._destroyButtons(this._aContentIcons);this._aContentIcons=[];if(c.length===0){this._oContentSegmentedButton.removeAllButtons();this._setDefaultOnSegmentedButton();this.switchContent(null);}if(c){for(var i=0;i<c.length;i++){var b=c[i].getContent();if(b.setWidth){b.setWidth("100%");}var B=new sap.m.SegmentedButtonItem({icon:c[i].getIcon(),tooltip:c[i].getTitle(),key:b.getId()});this._aContentIcons.push(B);this._oContentSegmentedButton.addItem(B);if(i===0){this.setSelectedContent(c[i]);}}}this._contentChanged=false;};
a.prototype._onContentButtonSelect=function(e){var c=e.getParameter("key");this._switchContent(c);};
a.prototype._findContentById=function(s){var c=null;var o=this.getAggregation("content");if(o){for(var i=0;!c&&i<o.length;i++){if(o[i].getContent().getId()===s){c=o[i];}}}return c;};
a.prototype._addToolbarContent=function(){this._oToolbar.addContent(new sap.m.ToolbarSpacer());if(this._aContentIcons.length>1){this._oToolbar.addContent(this._oContentSegmentedButton);}if(this.getSelectedContent()!==null){var c=this.getSelectedContent().getContent();if(c instanceof sap.ui.vbm.GeoMap||c instanceof sap.ui.vbm.AnalyticMap){if(this.getShowSelection()){this._oToolbar.addContent(this._selectionMenu);}}}if(this.getShowSettings()){this._oToolbar.addContent(this._oSettingsButton);}if(!D.system.phone&&this.getShowFullScreen()){this._oToolbar.addContent(this._oFullScreenButton);}};
a.prototype._setDefaultOnSegmentedButton=function(){if(!this._bSegmentedButtonSaveSelectState){this._oContentSegmentedButton.setSelectedButton(null);}this._bSegmentedButtonSaveSelectState=false;};
a.prototype._destroyButtons=function(b){b.forEach(function(B){B.destroy();});};
a.prototype._handleSelection=function(b){var c=this.getSelectedContent().getContent();if(c instanceof sap.ui.vbm.GeoMap||c instanceof sap.ui.vbm.AnalyticMap){if(b==="LASSO"){c.setLassoSelection(true);this._selectionState=b;}else if(b==="RECT"){c.setRectangularSelection(true);this._selectionState=b;}else if(b==="SINGLE"){c.setRectangularSelection(false);c.setLassoSelection(false);this._selectionState=b;}}};
return a;});
sap.ui.predefine('sap/ui/vk/ContainerBaseRenderer',function(){"use strict";var C={};
C.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapUiVkContainerBase");r.writeClasses(c);r.write(">");r.write("<div");r.writeAttributeEscaped("id",c.getId()+"-wrapper");r.addClass("sapUiVkContainerBaseWrapper");r.writeClasses();r.write(">");this.writeContentArea(r,c);this.writeToolbarArea(r,c);r.write("</div>");r.write("</div>");};
C.writeContentArea=function(r,c){var s=c.getSelectedContent();r.write("<div");r.addClass("sapUiVkContainerBaseContentArea");r.writeClasses();r.write(">");if(s!==null){r.renderControl(s);}else if(c.getContent().length>0){s=c.getContent()[0];r.renderControl(s);}r.write("</div>");};
C.writeToolbarArea=function(r,c){r.write("<div");r.addClass("sapUiVkContainerBaseToolbarArea");r.writeClasses();r.write(">");r.renderControl(c._oToolbar);r.write("</div>");};
return C;},true);
sap.ui.predefine('sap/ui/vk/ContainerContent',["./library","sap/ui/core/Control"],function(l,C){"use strict";
var a=C.extend("sap.ui.vk.ContainerContent",{metadata:{library:"sap.ui.vk",properties:{"icon":{type:"string",group:"Misc",defaultValue:null},"title":{type:"string",group:"Misc",defaultValue:null}},aggregations:{"content":{type:"sap.ui.core.Control",multiple:false}}}});
a.prototype.setContent=function(c){if(c instanceof sap.ui.vbm.GeoMap){c.setNavcontrolVisible(false);c.setWidth("100%");c.setHeight("100%");}this.setAggregation("content",c);return this;};
return a;});
sap.ui.predefine('sap/ui/vk/ContainerContentRenderer',function(){"use strict";var C={};
C.render=function(r,c){r.renderControl(c.getContent());};
return C;},true);
sap.ui.predefine('sap/ui/vk/LegendItem',["./library","sap/m/StandardListItem"],function(l,S){"use strict";
var L=S.extend("sap.ui.vk.LegendItem",{metadata:{library:"sap.ui.vk",properties:{color:{type:"sap.ui.core.CSSColor",group:"Appearance",defaultValue:null},semanticSpotType:{type:"sap.ui.vbm.SemanticType",group:"Behavior",defaultValue:null}},aggregations:{}}});
return L;});
sap.ui.predefine('sap/ui/vk/LegendItemRenderer',["sap/m/StandardListItemRenderer","sap/ui/core/Renderer"],function(B,R){"use strict";var L=R.extend(B);
L.renderLIContent=function(r,c){var s=c.getColor();var t=c.getSemanticSpotType();var i=null;if(s){r.write("<span");r.addClass("sapUiVkLegendItemSquare");r.addStyle("background-color",s);r.writeStyles();r.writeClasses();r.write(">");r.write("</span>");}if(t){switch(t){case sap.ui.vbm.SemanticType.Error:i=sap.ui.resource("sap.ui.vbm","themes/base/img/Pin_Red.png");break;case sap.ui.vbm.SemanticType.Warning:i=sap.ui.resource("sap.ui.vbm","themes/base/img/Pin_Orange.png");break;case sap.ui.vbm.SemanticType.Success:i=sap.ui.resource("sap.ui.vbm","themes/base/img/Pin_Green.png");break;case sap.ui.vbm.SemanticType.Default:i=sap.ui.resource("sap.ui.vbm","themes/base/img/Pin_Blue.png");break;case sap.ui.vbm.SemanticType.Inactive:i=sap.ui.resource("sap.ui.vbm","themes/base/img/Pin_Grey.png");break;default:break;}if(i){c.addStyleClass("sapUiVkLegendItemSpotType");c.setIcon(i);}}B.renderLIContent(r,c);};
return L;},true);
sap.ui.predefine('sap/ui/vk/ListPanel',["./library","sap/ui/core/Control","sap/m/library"],function(l,C,m){"use strict";
var L=C.extend("sap.ui.vk.ListPanel",{metadata:{library:"sap.ui.vk",properties:{"headerText":{type:"string",group:"Misc"},"headerIcon":{type:"sap.ui.core.URI",group:"Misc"},"expanded":{type:"boolean",group:"Misc",defaultValue:true},"expandAnimation":{type:"boolean",group:"Misc",defaultValue:true},"selectionMode":{type:"sap.m.ListMode",group:"Misc",defaultValue:sap.m.ListMode.MultiSelect}},aggregations:{"items":{type:"sap.m.ListItemBase",multiple:true,singularName:"item"},"panel":{type:"sap.m.Panel",multiple:false,visibility:"hidden"}},events:{headerIconPress:{},expand:{},selectionChange:{parameters:{listItem:{type:"sap.m.ListItemBase"},listItems:{type:"sap.m.ListItemBase[]"},selected:{type:"boolean"}}},itemPress:{parameters:{listItem:{type:"sap.m.ListItemBase"},srcControl:{type:"sap.ui.core.Control"}}}}}});
L.prototype.getSelectedItem=function(){return this._oList.getSelectedItem();};
L.prototype.setSelectedItem=function(o,s,f){this._oList.setSelectedItem(o,s,f);};
L.prototype.getSelectedItems=function(){return this._oList.getSelectedItems();};
L.prototype.init=function(){this._oList=new sap.m.ListBase({mode:this.getSelectionMode(),itemPress:this.fireItemPress.bind(this),selectionChange:this.fireSelectionChange.bind(this)});this._oPanel=new sap.m.Panel({expandable:true,expanded:true,expandAnimation:true,headerToolbar:new sap.m.Toolbar({active:true,press:this._onHeaderToolbarPress.bind(this)}),content:[this._oList],expand:this.fireExpand.bind(this)});this._oPanel.getHeaderToolbar().addStyleClass("sapUiVkLPTb");this.setAggregation("panel",this._oPanel,true);this._oHeaderIcon=null;this._oHeaderText=null;this._bHeaderToolbarChanged=true;};
L.prototype.exit=function(){this._destroyControl(this._oList);this._destroyControl(this._oPanel);this._destroyControl(this._oHeaderIcon);this._destroyControl(this._oHeaderText);};
L.prototype.getItems=function(){return this._oList.getItems();};
L.prototype.addItem=function(o){return this._oList.addItem(o);};
L.prototype.insertItem=function(o,i){return this._oList.insertItem(o,i);};
L.prototype.removeItem=function(o){return this._oList.removeItem(o);};
L.prototype.removeAllItems=function(){return this._oList.removeAllItems();};
L.prototype.setHeaderText=function(v){if(!this._oHeaderText){this._oHeaderText=new sap.m.Title();}this._oHeaderText.setText(v);this._bHeaderToolbarChanged=true;return this.setProperty("headerText",v);};
L.prototype.getExpanded=function(){return this._oPanel.getExpanded();};
L.prototype.setExpanded=function(v){return this._oPanel.setExpanded(v);};
L.prototype.getExpandAnimation=function(){return this._oPanel.getExpandAnimation();};
L.prototype.setExpandAnimation=function(v){return this._oPanel.setExpandAnimation(v);};
L.prototype.setHeaderIcon=function(v){if(!this._oHeaderIcon){this._oHeaderIcon=new sap.m.Button({press:this.fireHeaderIconPress.bind(this),type:sap.m.ButtonType.Transparent});}this._oHeaderIcon.setIcon(v);this._bHeaderToolbarChanged=true;return this.setProperty("headerIcon",v);};
L.prototype.setSelectionMode=function(v){this._oList.setMode(v);return this.setProperty("selectionMode",v);};
L.prototype.onBeforeRendering=function(){if(this._bHeaderToolbarChanged){var t=this._oPanel.getHeaderToolbar();t.removeAllContent();if(this._oHeaderIcon){t.addContent(this._oHeaderIcon);}if(this._oHeaderText){t.addContent(this._oHeaderText);}this._bHeaderToolbarChanged=false;}};
L.prototype._destroyControl=function(c){if(c){c.destroy();c=undefined;}};
L.prototype._onHeaderToolbarPress=function(e){this._oPanel.setExpanded(!this._oPanel.getExpanded());};
return L;});
sap.ui.predefine('sap/ui/vk/ListPanelRenderer',function(){"use strict";var L={};
L.render=function(r,c){var p=c._oPanel;p.addStyleClass("sapUiVkListPanel");r.write("<div");r.writeControlData(c);r.write(">");r.renderControl(p);r.write("</div>");};
return L;},true);
sap.ui.predefine('sap/ui/vk/ListPanelStack',["./library","sap/ui/core/Control","sap/ui/layout/library"],function(l,C,a){"use strict";
var L=C.extend("sap.ui.vk.ListPanelStack",{metadata:{library:"sap.ui.vk",properties:{"width":{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:"100%"},"expanded":{type:"boolean",group:"Misc",defaultValue:true},"expandAnimation":{type:"boolean",group:"Misc",defaultValue:true},"collapsible":{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{"content":{type:"sap.ui.vk.ListPanel",multiple:true,singularName:"content"},"layout":{type:"sap.ui.layout.VerticalLayout",multiple:false,visibility:"hidden"}}}});
L.prototype.init=function(){this._oLayout=new sap.ui.layout.VerticalLayout();this._oLayout.addStyleClass("sapUiVkLPSTrans");this.setAggregation("layout",this._oLayout,true);this._bFirstTime=true;};
L.prototype.exit=function(){if(this._oLayout){this._oLayout.destroy();this._oLayout=undefined;}};
L.prototype.getContent=function(){return this._oLayout.getContent();};
L.prototype.addContent=function(o){o.attachExpand(this._onContentExpand.bind(this));o.attachHeaderIconPress(this._onContentHeaderIconPress.bind(this));return this._oLayout.addContent(o);};
L.prototype.removeContent=function(o){return this._oLayout.removeContent(o);};
L.prototype.insertContent=function(o,i){return this._oLayout.insertContent(o,i);};
L.prototype.removeAllContent=function(){return this._oLayout.removeAllContent();};
L.prototype.getWidth=function(){return this._oLayout.getWidth();};
L.prototype.setWidth=function(v){this.setProperty("width",v,true);return this._oLayout.setWidth(v);};
L.prototype.setExpanded=function(v){if(v!=this.getExpanded()){if(v){this._expand();}else{this._collapse();}}return this;};
L.prototype.setExpandAnimation=function(v){this._oLayout.removeStyleClass("sapUiVkLPSTrans");if(v){this._oLayout.addStyleClass("sapUiVkLPSTrans");}return this.setProperty("expandAnimation",v,true);};
L.prototype.onBeforeRendering=function(){if(this._bFirstTime){var e=false;var c=this.getContent();for(var i=0;i<c.length;++i){if(c[i].getExpanded()){e=true;}}this.setExpanded(e);this._bFirstTime=false;}};
L.prototype.onAfterRendering=function(){if(!this.getExpanded()){this._updateCollapsedLayoutWidth();}};
L.prototype._onContentExpand=function(e){var b=false;var c=this._oLayout.getContent();for(var i=0;i<c.length;++i){if(c[i].getExpanded()){b=true;}}this.setExpanded(b);};
L.prototype._onContentHeaderIconPress=function(e){var b=e.oSource.getExpanded()?false:true;e.oSource.setExpanded(b);var E=false;var c=this._oLayout.getContent();for(var i=0;i<c.length;++i){if(c[i].getExpanded()){E=true;break;}}this.setExpanded(E);};
L.prototype._expand=function(){this._oLayout.removeStyleClass("sapUiVkLPSCollapse");this._oLayout.setWidth(this.getProperty("width"));this.setProperty("expanded",true,true);};
L.prototype._collapse=function(){if(!this.getCollapsible()){return;}var c=this.getContent();for(var i=0;i<c.length;++i){c[i].setExpanded(false);}this._oLayout.addStyleClass("sapUiVkLPSCollapse");this._updateCollapsedLayoutWidth();this.setProperty("expanded",false,true);};
L.prototype._updateCollapsedLayoutWidth=function(){if(this._oLayout.$().closest(".sapUiSizeCompact").length===0){this._oLayout.setWidth("3rem");}else{this._oLayout.setWidth("2.5rem");}};
return L;});
sap.ui.predefine('sap/ui/vk/ListPanelStackRenderer',function(){"use strict";var L={};
L.render=function(r,c){c._oLayout.addStyleClass("sapUiVkListPanelStack");r.renderControl(c._oLayout);};
return L;},true);
sap.ui.predefine('sap/ui/vk/MapContainer',["jquery.sap.global","./library","sap/ui/vk/ContainerBase","sap/ui/core/IconPool","sap/ui/vbm/lib/sapvbi","sap/ui/Device"],function(q,l,C,I,s,D){"use strict";
var M=C.extend("sap.ui.vk.MapContainer",{metadata:{library:"sap.ui.vk",properties:{"showNavbar":{type:"boolean",group:"Misc",defaultValue:true},"showHome":{type:"boolean",group:"Misc",defaultValue:true},"showMapLayer":{type:"boolean",group:"Misc",defaultValue:true},"showRectangularZoom":{type:"boolean",group:"Misc",defaultValue:true},"showZoom":{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{"listPanelStack":{type:"sap.ui.vk.ListPanelStack",multiple:false},"scrollCont":{type:"sap.m.ScrollContainer",multiple:false,visibility:"hidden"}},associations:{},events:{}}});
M.prototype.init=function(){this._currentText=new sap.m.Text({}).addStyleClass("mapLayerSelectedText");C.prototype.init.apply(this,arguments);var m=new sap.ui.model.json.JSONModel();m.setData({rectZoom:false});this.setModel(m,"rectZoom");this._oNavbar=new sap.m.Toolbar({width:"auto"});this._oScrollCont=new sap.m.ScrollContainer({height:"100%",horizontal:false,vertical:true,focusable:false});this.setAggregation("scrollCont",this._oScrollCont,true);this._oHomeButton=new sap.m.Button({icon:"sap-icon://home",type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText("MAPCONTAINER_HOME"),press:this._onNavbarHome.bind(this)});this._oRectZoomButton=new sap.m.ToggleButton({icon:"sap-icon://draw-rectangle",type:sap.m.ButtonType.Transparent,pressed:"{rectZoom>/rectZoom}",tooltip:sap.ui.vk.getResourceBundle().getText("MAPCONTAINER_RECT_ZOOM")}).setModel(m,"rectZoom");this._oZoomInButton=new sap.m.Button({icon:"sap-icon://add",type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText("MAPCONTAINER_ZOOMIN"),press:this._onNavbarZoomIn.bind(this)});this._oZoomOutButton=new sap.m.Button({icon:"sap-icon://less",type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText("MAPCONTAINER_ZOOMOUT"),press:this._onNavbarZoomOut.bind(this)});if(D.system.phone){this._oMenuOpenButton=new sap.m.Button({layoutData:new sap.m.OverflowToolbarLayoutData({priority:sap.m.OverflowToolbarPriority.NeverOverflow}),icon:"sap-icon://menu2",type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText("CONTAINERBASE_MENU"),press:function(){this._bSegmentedButtonSaveSelectState=true;this._showListPanelStack();}.bind(this)});this._oMenuCloseButton=new sap.m.Button({type:sap.m.ButtonType.Transparent,icon:"sap-icon://nav-back",press:function(){this._bSegmentedButtonSaveSelectState=true;this._hideListPanelStack();}.bind(this)});}};
M.prototype.exit=function(){if(this._oNavbar){this._oNavbar.destroy();this._oNavbar=undefined;}if(this._oScrollCont){this._oScrollCont.destroy();this._oScrollCont=undefined;}C.prototype.exit.apply(this,arguments);};
M.prototype.getListPanelStack=function(){return this._oScrollCont.getContent()[0];};
M.prototype.setListPanelStack=function(p){if(D.system.phone){p.setCollapsible(false);p.setWidth("100%");}this._oScrollCont.removeAllContent();return this._oScrollCont.addContent(p);};
M.prototype.onBeforeRendering=function(){C.prototype.onBeforeRendering.apply(this,arguments);this._oNavbar.removeAllContent();var c=this.getSelectedContent();if(c!==null){var a=c.getContent();this._isInstanceGeoAnalytic=a instanceof sap.ui.vbm.GeoMap||a instanceof sap.ui.vbm.AnalyticMap;if(this._isInstanceGeoAnalytic){if(this.getShowHome()){this._oNavbar.addContent(this._oHomeButton);}if(!D.system.phone&&this.getShowRectangularZoom()){this._oNavbar.addContent(this._oRectZoomButton);}if(this.getShowZoom()){this._oNavbar.addContent(this._oZoomInButton);this._oNavbar.addContent(this._oZoomOutButton);}this._shouldRenderListPanel=true;}else{this._shouldRenderListPanel=false;}this._isSupportingMapLayerSwitch=a instanceof sap.ui.vbm.GeoMap&&!(a instanceof sap.ui.vbm.AnalyticMap);if(this._isSupportingMapLayerSwitch&&a.getMapConfiguration()!==null&&this.getShowMapLayer()){var b=a.getMapConfiguration();var d=b.MapLayerStacks;if(a instanceof sap.ui.vbm.GeoMap&&d.length>1){this._box=new sap.m.HBox({}).addStyleClass("mapContainerHboxPopover");this._popover=new sap.m.Popover({placement:sap.m.PlacementType.Horizontal,content:this._box,showHeader:false});this._selectionMap=new sap.m.Image({width:"4.7rem",press:function(e){if(this._popover.isOpen()){this._popover.close();}else{this._popover.openBy(this._selectionMap);}}.bind(this)}).addStyleClass("mapLayerPopoverItem");}this._shouldRenderMapLayerSwitch=true;}}else{this._shouldRenderMapLayerSwitch=false;}};
M.prototype.onAfterRendering=function(){if(D.system.phone){var L=document.getElementById(this.getId()+"-LPW");this.getDomRef().appendChild(L);}C.prototype.onAfterRendering.apply(this,arguments);if(this.getSelectedContent()!==null){var c=this.getSelectedContent().getContent();if(this._isSupportingMapLayerSwitch===true&&c.getMapConfiguration()){var a=c.getMapConfiguration();var b=a.MapLayerStacks;b.forEach(function(v,i){var d=new sap.ui.layout.VerticalLayout({});var e=c.mVBIContext.GetMainScene();var f=c.mVBIContext.m_MapLayerStackManager.GetMapLayerStack(v.name);var o=new sap.m.Image({width:"4.5rem",press:function(h){this._popover.close();o.setAlt(v.name);var j=h.getSource();var t=j.getAlt();c.setRefMapLayerStack(t);this._currentText.setText(v.name);e.GetPreviewImage(f,function(k){q(".mapLayerPopoverItem").attr("src",k.src);});this._currentMapLayerStackIndex=i;}.bind(this)});var g=new sap.m.Text({text:v.name}).addStyleClass("mapLayerPopoverItemText");o.addStyleClass("layerType");e.GetPreviewImage(f,function(h){o.setSrc(h.src);});e.GetPreviewImage(e.m_MapLayerStack,function(h){q(".mapLayerPopoverItem").attr("src",h.src);});var m=c.getMapConfiguration();var n=m.MapLayerStacks[this._currentMapLayerStackIndex||0].name;this._currentText.setText(n);this._box.addItem(d);d.addContent(o);d.addContent(g);},this);}}};
M.prototype.setSelectedContent=function(c){var o;if(this._oSelectedContent){if((o=this._oSelectedContent.getContent())instanceof sap.ui.vbm.GeoMap){o.unbindProperty("rectZoom","rectZoom>/rectZoom");}}C.prototype.setSelectedContent.apply(this,arguments);var n=this._oSelectedContent.getContent();if(n instanceof sap.ui.vbm.GeoMap){n.bindProperty("rectZoom","rectZoom>/rectZoom");}};
M.prototype._addToolbarContent=function(){if(D.system.phone){this._oToolbar.addContent(this._oMenuOpenButton);}C.prototype._addToolbarContent.apply(this,arguments);};
M.prototype._onNavbarZoomIn=function(e){var c=this.getSelectedContent().getContent();if(c.getZoomlevel&&c.setZoomlevel&&c.setEnableAnimation){c.setEnableAnimation(true);c.setZoomlevel(c.getZoomlevel()+1);}};
M.prototype._onNavbarZoomOut=function(e){var c=this.getSelectedContent().getContent();if(c.getZoomlevel&&c.setZoomlevel&&c.setEnableAnimation){c.setEnableAnimation(true);c.setZoomlevel(c.getZoomlevel()-1);}};
M.prototype._onNavbarHome=function(e){var c=this.getSelectedContent().getContent();if(c.goToStartPosition){c.goToStartPosition();}};
M.prototype._showListPanelStack=function(){q("#"+this.getId()+"-LPW").addClass("sapUiVkMapContainerLPWIn");q("#"+this.getId()+"-wrapper").addClass("sapUiVkMapContainerMapOut");};
M.prototype._hideListPanelStack=function(){q("#"+this.getId()+"-LPW").removeClass("sapUiVkMapContainerLPWIn");q("#"+this.getId()+"-wrapper").removeClass("sapUiVkMapContainerMapOut");};
return M;});
sap.ui.predefine('sap/ui/vk/MapContainerRenderer',["./ContainerBaseRenderer","sap/ui/core/Renderer","sap/ui/Device"],function(B,R,D){"use strict";var M=R.extend(B);
M.render=function(r,c){c.addStyleClass("sapUiVkMapContainer");B.render.apply(this,arguments);};
M.writeToolbarArea=function(r,c){r.write("<div");r.addClass("sapUiVkMapContainerOverlay");r.writeClasses();r.write(">");if(c.getShowNavbar()){r.write("<div");r.addClass("sapUiVkMapContainerNavbarArea");r.writeClasses();r.write(">");if(c.getShowMapLayer()&&c._shouldRenderMapLayerSwitch){r.renderControl(c._currentText);r.renderControl(c._selectionMap);}r.write("<div");r.addClass("sapUiVkMapContainerNavbarContainer");r.writeClasses();r.write(">");r.renderControl(c._oNavbar);r.write("</div>");r.write("</div>");}if(!D.system.phone&&c._shouldRenderListPanel){c._oScrollCont.addStyleClass("sapUiVkMapContainerListPanelArea");r.renderControl(c._oScrollCont);}B.writeToolbarArea(r,c);r.write("</div>");if(D.system.phone){r.write("<div id="+c.getId()+"-LPW");r.addClass("sapUiVkMapContainerLPW");r.writeClasses();r.write(">");r.renderControl(c._oMenuCloseButton);c._oScrollCont.addStyleClass("sapUiVkMapContainerListPanelArea");r.renderControl(c._oScrollCont);r.write("</div>");}};
return M;},true);
sap.ui.predefine('sap/ui/vk/NativeViewport',["jquery.sap.global","./library","sap/ui/core/Control","sap/ui/core/ResizeHandler","./Loco","./ViewportHandler","./Messages"],function(q,l,C,R,L,V,M){"use strict";
var N=C.extend("sap.ui.vk.NativeViewport",{metadata:{library:"sap.ui.vk",properties:{limitZoomOut:{type:"boolean",group:"Behavior",defaultValue:false}},publicMethods:["beginGesture","endGesture","pan","rotate","zoom","tap","queueCommand","getViewInfo","setViewInfo","loadUrl"],events:{"resize":{parameters:{oldSize:"object",size:"object"}},"move":{parameters:{pan:"object",zoom:"float"}}}}});
N.prototype.init=function(){if(C.prototype.init){C.prototype.init.call(this);}this._canvas=null;this._canvas=document.createElement("div");this._canvas.style.textAlign="left";this._canvas.id=q.sap.uid();this._resizeListenerId=null;this._viewportHandler=new V(this);this._loco=new L();this._loco.addHandler(this._viewportHandler);this._img=null;this._svg=null;this._svgError=null;this._reset();this._gx=0;this._gy=0;this._errorImageWidth=550;this._errorImageHeight=512;this._imageW=0;this._imageH=0;this._s4BestFit=0;this._update=function(){};this._svgid=this.getId()+"-svg";this._doBestFitAfterResize=false;};
N.prototype.exit=function(){this._loco.removeHandler(this._viewportHandler);this._viewportHandler.destroy();if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}if(C.prototype.exit){C.prototype.exit.call(this);}};
N.prototype.onBeforeRendering=function(){if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}};
N.prototype.onAfterRendering=function(){if(this._canvas){var d=this.getDomRef();d.appendChild(this._canvas);this._resizeListenerId=R.register(this,this._handleResize.bind(this));}};
N.prototype._handleResize=function(e){this.fireResize({oldSize:e.oldSize,size:e.size});if(this._doBestFitAfterResize){this._doBestFitAfterResize=false;this._bestFit();}this._update();};
N.prototype._reset=function(){this._x=0;this._y=0;this._s=1.0;this._r=0;};
N.prototype._updateIMG=function(){if(this._img!=null){var x=this._x-(this._imageW-this._canvas.clientWidth)/2;var y=this._y-(this._imageH-this._canvas.clientHeight)/2;var t="matrix("+this._s+",0,0,"+this._s+","+x+","+y+")";this._img.style.transform=t;this._img.style.webkitTransform=t;this._img.style.msTransform=t;this._img.style.MozTransform=t;this._img.style.OTransform=t;}};
N.prototype._updateSVG=function(){if(this._svg!=null){var x=this._x-(this._imageW-this._canvas.clientWidth)/2;var y=this._y-(this._imageH-this._canvas.clientHeight)/2;if((this.x<0)&&(this.y<0)){x=0;y=0;}var t="matrix("+this._s+",0,0,"+this._s+","+x+","+y+");";this._svg.setAttribute("style","transform:"+t+"webkitTransform:"+t+"msTransform:"+t+"MozTransform:"+t+"OTransform:"+t);}};
N.prototype._updateError=function(){if(this._svgError!=null){var x=this._x-(this._imageW-this._canvas.clientWidth)/2;var y=this._y-(this._imageH-this._canvas.clientHeight)/2;if((this.x<0)&&(this.y<0)){x=0;y=0;}var t="matrix("+this._s+",0,0,"+this._s+","+x+","+y+");";this._svgError.setAttribute("style","transform:"+t+"webkitTransform:"+t+"msTransform:"+t+"MozTransform:"+t+"OTransform:"+t);}};
N.prototype._bestFit=function(){if(this._canvas.children[0]&&this._canvas.children[0].getBoundingClientRect()){var w=this._canvas.clientWidth/this._canvas.children[0].getBoundingClientRect().width,h=this._canvas.clientHeight/this._canvas.children[0].getBoundingClientRect().height,s=w<h?w:h;this.zoom(s);var o=q(this._canvas.children[0]).position().left-q(this._canvas).position().left,a=q(this._canvas.children[0]).position().top-q(this._canvas).position().top,i=this._canvas.children[0].getBoundingClientRect().width,b=this._canvas.children[0].getBoundingClientRect().height,v=this._canvas.getBoundingClientRect().width,c=this._canvas.getBoundingClientRect().height;var d=(v-i)/2-o,e=(c-b)/2-a;this.pan(d,e);this._s4BestFit=this._s;}};
N.prototype.loadUrl=function(u,o,a,b,c){if(/^(svg)$/.test(c.toLowerCase())){while(this._canvas.lastChild){this._canvas.removeChild(this._canvas.lastChild);}this._reset();this._svg=document.createElement("object");this._svg.setAttribute("type","image/svg+xml");this._svg.setAttribute("data",u);this._svg.setAttribute("id",this._svgid);this._svg.setAttribute("class","SVGImage");this._canvas.appendChild(this._svg);var s=document.createElement("div");this._canvas.appendChild(s);s.style.position="absolute";s.style.top=0;s.style.left=0;s.style.height="100%";s.style.width="100%";this._svg.style.visibility="hidden";this._svg.onload=function(){setTimeout(function(){this._imageW=this._svg.getBoundingClientRect().width;this._imageH=this._svg.getBoundingClientRect().height;this._s=1;this._update=this._updateSVG.bind(this);this._bestFit();o();this._svg.onload=undefined;}.bind(this),0);}.bind(this);this._svg.src=u;this._svg.onerror=function(){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT1.summary),M.VIT1.code,"sap.ui.vk.NativeViewport");a();if(this._svg.parentNode===this._canvas){this._canvas.removeChild(this._svg);}}.bind(this);return this;}else if(/^(jpg|png|gif|bmp|tif|tiff)$/.test(c.toLowerCase())){while(this._canvas.lastChild){this._canvas.removeChild(this._canvas.lastChild);}this._reset();this._img=new Image();this._img.onload=function(){this._imageW=this._img.width;this._imageH=this._img.height;setTimeout(function(){this._canvas.appendChild(this._img);this._update=this._updateIMG.bind(this);this._bestFit();}.bind(this),0);o();}.bind(this);this._img.onerror=function(){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT2.summary),M.VIT2.code,"sap.ui.vk.NativeViewport");a();};this._img.src=u;return this;}else{q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT3.summary),M.VIT3.code,"sap.ui.vk.NativeViewport");a();}};
N.prototype.loadFailed=function(t){while(this._canvas.lastChild){this._canvas.removeChild(this._canvas.lastChild);}this._reset();this._svgError=document.createElement("div");this._svgError.className="svgErrorContainer";this._svgErrorElement=document.createElementNS("http://www.w3.org/2000/svg","svg");this._svgErrorElement.setAttribute("width","550px");this._svgErrorElement.setAttribute("height","512px");this._svgErrorElement.setAttribute("viewBox","-244 -244 512 512");this._svgErrorElement.setAttribute("enable-background","new -244 -244 512 512");this._svgErrorElement.setAttribute("id","SVGError");var a=document.createElementNS("http://www.w3.org/2000/svg","rect");a.setAttribute("fill","#FFFFFF");a.setAttribute("x","-244");a.setAttribute("y","-244");a.setAttribute("width","512");a.setAttribute("height","512");a.setAttribute("opacity","0.1");this._svgErrorElement.appendChild(a);var b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("fill","#474747");b.setAttribute("d","M12.833,89.742c-70.781,0-128.366-57.584-128.366-128.366c0-70.781,57.584-128.365,128.366-128.365 s128.365,57.584,128.365,128.365C141.198,32.158,83.614,89.742,12.833,89.742z M12.833-146.989 c-59.753,0-108.366,48.612-108.366,108.365c0,59.752,48.613,108.366,108.366,108.366S121.198,21.129 121.198-38.624 C121.198-98.376,72.586-146.989,12.833-146.989z");b.setAttribute("opacity","0.3");this._svgErrorElement.appendChild(b);var c=document.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("fill","#474747");c.setAttribute("x","-2.167");c.setAttribute("y","-120.847");c.setAttribute("width","30");c.setAttribute("height","119.447");c.setAttribute("fill","#474747");c.setAttribute("opacity","0.3");this._svgErrorElement.appendChild(c);var d=document.createElementNS("http://www.w3.org/2000/svg","rect");d.setAttribute("fill","#474747");d.setAttribute("x","-2.167");d.setAttribute("y","13.6");d.setAttribute("width","30");d.setAttribute("height","30");d.setAttribute("opacity","0.3");this._svgErrorElement.appendChild(d);var e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("fill","#474747");e.setAttribute("d","M10.833,87.33c-70.781,0-128.366-57.584-128.366-128.365c0-70.781,57.584-128.365,128.366-128.365 s128.365,57.584,128.365,128.365C139.198,29.746,81.614,87.33,10.833,87.33z M10.833-149.4 c-59.753,0-108.366,48.612-108.366,108.365S-48.92,67.33,10.833,67.33S119.198,18.718,119.198-41.035S70.586-149.4,10.833-149.4z");this._svgErrorElement.appendChild(e);var f=document.createElementNS("http://www.w3.org/2000/svg","rect");f.setAttribute("fill","#474747");f.setAttribute("x","-4.167");f.setAttribute("y","-123.259");f.setAttribute("width","30");f.setAttribute("height","119.447");f.setAttribute("fill","#474747");this._svgErrorElement.appendChild(f);var g=document.createElementNS("http://www.w3.org/2000/svg","rect");g.setAttribute("fill","#474747");g.setAttribute("x","-4.167");g.setAttribute("y","11.188");g.setAttribute("width","30");g.setAttribute("height","30");g.setAttribute("fill","#474747");this._svgErrorElement.appendChild(g);var h=document.createElementNS("http://www.w3.org/2000/svg","text");h.setAttribute("id","textError");h.setAttribute("left","auto");h.setAttribute("right","auto");h.setAttribute("y","150");h.setAttribute("x","10");h.setAttribute("display","block");h.setAttribute("text-anchor","middle");h.setAttribute("fill","#474747");h.setAttribute("style","font-family:Arial");h.setAttribute("font-size","32");h.textContent=t?t:sap.ui.vk.getResourceBundle().getText("VIEWPORT_MESSAGEUNSUPPORTEDFILEFORMAT");this._svgErrorElement.appendChild(h);this._svgError.appendChild(this._svgErrorElement);this._canvas.appendChild(this._svgError);this._imageW=this._errorImageWidth;this._imageH=this._errorImageHeight;this._update=this._updateError.bind(this);this._doBestFitAfterResize=true;setTimeout(function(){this._bestFit();}.bind(this),0);q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT4.summary),M.VIT4.code,"sap.ui.vk.NativeViewport");return this;};
N.prototype.beginGesture=function(x,y){this._gx=(x-this._canvas.clientWidth/2-this._x)/this._s;this._gy=(y-this._canvas.clientHeight/2-this._y)/this._s;return this;};
N.prototype.endGesture=function(){this._gx=0;this._gy=0;return this;};
N.prototype.pan=function(d,a){this._x+=d;this._y+=a;this._update();this.fireMove({pan:{x:d,y:a},zoom:1.0});return this;};
N.prototype.rotate=function(d,a){this._x+=d;this._y+=a;this._update();this.fireMove({pan:{x:d,y:a},zoom:1.0});return this;};
N.prototype.zoom=function(z){var g=this._gx*this._s;var a=this._gy*this._s;var n=this._s*z;var b=(this.getLimitZoomOut())?this._s4BestFit*0.25:0.0001;var c=500;if((n>b)&&(n<c)){this._s=n;}else if(n<c){z=b/this._s;this._s=b;}else{z=c/this._s;this._s=c;}var d=this._gx*this._s;var e=this._gy*this._s;var f=g-d;var h=a-e;this._x+=f;this._y+=h;this._update();this.fireMove({pan:{x:f,y:h},zoom:z});return this;};
N.prototype.tap=function(x,y,i){if(i){this._bestFit();}return this;};
N.prototype.queueCommand=function(c){c();return this;};
N.prototype.getViewInfo=function(){var v={};v.camera=[this._s,0,0,this._s,this._x,this._y];return v;};
N.prototype.setViewInfo=function(v){var c=v.camera;this._s=c[0];this._x=c[4];this._y=c[5];this._update();return this;};
N.prototype.getOutputSize=function(){var c=this.getViewInfo().camera,b=this.getDomRef().getBoundingClientRect();return{left:b.width/2+c[4],top:b.height/2+c[5],sideLength:this._canvas.children[0].getBoundingClientRect().width};};
var r=2;var p=2;[{key:"left",dx:-p,dy:0},{key:"right",dx:+p,dy:0},{key:"up",dx:0,dy:-p},{key:"down",dx:0,dy:+p}].forEach(function(i){N.prototype["onsap"+i.key]=function(e){this.beginGesture(this.$().width()/2,this.$().height()/2);this.pan(i.dx,i.dy);this.endGesture();e.preventDefault();e.stopPropagation();};});[{key:"left",dx:-r,dy:0},{key:"right",dx:+r,dy:0},{key:"up",dx:0,dy:-r},{key:"down",dx:0,dy:+r}].forEach(function(i){N.prototype["onsap"+i.key+"modifiers"]=function(e){if(e.shiftKey&&!(e.ctrlKey||e.altKey||e.metaKey)){this.beginGesture(this.$().width()/2,this.$().height()/2);this.rotate(i.dx,i.dy);this.endGesture();e.preventDefault();e.stopPropagation();}};});[{key:"minus",d:0.98},{key:"plus",d:1.02}].forEach(function(i){N.prototype["onsap"+i.key]=function(e){this.beginGesture(this.$().width()/2,this.$().height()/2);this.zoom(i.d);this.endGesture();e.preventDefault();e.stopPropagation();};});return N;});
sap.ui.predefine('sap/ui/vk/Notifications',["jquery.sap.global","./library","sap/ui/core/Control","./Messages"],function(q,l,C,M){"use strict";
var N=C.extend("sap.ui.vk.Notifications",{metadata:{library:"sap.ui.vk",publicMethods:["clearAllMessages"],aggregations:{_messagePopover:{type:"sap.m.MessagePopover",multiple:false,visibility:"hidden"},_messagePopoverToggleButton:{type:"sap.m.ToggleButton",multiple:false,visibility:"hidden"}},events:{allMessagesCleared:{},messageAdded:{}}}});
N.prototype.init=function(){if(C.prototype.init){C.prototype.init.call(this);}var m;var a=new sap.m.ToggleButton({icon:"sap-icon://message-popup",type:sap.m.ButtonType.Emphasized,tooltip:sap.ui.vk.getResourceBundle().getText("MESSAGEPOPOVERBUTTON"),text:"0",press:function(e){if(a.getPressed()){m.openBy(a);}else{m.close();}}});a.addStyleClass("messagePopoverButton");this.setAggregation("_messagePopoverToggleButton",a);m=new sap.m.MessagePopover({headerButton:new sap.m.Button({text:sap.ui.vk.getResourceBundle().getText("MESSAGEPOPOVER_CLEARBUTTON"),type:sap.m.ButtonType.Emphasized,tooltip:sap.ui.vk.getResourceBundle().getText("MESSAGEPOPOVER_CLEARBUTTON"),press:function(e){m.getParent().clearAllMessages();}}),afterClose:a.setPressed.bind(a,false)});m.addStyleClass("sapVizKitNotificationPopover");this.setAggregation("_messagePopover",m);q.sap.log.addLogListener(this);};
N.prototype.exit=function(){q.sap.log.removeLogListener(this);if(C.prototype.exit){C.prototype.exit.call(this);}};
N.prototype.onLogEntry=function(e){if(/^sap\.ui\.vk/.test(e.component)){var m=e.details,c,r,a;if(M[e.details]){m=sap.ui.vk.getResourceBundle().getText(M[e.details].summary);c=sap.ui.vk.getResourceBundle().getText(M[e.details].cause);r=sap.ui.vk.getResourceBundle().getText(M[e.details].resolution);a=sap.ui.vk.getResourceBundle().getText("ERROR_DESCRIPTION_CODE");}var b=sap.ui.vk.getResourceBundle().getText("ERROR_DESCRIPTION_COMPONENT");var d=sap.ui.vk.getResourceBundle().getText("ERROR_DESCRIPTION_DATE");var t=sap.ui.vk.getResourceBundle().getText("ERROR_DESCRIPTION_TIME");var f=sap.ui.vk.getResourceBundle().getText("ERROR_DESCRIPTION_LEVEL");var g=sap.ui.vk.getResourceBundle().getText("ERROR_DESCRIPTION_MESSAGE");var h=sap.ui.vk.getResourceBundle().getText("ERROR_DESCRIPTION_CAUSE");var i=sap.ui.vk.getResourceBundle().getText("ERROR_DESCRIPTION_RESOLUTION");var j="<div><b>"+b+":</b><br>"+e.component+"</div><br>"+"<div><b>"+d+":</b><br>"+e.date+"</div><br>"+(a?"<div><b>"+a+":</b><br>"+e.details+"</div><br>":"")+"<div><b>"+t+":</b><br>"+e.time.slice(0,e.time.indexOf("."))+"</div><br>"+"<div><b>"+f+":</b><br>"+e.level+"</div><br>"+"<div><b>"+g+":</b><br>"+m+"</div><br>"+(c?"<div><b>"+h+":</b><br>"+c+"</div><br>":"")+(r?"<div><b>"+i+":</b><br>"+r+"</div>":"");var k=new sap.m.MessagePopoverItem({markupDescription:true,title:e.message,description:j});var n=this.getAggregation("_messagePopover");n.addItem(k);this.getAggregation("_messagePopoverToggleButton").setText(n.getItems().length);this.fireMessageAdded();}};
N.prototype.clearAllMessages=function(){var m=this.getAggregation("_messagePopover");m.removeAllItems();m.close();this.getAggregation("_messagePopoverToggleButton").setText(m.getItems().length);this.fireAllMessagesCleared();return this;};
return N;});
sap.ui.predefine('sap/ui/vk/Overlay',["jquery.sap.global","./library","sap/ui/core/Control","sap/ui/vbm/library","sap/ui/vbm/lib/sapvbi","./Messages"],function(q,l,C,v,a,M){"use strict";
var O=C.extend("sap.ui.vk.Overlay",{metadata:{library:"sap.ui.vk",properties:{zoomOnResize:{type:"boolean",group:"Behavior",defaultValue:true}},aggregations:{areas:{type:"sap.ui.vk.OverlayArea",multiple:true,singularName:"area"}},associations:{target:{type:"sap.ui.core.Control",cardinality:"0..1"}},events:{click:{parameters:{clientX:{type:"int"},clientY:{type:"int"},pos:{type:"string"}}},contextMenu:{parameters:{pos:{type:"string"},menu:{type:"sap.ui.unified.Menu"}}}}}});
O.prototype.getPositionInteractive=function(p,c){if(!this.mIACreateCB&&c&&typeof(c)==="function"){this.mIACreateCB=c;var t="POS";if(p){t+="ARRAY";}var L={"SAPVB":{"Automation":{"Call":{"handler":"OBJECTCREATIONHANDLER","name":"CreateObject","object":"MainScene","scene":"MainScene","instance":"","Param":{"name":"data","#":"{"+t+"}"}}}}};this._load(L);return true;}else{return false;}};
O.prototype.openContextMenu=function(m){this._openContextMenu("Overlay",this,m);};
O.prototype.setPanAndZoom=function(n,b,z){if(n===0&&b===0&&z===1){return;}var s=this.mVBIContext.GetMainScene();this.totalCenterOffset.dx+=n;this.totalCenterOffset.dy+=b;if(z===1){s.MoveMap(n,b);}else{var c=s.m_Canvas[0];var d=c.m_nExactLOD+Math.log(z)*Math.LOG2E;s.ZoomToGeoPosition(VBI.MathLib.DegToRad([0.5,0.5]),d);s.MoveMap(this.totalCenterOffset.dx,this.totalCenterOffset.dy);}};
O.prototype.reset=function(){this.totalCenterOffset.dx=this.totalCenterOffset.dy=0;var s=this.mVBIContext.GetMainScene();if(s){s.ZoomToGeoPosition(VBI.MathLib.DegToRad([0.5,0.5]),this.initialZoom);}return this;};
O.prototype.init=function(){this.aLoadQueue=null;this.oTargetDomRef=null;this.mVBIContext=new VBI.VBIContext(this);this.resizeID="";this.resizeIDTarget="";this.bVosDirty=true;this.bWindowsDirty=true;this.bSceneDirty=true;this.bDataDeltaUpdate=false;this.bHandleDataChangeActive=false;this.bForceDataUpdate=false;this.mAddMenuItems=[];this.totalCenterOffset={dx:0,dy:0};this.initialZoom=10;};
O.prototype.exit=function(){if(this.mVBIContext){this.mVBIContext.clear();}if(this.resizeID!=""){sap.ui.core.ResizeHandler.deregister(this.resizeID);this.resizeID="";}if(this.resizeIDTarget!=""){sap.ui.core.ResizeHandler.deregister(this.resizeIDTarget);this.resizeIDTarget="";}};
O.prototype.resize=function(e){var c=(this.oControl!=undefined)?this.oControl:this;var b=c.mVBIContext;if(b){var s=b.GetMainScene();if(s){if(c.getZoomOnResize()&&e&&e.oldSize.width>0){var z=Math.log(e.size.width/e.oldSize.width)*Math.LOG2E;s.ZoomToGeoPosition(s.GetCenterPos(),s.GetCurrentZoomlevel()+z,false,true,true);}s.resizeCanvas(e,true,true);}}};
O.prototype.setTarget=function(t){if(!t){return;}this.setAssociation("target",t);this.reset();if(t instanceof sap.m.Image){t.addDelegate({onAfterRendering:function(e){this.oTargetDomRef=t.getDomRef();this.oTargetDomRef.addEventListener("load",q.proxy(this._adaptSizeOfTarget,this));}.bind(this)});}else{t.addDelegate({onAfterRendering:function(e){this.oTargetDomRef=t.getDomRef();this._adaptSizeOfTarget();}.bind(this)});}if(this.resizeIDTarget!=""){sap.ui.core.ResizeHandler.deregister(this.resizeIDTarget);this.resizeIDTarget="";}this.resizeIDTarget=sap.ui.core.ResizeHandler.register(t,this._adaptSizeOfTarget.bind(this));};
O.prototype._adaptSizeOfTarget=function(){var t=this.oTargetDomRef;var d=this.getDomRef();if(t){try{var T=q(t);var p={top:T.offset().top,left:T.offset().left,width:T.outerWidth(),height:T.outerHeight()};q(d).width(p.width).height(p.height).css("position","absolute");q(d).css("top","0px").css("left","0px").css("visibility","");}catch(e){q.sap.log.error(e);}}else{q(d).css("position","fixed").width("0px").height("0px").css("top","0px").css("left","0px").css("visibility","hidden");}};
O.prototype.onAfterRendering=function(){if(this.$oldContent.length>0){this.$().append(this.$oldContent);}this._adaptSizeOfTarget();if(this.aLoadQueue){var n;for(n=0;n<this.aLoadQueue.length;++n){this._load(this.aLoadQueue[n]);}this.aLoadQueue=null;}if(this.resizeID==""){this.resize();this.resizeID=sap.ui.core.ResizeHandler.register(this,this.resize);}var o=this.getId();if(this.mVBIContext.m_Windows){this.mVBIContext.m_Windows.Awake(o);}};
O.prototype.onBeforeRendering=function(){this.$oldContent=sap.ui.core.RenderManager.findPreservedContent(this.getId());};
O.prototype.invalidate=function(s){this.bSceneDirty=true;if(s instanceof sap.ui.vk.OverlayArea){this.bVosDirty=true;this.bDataDeltaUpdate=this.bHandleDataChangeActive;}sap.ui.core.Control.prototype.invalidate.apply(this,arguments);};
O.prototype._load=function(d){if(!this.isRendered()){if(!this.aLoadQueue){this.aLoadQueue=[];}this.aLoadQueue.push(d);return;}this._loadHtml(d);};
O.prototype._loadHtml=function(d){var o=this.getId();var b=null;if(typeof d=="string"){b=JSON.parse(d.indexOf("{")?d.substr(d.indexOf("{")):d);}else if(typeof d=="object"){b=d;}if(!b){return;}if(!b["SAPVB"]){var m;if(this.mVBIContext&&(m=(new VBI.Adaptor(this.mVBIContext)).CreateLoadData(b))){this.loadHtml(m);return;}else{return;}}var c=false;var e=false;var f=false;if(q.type(b)=="object"){if(b.SAPVB){if(b.SAPVB.Config){this.mVBIContext.GetConfig().load(b.SAPVB.Config,this.mVBIContext);}if(b.SAPVB.Resources){this.mVBIContext.GetResources().load(b.SAPVB.Resources,this.mVBIContext);}if(b.SAPVB.DataTypes){if(!this.mVBIContext["m_DataTypeProvider"]){this.mVBIContext["m_DataTypeProvider"]=new VBI.DataTypeProvider();}this.mVBIContext["m_DataTypeProvider"].load(b.SAPVB.DataTypes,this.mVBIContext);}if(b.SAPVB.Data){if(!this.mVBIContext["m_DataProvider"]){this.mVBIContext["m_DataProvider"]=new VBI.DataProvider();}this.mVBIContext["m_DataProvider"].load(b.SAPVB.Data,this.mVBIContext);c=true;}if(b.SAPVB.Windows){if(!this.mVBIContext["m_Windows"]){this.mVBIContext["m_Windows"]=new VBI.Windows();}this.mVBIContext["m_Windows"].load(b.SAPVB.Windows,this.mVBIContext);f=true;}if(b.SAPVB.Actions){if(!this.mVBIContext["m_Actions"]){this.mVBIContext["m_Actions"]=new VBI.Actions();}this.mVBIContext["m_Actions"].load(b.SAPVB.Actions,this.mVBIContext);}if(b.SAPVB.Automation){if(!this.mVBIContext["m_Automations"]){this.mVBIContext["m_Automations"]=new VBI.Automations();}this.mVBIContext["m_Automations"].load(b.SAPVB.Automation,this.mVBIContext);}if(b.SAPVB.Menus){if(!this.mVBIContext["m_Menus"]){this.mVBIContext["m_Menus"]=new VBI.Menus();}this.mVBIContext["m_Menus"].load(b.SAPVB.Menus,this.mVBIContext);}if(b.SAPVB.Scenes){if(!this.mVBIContext["m_SceneManager"]){this.mVBIContext["m_SceneManager"]=new VBI.SceneManager();}this.mVBIContext["m_SceneManager"].load(b.SAPVB.Scenes,this.mVBIContext);e=true;}}if(c){if(this.mVBIContext["m_Windows"]){this.mVBIContext["m_Windows"].NotifyDataChange();}}if(e||f){if(this.mVBIContext["m_Windows"]){this.mVBIContext["m_Windows"].Awake(o);}}if(e||c){if(this.mVBIContext["m_Windows"]){this.mVBIContext["m_Windows"].RenderAsync();}}}};
O.prototype._openContextMenu=function(t,i,m){if(m&&m.vbi_data&&m.vbi_data.VBIName=="DynContextMenu"){if(!this.mVBIContext["m_Menus"]){this.mVBIContext["m_Menus"]=new window.VBI.Menus();}for(var n=0;n<this.mAddMenuItems.length;++n){m.addItem(this.mAddMenuItems[n]);}this.mVBIContext.m_Menus.m_menus.push(m);this._loadHtml({"SAPVB":{"version":"2.0","Automation":{"Call":{"earliest":"0","handler":"CONTEXTMENUHANDLER","instance":i.sId,"name":"SHOW","object":t,"refID":"CTM","Param":[{"name":"x","#":i.mClickPos[0]},{"name":"y","#":i.mClickPos[1]},{"name":"scene","#":"MainScene"}]}}}});}this.mAddMenuItems=[];};
O.prototype._update=function(){var A={SAPVB:{}};if(this.bSceneDirty){this._updateScene(A);}this._updateWindows(A);if(A.SAPVB.Actions){Array.prototype.push.apply(A.SAPVB.Actions.Set.Action,this._getActionArray());}return this._minimizeApp(A);};
O.prototype._minimizeApp=function(A){var t,s;var c;s=null;if(!this.bWindowsDirty){c=(t=A)&&(t=t.SAPVB)&&(t=t.Windows)&&(s=JSON.stringify(t))&&(s==this.mCurWindows)&&(delete A.SAPVB.Windows);if(!c){this.mCurWindows=s?s:this.mCurWindows;}}else{this.bWindowsDirty=false;}s=null;c=(t=A)&&(t=t.SAPVB)&&(t=t.Scenes)&&(s=JSON.stringify(t))&&(s==this.mCurScenes)&&(delete A.SAPVB.Scenes);if(!c){this.mCurScenes=s?s:this.mCurScenes;}s=null;c=(t=A)&&(t=t.SAPVB)&&(t=t.Actions)&&(s=JSON.stringify(t))&&(s==this.mCurActions)&&(delete A.SAPVB.Actions);if(!c){this.mCurActions=s?s:this.mCurActions;}s=null;c=(t=A)&&(t=t.SAPVB)&&(t=t.DataTypes)&&(s=JSON.stringify(t))&&(s==this.mCurDataTypes)&&(delete A.SAPVB.DataTypes);if(!c){this.mCurDataTypes=s?s:this.mCurDataTypes;}if(!this.bForceDataUpdate){s=null;c=(t=A)&&(t=t.SAPVB)&&(t=t.Data)&&(s=JSON.stringify(t))&&(s==this.mCurData)&&(delete A.SAPVB.Data);if(!c){this.mCurData=s?s:this.mCurData;}}else{this.bForceDataUpdate=false;}return A;};
O.prototype._updateWindows=function(A){A.SAPVB.Windows={"Set":[{"name":"Main","Window":{"id":"Main","caption":"MainWindow","type":"geo","refParent":"","refScene":"MainScene","modal":"true"}}]};};
O.prototype._updateScene=function(A){var s=[];var b=[];var c=[];var d=[];this._updateVOData(s,b,c,d);var _=JSON.stringify(s);var m=true;if(!this.saVO){((((A.SAPVB.Scenes={}).Set={}).SceneGeo={id:"MainScene",scaleVisible:"false",navControlVisible:"false",VisualFrame:{minLOD:5},NavigationDisablement:{move:"true",zoom:"true"},initialZoom:this.initialZoom.toString(),initialStartPosition:"0.5;0.5;0"}).VO=s);}else if(this.bRefMapLayerStackDirty||!(this.saVO===_)){(A.SAPVB.Scenes=this._getSceneVOdelta(JSON.parse(this.m_saVO),s));}else{m=false;}this.saVO=_;if(this.bDataDeltaUpdate){A.SAPVB.Data=[];for(var n=0;n<b.length;++n){A.SAPVB.Data.push({Set:{name:b[n].name,type:"N",N:b[n]}});}}else{((A.SAPVB.Data={}).Set={}).N=b;}if(m){(((A.SAPVB.DataTypes={}).Set={}).N=c);}(((A.SAPVB.Actions={}).Set={}).Action=d);this.bSceneDirty=this.bVosDirty=this.bDataDeltaUpdate=false;};
O.prototype._isEventRegistered=function(A,e){var b=this.getAggregation(A);if(!b){return false;}for(var n=0;n<b.length;++n){var i=b[n];if(i.hasListeners(e)){return true;}}return false;};
O.prototype._getTemplateBindingInfo=function(A){var b=this.getBindingInfo(A);if(b&&b.template){return b.template.mBindingInfos;}};
O.prototype._getBindInfo=function(A){var b={};var t=this._getTemplateBindingInfo(A);b.C=(t)?t.hasOwnProperty("color"):true;b.CB=(t)?t.hasOwnProperty("colorBorder"):true;b.DCH=(t)?t.hasOwnProperty("deltaColorHot"):true;b.CS=(t)?t.hasOwnProperty("colorSelect"):true;b.CNS=(t)?t.hasOwnProperty("colorNonSelect"):true;b.TT=(t)?t.hasOwnProperty("tooltip"):true;b.M=(t)?t.hasOwnProperty("changeable"):true;b.hasTemplate=(t)?true:false;return b;};
O.prototype._updateVOData=function(s,b,c,d){var B,V;this.AreaBindInfo=B=(this.AreaBindInfo)?this.AreaBindInfo:this._getBindInfo("areas");V=(B.hasTemplate)?this.getBindingInfo("areas").template:null;var o={id:"OverlayArea",datasource:"OverlayArea",type:"{00100000-2012-0004-B001-F311DE491C77}"};o["posarray.bind"]=o.id+".P";if(B.C){o["color.bind"]=o.id+".C";}else{o.color=V.getColor();}if(B.CB){o["colorBorder.bind"]=o.id+".C";}else{o.colorBorder=V.getColorBorder();}if(B.DCH){o["hotDeltaColor.bind"]=o.id+".DCH";}else{o.hotDeltaColor=V.getDeltaColorHot();}if(B.CS){o["colorSelect.bind"]=o.id+".C";}else{o.colorSelect=V.getColorSelect();}if(B.CNS){o["colorNonSelect.bind"]=o.id+".C";}else{o.colorNonSelect=V.getColorNonSelect();}if(!B.M){o["VB:c"]=V.getChangeable();}s.push(o);var e={name:o.id,key:"K"};e.A=[{"name":"K","alias":"K","type":"string"},{"name":"VB:s","alias":"VB:s","type":"boolean"},{"name":"P","alias":"P","type":"vectorarray","changeable":"true"}];if(B.C){e.A.push({"name":"C","alias":"C","type":"color"});}if(B.CB){e.A.push({"name":"CB","alias":"CB","type":"string"});}if(B.DCH){e.A.push({"name":"DCH","alias":"DCH","type":"string"});}if(B.CS){e.A.push({"name":"CS","alias":"CS","type":"string"});}if(B.CNS){e.A.push({"name":"CNS","alias":"CNS","type":"string"});}if(B.TT){e.A.push({"name":"TT","alias":"TT","type":"string"});}c.push(e);var i=o.id;if(this._isEventRegistered("areas","click")){d.push({"id":i+"1","name":"click","refScene":"MainScene","refVO":i,"refEvent":"Click","AddActionProperty":[{"name":"pos"}]});}if(this._isEventRegistered("areas","contextMenu")){d.push({"id":i+"2","name":"contextMenu","refScene":"MainScene","refVO":i,"refEvent":"ContextMenu"});}if(this._isEventRegistered("areas","edgeClick")){d.push({"id":i+"7","name":"edgeClick","refScene":"MainScene","refVO":i,"refEvent":"EdgeClick"});}d.push({"id":i+"4","name":"handleMoved","refScene":"MainScene","refVO":i,"refEvent":"HandleMoved"});d.push({"id":i+"5","name":"handleContextMenu","refScene":"MainScene","refVO":i,"refEvent":"HandleContextMenu"});d.push({"id":i+"8","name":"edgeContextMenu","refScene":"MainScene","refVO":i,"refEvent":"EdgeContextMenu"});if(this._isEventRegistered("areas","handleClick")){d.push({"id":i+"6","name":"handleClick","refScene":"MainScene","refVO":i,"refEvent":"HandleClick"});}var f={name:o.id,E:[]};var g=this.getAreas();for(var n=0;n<g.length;++n){f.E.push(g[n].getDataElement());}b.push(f);};
O.prototype._getSceneVOdelta=function(c,n){var V=[];var r=[];var o={};for(var b=0,d=c.length;b<d;++b){o[c[b].id]=c[b];}for(var e=0;e<n.length;++e){if(o[n[e].id]){if(JSON.stringify(n[e])!=JSON.stringify(o[n[e].id])){r.push({"id":n[e].id,"type":"VO"});V.push(n[e]);}}else{V.push(n[e]);}delete o[n[e].id];}for(var i in o){r.push({"id":i,"type":"VO"});}var f={"Merge":{"name":"MainScene","type":"SceneGeo","SceneGeo":{"id":"MainScene"}}};if(r.length){f.Merge.SceneGeo.Remove=r;}if(V.length){f.Merge.SceneGeo.VO=V;}return f;};
O.prototype._getActionArray=function(){var A=[];if(this.mEventRegistry["click"]){A.push({"id":"Overlay1","name":"click","refScene":"MainScene","refVO":"Map","refEvent":"Click","AddActionProperty":[{"name":"pos"}]});}if(this.mEventRegistry["contextMenu"]){A.push({"id":"Overlay2","name":"contextMenu","refScene":"MainScene","refVO":"Map","refEvent":"ContextMenu","AddActionProperty":[{"name":"pos"}]});}A.push({"id":"Overlay3","name":"GetPosComplete","refScene":"MainScene","refVO":"General","refEvent":"CreateComplete"});return A;};
O.prototype._handleChangedData=function(n){try{this.bHandleDataChangeActive=true;if(n&&n.length){for(var b=0,N;b<n.length;++b){N=n[b];if(N.E&&N.E.length){for(var c=0,e,i;c<N.E.length;++c){e=N.E[c];i=this._findInstance(e.K);if(i){i.handleChangedData(e);}}}}}this.bHandleDataChangeActive=false;}catch(d){this.bHandleDataChangeActive=false;throw d;}};
O.prototype._findInstance=function(i){var I=(i.indexOf(".")!==-1)?i.split(".")[1]:i;var A=this.getAreas();for(var n=0;n<A.length;++n){var e=A[n];if(e.getId()===I){return e;}}return null;};
O.prototype._handleAggregationEvent=function(e){var E;if((E=this._findInstance(e.Action.instance))){try{E.handleEvent(e);}catch(b){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT11.summary),M.VIT11.code,"sap.ui.vk.Overlay");}}};
O.prototype.isRendered=function(){return this.getDomRef()?true:false;};
O.prototype.fireSubmit=function(e){var d=JSON.parse(e.data);if(d.Data&&d.Data.Merge){this._handleChangedData(d.Data.Merge.N);}if(d.Action.object==="OverlayArea"){this._handleAggregationEvent(d);}else{var A=d.Action.name,c;if(A==="click"||A==="contextMenu"){c=[d.Action.Params.Param[0]["#"],d.Action.Params.Param[1]["#"]];}switch(A){case"GetPosComplete":if(this.mIACreateCB){try{this.mIACreateCB(d.Action.Params.Param[0]["#"]);this.mIACreateCB=null;}catch(b){this.mIACreateCB=null;throw b;}}break;case"click":this.fireClick({clientX:c[0],clientY:c[1],pos:d.Action.AddActionProperties.AddActionProperty[0]["#"]});break;case"contextMenu":if(this.mVBIContext.m_Menus){this.mVBIContext.m_Menus.deleteMenu("DynContextMenu");}sap.ui.getCore().loadLibrary("sap.ui.unified");var m=new sap.ui.unified.Menu();m["vbi_data"]={};m["vbi_data"].menuRef="CTM";m["vbi_data"].VBIName="DynContextMenu";this.mClickPos=c;this.fireContextMenu({pos:d.Action.AddActionProperties.AddActionProperty[0]["#"],menu:m});break;default:break;}}};
O.prototype.fireRender=function(d){};
O.prototype.fireMove=function(d){};
O.prototype.fireZoom=function(d){};
O.prototype.fireOpenWindow=function(d){};
O.prototype.fireCloseWindow=function(d){};
return O;});
sap.ui.predefine('sap/ui/vk/OverlayArea',["./library","sap/ui/core/Element"],function(l,E){"use strict";
var O=E.extend("sap.ui.vk.OverlayArea",{metadata:{library:"sap.ui.vk",properties:{key:{type:"string",group:"Misc",defaultValue:null},position:{type:"string",group:"Misc",defaultValue:null},color:{type:"sap.ui.core.CSSColor",group:"Misc",defaultValue:"rgba(200, 50, 50, 0.3)"},colorBorder:{type:"sap.ui.core.CSSColor",group:"Misc",defaultValue:"rgba(200, 50, 50, 1.0)"},colorSelect:{type:"string",group:"Misc",defaultValue:null},colorNonSelect:{type:"string",group:"Misc",defaultValue:null},deltaColorHot:{type:"string",group:"Misc",defaultValue:"RHLSA(0;1.3;1.0;1.0)"},select:{type:"boolean",group:"Misc",defaultValue:false},changeable:{type:"boolean",group:"Misc",defaultValue:false}},events:{click:{clientX:{type:"int"},clientY:{type:"int"}},contextMenu:{parameters:{menu:{type:"sap.ui.unified.Menu"}}},edgeClick:{parameters:{index:{type:"int"}}},edgeContextMenu:{parameters:{index:{type:"int"},menu:{type:"sap.ui.unified.Menu"}}},handleMoved:{},handleContextMenu:{parameters:{index:{type:"int"},menu:{type:"sap.ui.unified.Menu"}}},handleClick:{index:{type:"int"}}}}});
O.prototype.openContextMenu=function(m){this.getParent().openContextMenu("OverlayArea",this,m);};
O.prototype.getDataElement=function(){var e={};var b=this.getParent().AreaBindInfo;e.K=this.getId();if(b.C){e.C=this.getColor();}if(b.CB){e.CB=this.getColorBorder();}if(b.DCH){e.DCH=this.getDeltaColorHot();}if(b.CS){e.CS=this.getColorSelect();}if(b.CNS){e.CNS=this.getColorNonSelect();}if(b.TT){e.TT=this.getTooltip();}e["VB:s"]=this.getSelect();e.P=this.getPosition();if(b.M){e["VB:c"]=this.getChangeable();}return e;};
O.prototype.handleChangedData=function(e){if(e.P){this.setPosition(e.P);}};
O.prototype.handleEvent=function(e){var a=e.Action.name;var f="fire"+a[0].toUpperCase()+a.slice(1);if(a==="contextMenu"||a==="edgeContextMenu"||a==="handleContextMenu"){var p=this.getParent();this.mClickPos=[e.Action.Params.Param[0]["#"],e.Action.Params.Param[1]["#"]];if(p.mVBIContext.m_Menus){p.mVBIContext.m_Menus.deleteMenu("DynContextMenu");}sap.ui.getCore().loadLibrary("sap.ui.unified");var m=new sap.ui.unified.Menu();m["vbi_data"]={};m["vbi_data"].menuRef="CTM";m["vbi_data"].VBIName="DynContextMenu";if(this.getChangeable()){if(a==="edgeContextMenu"){var s=e.Action.Params.Param[2]["#"];p.mAddMenuItems.push(new sap.ui.unified.MenuItem({text:sap.ui.vk.getResourceBundle().getText("OVL_AREA_EDGE_SPLIT"),select:this._handleCtxFunction.bind(this,"SPLIT",s)}));}else if(a==="handleContextMenu"){var h=e.Action.Params.Param[2]["#"];p.mAddMenuItems.push(new sap.ui.unified.MenuItem({text:sap.ui.vk.getResourceBundle().getText("OVL_AREA_HANDLE_REMOVE"),select:this._handleCtxFunction.bind(this,"REMOVE",h)}));}}if(this.hasListeners(a)){if(a==="contextMenu"){this.firecontextMenu({menu:m});}else{this[f]({index:e.Action.Params.Param[2]["#"],menu:m});}}else{p._openContextMenu(e.Action.object,this,m);}}else if(a=="click"){this.mClickPos=e.Action.AddActionProperties.AddActionProperty[0]["#"];this.fireClick({clientX:e.Action.Params.Param[0]["#"],clientY:e.Action.Params.Param[1]["#"]});}else if(a.indexOf("Click")>-1){this[f]({index:e.Action.Params.Param[2]["#"]});}else{this[f]();}};
O.prototype.getKey=function(){var k=this.getProperty("key");if(!k){k=this.getId();}return k;};
O.prototype._handleCtxFunction=function(f,c){var p=this.getPosition().split(";");var o=c*3;if(f==="REMOVE"){p.splice(o,3);}else if(f==="SPLIT"){var s=[p[o],p[o+1]];var e=(o+3<p.length)?[p[o+3],p[o+4]]:[p[0],p[1]];var m=[parseFloat(s[0])+(e[0]-s[0])/2,parseFloat(s[1])+(e[1]-s[1])/2];p.splice(o+3,0,m[0].toString(),m[1].toString(),"0");}this.setPosition(p.toString().replace(/,/g,";"));};
return O;});
sap.ui.predefine('sap/ui/vk/OverlayRenderer',function(){"use strict";var O={};
O.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapUiVkOverlay");r.writeClasses(c);r.write(">");r.write("</div>");var a;if((a=c._update())){c._load(a);}};
return O;},true);
sap.ui.predefine('sap/ui/vk/Viewer',["jquery.sap.global","./library","sap/ui/core/Control","./Scene","./ContentResource","sap/ui/layout/Splitter","sap/ui/layout/SplitterLayoutData","./FlexibleControl","./FlexibleControlLayoutData","sap/ui/core/ResizeHandler","./DvlException","./Messages","./ProgressIndicator","./Notifications"],function(q,l,C,S,a,b,c,F,d,R,D,M,P,N){"use strict";var f=q.sap.log;sap.ui.lazyRequire("sap.ui.vk.NativeViewport");sap.ui.lazyRequire("sap.ui.vk.Overlay");sap.ui.lazyRequire("sap.ui.vk.SceneTree");sap.ui.lazyRequire("sap.ui.vk.StepNavigation");sap.ui.lazyRequire("sap.ui.vk.Toolbar");sap.ui.lazyRequire("sap.ui.vk.Viewport");
var V=C.extend("sap.ui.vk.Viewer",{metadata:{library:"sap.ui.vk",properties:{enableOverlay:{type:"boolean",defaultValue:false},enableSceneTree:{type:"boolean",defaultValue:true},showSceneTree:{type:"boolean",defaultValue:true},enableStepNavigation:{type:"boolean",defaultValue:true},enableNotifications:{type:"boolean",defaultValue:true},showStepNavigation:{type:"boolean",defaultValue:false},showStepNavigationThumbnails:{type:"boolean",defaultValue:true},enableToolbar:{type:"boolean",defaultValue:true},enableProgressIndicator:{type:"boolean",defaultValue:true},width:{type:"sap.ui.core.CSSSize",defaultValue:"auto"},height:{type:"sap.ui.core.CSSSize",defaultValue:"auto"},toolbarTitle:{type:"string",defaultValue:""},shouldTrackVisibilityChanges:{type:"boolean",defaultValue:false},runtimeSettings:{type:"object"},webGLContextAttributes:{type:"object"},showAllHotspots:{type:"boolean",defaultValue:false},hotspotColorABGR:{type:"int",defaultValue:0xc00000ff},hotspotColor:{type:"sap.ui.core.CSSColor",defaultValue:"rgba(255, 0, 0, 0.7529411764705882)"}},publicMethods:["getGraphicsCore","getNativeViewport","getScene","getViewport","getViewStateManager","activateFullScreenMode"],aggregations:{contentResources:{type:"sap.ui.vk.ContentResource"},overlay:{type:"sap.ui.vk.Overlay",multiple:false},toolbar:{type:"sap.ui.vk.Toolbar",multiple:false,visibility:"hidden"},progressIndicator:{type:"sap.ui.vk.ProgressIndicator",multiple:false,visibility:"hidden"},viewport:{type:"sap.ui.vk.Viewport",multiple:false,visibility:"hidden"},nativeViewport:{type:"sap.ui.vk.NativeViewport",multiple:false,visibility:"hidden"},stepNavigation:{type:"sap.ui.vk.StepNavigation",multiple:false,visibility:"hidden"},sceneTree:{type:"sap.ui.vk.SceneTree",multiple:false,visibility:"hidden"},layout:{type:"sap.ui.vk.FlexibleControl",multiple:false,visibility:"hidden"},viewStateManager:{type:"sap.ui.vk.ViewStateManager",multiple:false,visibility:"hidden"},messagePopover:{type:"sap.ui.vk.Notifications",multiple:false,visibility:"hidden"}},events:{contentResourceChangesProcessed:{},sceneLoadingSucceeded:{parameters:{scene:{type:"sap.ui.vk.Scene"}}},sceneLoadingFailed:{parameters:{reason:{type:"object"}}},sceneDestroying:{parameters:{scene:{type:"sap.ui.vk.Scene"},preventGarbageCollection:{type:"function"}}},selectionChanged:{parameters:{selected:{type:"string[]"},unselected:{type:"string[]"}}},fullScreen:{parameters:{isFullScreen:{type:"boolean"}}},urlClicked:{parameters:{nodeId:"string",url:"string"}},nodeClicked:{parameters:{nodeId:"string",x:"int",y:"int"}}}}});
V.prototype.applySettings=function(s){if(s){this._runtimeSettings=s.runtimeSettings;this._webGLContextAttributes=s.webGLContextAttributes;delete s.runtimeSettings;delete s.webGLContextAttributes;}C.prototype.applySettings.apply(this,arguments);this._componentsState={sceneTree:{defaultEnable:this.getEnableSceneTree(),shouldBeEnabled:true,userInteractionShow:this.getShowSceneTree()},stepNavigation:{defaultEnable:this.getEnableStepNavigation(),userInteractionShow:this.getShowStepNavigation()},progressIndicator:{defaultEnable:this.getEnableProgressIndicator()},messagePopover:{defaultEnable:this.getEnableNotifications()}};this.setEnableSceneTree(false);this.setEnableStepNavigation(false);};
V.prototype.init=function(){this._messagePopover=new N();this.setAggregation("messagePopover",this._messagePopover);this._messagePopover.attachAllMessagesCleared(function(){this._messagePopover.setVisible(false);this._updateLayout();},this);this._messagePopover.attachMessageAdded(function(){this._messagePopover.setVisible(true);this._updateLayout();},this);f.debug("sap.ui.vk.Viewer.init() called.");if(C.prototype.init){C.prototype.init.apply(this);}this._scheduleContentResourcesUpdateTimerId=null;this._resizeListenerId=null;this._busyIndicatorCounter=0;this._toolbar=null;this._viewport=null;this._nativeViewport=null;this._redlineDesign=null;this._stepNavigation=null;this._mainScene=null;this._sceneTree=null;this._overlayManager={initialized:false,changed:false,control:null,onNativeViewportMove:function(e){var p=e.getParameter("pan");var z=e.getParameter("zoom");this.control.setPanAndZoom(p.x,p.y,z);},onViewportZoom:function(e){var z=e.getParameter("zoomFactor");this.control.setPanAndZoom(0,0,z);},onViewportPan:function(e){var g=e.getParameter("dx");var h=e.getParameter("dy");this.control.setPanAndZoom(g,h,1);}};this._overlayManager.delegate={onAfterRendering:this._onAfterRenderingOverlay.bind(this,this._viewport,this._nativeViewport,this._overlayManager)};this._updateSizeTimer=0;this._fullScreenToggle=false;this._content=new b(this.getId()+"-splitter",{orientation:"Horizontal"});this._stackedViewport=new F({width:"100%",height:"100%",layout:"Stacked"});this._layout=new F(this.getId()+"-flexibleControl",{width:"100%",height:"100%",layout:"Vertical"});this._stackedViewport.setLayoutData(new c({size:"100%",minSize:160,resizable:true}));this._content.addContentArea(this._stackedViewport);this.setAggregation("layout",this._layout);this.setTooltip(sap.ui.vk.getResourceBundle().getText("VIEWER_TITLE"));if(this.getEnableProgressIndicator()){this._createProgressIndicator();}};
V.prototype.exit=function(){f.debug("sap.ui.vk.Viewer.exit() called.");if(this._scheduleContentResourcesUpdateTimerId){q.sap.clearDelayedCall(this._scheduleContentResourcesUpdateTimerId);this._scheduleContentResourcesUpdateTimerId=null;}if(this._viewport){this._viewport.detachEvent("viewActivated",this._onViewportViewActivated,this);}this._setMainScene(null);this._toolbar=null;this._messagePopover=null;this._sceneTree=null;this._nativeViewport=null;this._stepNavigation=null;this._viewport=null;this._componentsState=null;this._setViewStateManager(null);if(this._graphicsCore){this._graphicsCore.destroy();this._graphicsCore=null;}if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}if(C.prototype.exit){C.prototype.exit.apply(this);}};
V.prototype._setMainScene=function(s,e){if(s){if(s!==this._mainScene){this._mainScene=s;this._showViewport();this._viewport.setScene(this._mainScene);this._setViewStateManager(this._graphicsCore.createViewStateManager(this._mainScene.getDefaultNodeHierarchy(),this.getShouldTrackVisibilityChanges(),e));this._viewport.setViewStateManager(this.getViewStateManager());if(this._componentsState.sceneTree.defaultEnable){this._instantiateSceneTree();this._sceneTree.setScene(this._mainScene,this.getViewStateManager());this.setEnableSceneTree(true);if(this._componentsState.sceneTree.userInteractionShow&&this._componentsState.sceneTree.shouldBeEnabled){this.setShowSceneTree(true);this._sceneTree.setVisible(true);}else{this.setShowSceneTree(false);}}if(this._componentsState.stepNavigation.defaultEnable){this._instantiateStepNavigation();this._stepNavigation.setScene(this._mainScene);this.setEnableStepNavigation(true);if(this._componentsState.stepNavigation.userInteractionShow){this.setShowStepNavigation(true);this._stepNavigation.setVisible(true);}else{this.setShowStepNavigation(false);}}}else{this.getViewStateManager().setCanTrackVisibilityChanges(e);}if(this._sceneTree){this._sceneTree.refresh();}if(this._stepNavigation){this._stepNavigation.refresh(s);}}else{this._mainScene=null;if(this._viewport){this._viewport.setScene(null);}if(this._sceneTree){this._sceneTree.setScene(null,null);}if(this._stepNavigation){this._stepNavigation.setScene(null);}this.setEnableSceneTree(false);this.setEnableStepNavigation(false);this._setViewStateManager(null);}return this;};
V.prototype._destroyMainScene=function(){if(this._mainScene){var s=this._mainScene,p=false;this.fireSceneDestroying({scene:s,preventGarbageCollection:function(e){p=e;}});this._setMainScene(null);this._graphicsCore.destroyScene(s);if(!p){this._graphicsCore.collectGarbage();}}else if(this._nativeViewport){this.fireSceneDestroying({scene:null});}return this;};
V.prototype.getGraphicsCore=function(){if(!this._graphicsCore){q.sap.require("sap.ui.vk.GraphicsCore");this._graphicsCore=new sap.ui.vk.GraphicsCore(this._getRuntimeSettings(),q.extend({antialias:true,alpha:true,premultipliedAlpha:true},this._getWebGLContextAttributes()));if(this._deferredDecryptionHandler){this._graphicsCore.setDecryptionHandler(this._deferredDecryptionHandler);delete this._deferredDecryptionHandler;}}return this._graphicsCore;};
V.prototype.getScene=function(){return this._mainScene;};
V.prototype.getViewStateManager=function(){return this.getAggregation("viewStateManager");};
V.prototype._setViewStateManager=function(v){if(!this._graphicsCore){return this;}if(v===this.getViewStateManager()){return this;}if(this.getViewStateManager()){this._graphicsCore.destroyViewStateManager(this.getViewStateManager());}this.setAggregation("viewStateManager",v,true);return this;};
V.prototype.getViewport=function(){return this._viewport;};
V.prototype.getNativeViewport=function(){return this._nativeViewport;};
V.prototype.getRedlineDesign=function(){return this._redlineDesign;};
V.prototype._getRuntimeSettings=function(){return this._runtimeSettings;};
V.prototype._getWebGLContextAttributes=function(){return this._webGLContextAttributes;};
V.prototype.getOverlay=function(){return this._overlayManager.control;};
V.prototype.setEnableOverlay=function(p){if(p!==this.getProperty("enableOverlay")){this.setProperty("enableOverlay",p);this._overlayManager.changed=true;}return this;};
V.prototype.setEnableSceneTree=function(p){this.setProperty("enableSceneTree",p,true);if(!p){this.setProperty("showSceneTree",false);}this._updateLayout();return this;};
V.prototype.setEnableNotifications=function(p){this.setProperty("enableNotifications",p,true);this._messagePopover.setVisible(false);this._updateLayout();return this;};
V.prototype.setShowSceneTree=function(p){this.setProperty("showSceneTree",p,true);this._updateLayout();return this;};
V.prototype.setEnableStepNavigation=function(p){this.setProperty("enableStepNavigation",p,true);if(!p){this.setProperty("showStepNavigation",false);}this._updateLayout();return this;};
V.prototype.setShowStepNavigation=function(p){this.setProperty("showStepNavigation",p,true);this._updateLayout();return this;};
V.prototype.setEnableToolbar=function(p){this.setProperty("enableToolbar",p,true);this._updateLayout();return this;};
V.prototype.activateFullScreenMode=function(v){var i=function(j){return j.fullScreen||j.webkitIsFullScreen||j.mozFullScreen||j.msFullscreenElement;};this._fullScreenToggle=true;var e=v;var g=false;if(e){if(!i(document)){if(!this._fullScreenHandler){this._fullScreenHandler=function(j){if(!i(document)){document.removeEventListener("fullscreenchange",this._fullScreenHandler.bind(this));document.removeEventListener("mozfullscreenchange",this._fullScreenHandler.bind(this));document.removeEventListener("webkitfullscreenchange",this._fullScreenHandler.bind(this));document.removeEventListener("MSFullscreenChange",this._fullScreenHandler.bind(this));this.removeStyleClass("sapVizKitViewerFullScreen");this._updateSize();this.fireFullScreen({isFullScreen:false});}};document.addEventListener("fullscreenchange",this._fullScreenHandler.bind(this));document.addEventListener("mozfullscreenchange",this._fullScreenHandler.bind(this));document.addEventListener("webkitfullscreenchange",this._fullScreenHandler.bind(this));document.addEventListener("MSFullscreenChange",this._fullScreenHandler.bind(this));}g=true;var h=document.getElementsByTagName("body")[0];if(h.requestFullScreen){h.requestFullScreen();}else if(h.webkitRequestFullScreen){h.webkitRequestFullScreen();}else if(h.mozRequestFullScreen){h.mozRequestFullScreen();}else if(h.msRequestFullscreen){h.msRequestFullscreen();}else{g=false;}if(g){this.addStyleClass("sapVizKitViewerFullScreen");}}}else if(i(document)){g=true;if(document.cancelFullScreen){document.cancelFullScreen();}else if(document.webkitCancelFullScreen){document.webkitCancelFullScreen();}else if(document.mozCancelFullScreen){document.mozCancelFullScreen();}else if(document.msExitFullscreen){document.msExitFullscreen();}else{g=false;}if(g){this.removeStyleClass("sapVizKitViewerFullScreen");}}if(g){this._updateSize();this.fireFullScreen({isFullScreen:e});}return this;};
V.prototype.getShowAllHotspots=function(){return this.getViewport()?this.getViewport().getShowAllHotspots():this.getProperty("showAllHotspots");};
V.prototype.setShowAllHotspots=function(v){this.setProperty("showAllHotspots",v,true);if(this.getViewport()){this.getViewport().setShowAllHotspots(v);}return this;};
V.prototype.getHotspotColorABGR=function(){return this.getViewport()?this.getViewport().getHotspotColorABGR():this.getProperty("hotspotColorABGR");};
V.prototype.setHotspotColorABGR=function(v){this.setProperty("hotspotColorABGR",v,true);this.setProperty("hotspotColor",sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(v)),true);if(this.getViewport()){this.getViewport().setHotspotColorABGR(v);}return this;};
V.prototype.getHotspotColor=function(){return this.getViewport()?this.getViewport().getHotspotColor():this.getProperty("hotspotColor");};
V.prototype.setHotspotColor=function(v){this.setProperty("hotspotColor",v,true);this.setProperty("hotspotColorABGR",sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(v)),true);if(this.getViewport()){this.getViewport().setHotspotColor(v);}return this;};
V.prototype.setRuntimeSettings=function(s){f.error(sap.ui.vk.getResourceBundle().getText(M.VIT29.summary),M.VIT29.code,"sap.ui.vk.Viewer");};
V.prototype.setWebGLContextAttributes=function(o){f.error(sap.ui.vk.getResourceBundle().getText(M.VIT30.summary),M.VIT30.code,"sap.ui.vk.Viewer");};
V.prototype.invalidate=function(o){if(o instanceof a){this._scheduleContentResourcesUpdate();return;}C.prototype.invalidate.apply(this,arguments);};
V.prototype._queueContentResourcesUpdateIfNeeded=function(e){if(e==="contentResources"){this._scheduleContentResourcesUpdate();return true;}};
V.prototype.addAggregation=function(e,o,s){if(this._queueContentResourcesUpdateIfNeeded(e)){s=true;}return C.prototype.addAggregation.call(this,e,o,s);};
V.prototype.insertAggregation=function(e,o,i,s){if(this._queueContentResourcesUpdateIfNeeded(e)){s=true;}return C.prototype.insertAggregation.call(this,e,o,i,s);};
V.prototype.removeAggregation=function(e,o,s){if(e==="contentResources"){var r=C.prototype.removeAggregation.call(this,e,o,true);if(r){this._scheduleContentResourcesUpdate();}return r;}else{return C.prototype.removeAggregation.call(this,e,o,s);}};
V.prototype.removeAllAggregation=function(e,s){if(this._queueContentResourcesUpdateIfNeeded(e)){s=true;}return C.prototype.removeAllAggregation.call(this,e,s);};
V.prototype.destroyAggregation=function(e,s){if(this._queueContentResourcesUpdateIfNeeded(e)){s=true;}return C.prototype.destroyAggregation.call(this,e,s);};
V.prototype._scheduleContentResourcesUpdate=function(){if(!this._scheduleContentResourcesUpdateTimerId){this._scheduleContentResourcesUpdateTimerId=q.sap.delayedCall(0,this,function(){this._scheduleContentResourcesUpdateTimerId=null;var t=this;function g(k){t.setBusy(true);var m=t.getGraphicsCore();var o;if(t._componentsState.progressIndicator.defaultEnable){t._progressIndicator.reset();t._progressIndicator.setNumberOfFiles(k.length);t._progressIndicator.setVisible(true);m._dvl.Client.NotifyFileLoadProgress=function(e,p){t._progressIndicator.updateRenderStatus(p);return 1;};o=function(e){var p=e.getParameter("source");var r=e.getParameter("loaded");var s=e.getParameter("total");t._progressIndicator.updateDownloadStatus(p,r,s);};}m.loadContentResourcesAsync(k,function(s){t._progressIndicator.updateRenderStatus(0);q.sap.delayedCall(100,this,function(){try{if(s){if(t.getEnableNotifications()===false){t._destroyMainScene();t._showNativeViewport();var p=sap.ui.vk.getResourceBundle().getText("VIEWPORT_MESSAGEERRORLOADINGFILE");t._nativeViewport.loadFailed(p);}f.error(sap.ui.vk.getResourceBundle().getText(M.VIT13.summary),M.VIT13.code,"sap.ui.vk.Viewer");t.fireSceneLoadingFailed({reason:{sourcesFailedToDownload:s}});}else{var r;var u=m.updateSceneTree(t.getScene(),k,function(x){r=x;});if(u!==t._mainScene){t._destroyMainScene();}var v=false;if(t.getShouldTrackVisibilityChanges()){v=!k.some(function(x){var y=x.getSourceProperties().version;return y&&y.major<4;});}if(t.getRedlineDesign()){t.getRedlineDesign().updatePanningRatio();}t._setMainScene(u,v);if(t.getEnableOverlay()&&t.getViewport()._is2D){t._overlayManager.changed=true;t._showOverlay();}if(u){t.fireSceneLoadingSucceeded({scene:u});}else{t.fireSceneLoadingFailed({reason:r});}}}catch(e){var w=sap.ui.vk.getResourceBundle().getText(M.VIT14.summary);if(e instanceof D){w+="\ncode: "+e.code+", message: "+e.message;}else if(e instanceof Error){w+="\nmessage: "+e.message;}else{w+="\n"+e.toString();}f.error(w,M.VIT14.code,"sap.ui.vk.Viewer");t._destroyMainScene();t.fireSceneLoadingFailed({reason:{error:e,errorMessage:w}});}finally{t.fireContentResourceChangesProcessed();t.setBusy(false);t._progressIndicator.setVisible(false);}});},o);}function h(k){function o(){if(t.getEnableOverlay()){t._overlayManager.changed=true;t._showOverlay();}t.fireSceneLoadingSucceeded({scene:null});t.fireContentResourceChangesProcessed();}function e(){t.fireSceneLoadingFailed();t.fireContentResourceChangesProcessed();if(t.getEnableNotifications()===false){var p=sap.ui.vk.getResourceBundle().getText("VIEWPORT_MESSAGEERRORLOADINGFILE");t._nativeViewport.loadFailed(p);}}t._destroyMainScene();if(k.length===1){t._showNativeViewport();var r=k[0];var s=r.getSource();if(s instanceof File){var m=new FileReader();m.onload=function(p){t._nativeViewport.loadUrl(m.result,o,e,null,r.getSourceType());};m.readAsDataURL(s);}else{t._nativeViewport.loadUrl(s,o,e,null,r.getSourceType());}}else{f.error(sap.ui.vk.getResourceBundle().getText(M.VIT15.summary),M.VIT15.code,"sap.ui.vk.Viewer");t.fireContentResourceChangesProcessed();}}var n=true;var i;var j;var k=this.getContentResources();if(k.length>0){j=a.collectCategories(k);if(j.length===0){if(this._viewport&&this._viewport.getVisible()){i=sap.ui.vk.ContentResourceSourceCategory["3D"];n=false;}else if(this._nativeViewport&&this._nativeViewport.getVisible()){i=sap.ui.vk.ContentResourceSourceCategory["2D"];n=false;}}else if(j.length===1){i=j[0];if(i==="unknown"){f.error(sap.ui.vk.getResourceBundle().getText(M.VIT16.summary),M.VIT16.code,"sap.ui.vk.Viewer");if(this._nativeViewport==null){this._showNativeViewport();}if(this.getEnableNotifications()===false){this._nativeViewport.loadFailed();}this._showNativeViewport(false);}else{n=false;}}else if(j.length>1){f.error(sap.ui.vk.getResourceBundle().getText(M.VIT17.summary),M.VIT17.code,"sap.ui.vk.Viewer");}}if(n){this._destroyMainScene();this.fireContentResourceChangesProcessed();return;}if(i===sap.ui.vk.ContentResourceSourceCategory["3D"]){g(k);}else if(i===sap.ui.vk.ContentResourceSourceCategory["2D"]){h(k);}});}return this;};
V.prototype.onBeforeRendering=function(){if(this._fullScreenToggle){this._fullScreenToggle=false;}else{this._showToolbar();}this._showOverlay();if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}};
V.prototype.onAfterRendering=function(){var e=this.getDomRef();this._resizeListenerId=R.register(this,this._handleResize.bind(this));this._handleResize({size:{width:e.clientWidth,height:e.clientHeight}});};
V.prototype._handleResize=function(e){this._updateSize();if(this.getRedlineDesign()){var x=this.getRedlineDesign().exportJSON();this.getRedlineDesign().removeAllRedlineElements();q.sap.delayedCall(200,this,function(){var v;if(this.getViewport()&&this.getViewport().getVisible()){v=this.getViewport().getOutputSize();}else if(this.getNativeViewport()&&this.getNativeViewport().getVisible()){v=this.getNativeViewport().getOutputSize();}this.getRedlineDesign().setProperty("virtualLeft",v.left,true);this.getRedlineDesign().setProperty("virtualTop",v.top,true);this.getRedlineDesign().setProperty("virtualSideLength",v.sideLength,true);this.getRedlineDesign().invalidate();this.getRedlineDesign().importJSON(x);});}};
V.prototype._updateSize=function(){if(this._updateSizeTimer){clearTimeout(this._updateSizeTimer);}this._updateSizeTimer=setTimeout(this._doUpdateSize.bind(this),100);};
V.prototype._doUpdateSize=function(){var e=this.getId()+"-flexibleControl";var g=document.getElementById(e);if(!g){return;}g.style.width="100%";g.style.height="100%";var h=g.clientHeight;var s=[];for(var i=0;i<4;i++){s[i]=document.getElementById(e+"Content_"+i);}h-=s[0].clientHeight;for(var j=2;j<4;j++){if(s[j]!=null&&s[j].style.visibility!="hidden"){h-=s[j].clientHeight;}}if(s[1]){s[1].style.height=h+"px";}if(this._stackedViewport){this._stackedViewport.setLayoutData(new c({minSize:160,resizable:true}));}};
V.prototype.isTreeBinding=function(n){return n==="contentResources";};
V.prototype.setBusy=function(e){if(e){if(this._busyIndicatorCounter===0){this.setBusyIndicatorDelay(0);C.prototype.setBusy.call(this,true);}this._busyIndicatorCounter+=1;}else{this._busyIndicatorCounter-=1;if(this._busyIndicatorCounter==0){C.prototype.setBusy.call(this,false);}}};
V.prototype._showToolbar=function(){if(!this._toolbar){this._toolbar=new sap.ui.vk.Toolbar({title:this.getToolbarTitle()});this._toolbar.setViewer(this);this.setAggregation("toolbar",this._toolbar);}this._toolbar.setVisible(this.getEnableToolbar());this._updateLayout();return this;};
V.prototype._createProgressIndicator=function(){if(!this._progressIndicator){this._progressIndicator=new P({visible:false});this.setAggregation("progressIndicator",this._progressIndicator);}else{this._progressIndicator.reset();}};
V.prototype._updateLayout=function(){this._layout.setWidth(this.getWidth());this._layout.removeAllContent();this._layout.setHeight(this.getHeight());var h=this.getHeight();var e=[0,0,0];if(h=="auto"){h=400;}else if(h.substr(h.length-1)=="%"){h=400;}else{h=parseInt(h,10);}if(this._toolbar!=null&&this.getEnableToolbar()){e[0]=48;}if(this._stepNavigation!=null&&this.getShowStepNavigation()){e[2]=150;}e[1]=h-e[0]-e[2];if(this._toolbar!=null&&this.getEnableToolbar()){this._toolbar.setVisible(true);this._toolbar.setLayoutData(new d({size:e[0]+"px"}));this._layout.insertContent(this._toolbar,0);}else if(this._toolbar!=null){this._toolbar.setVisible(false);}if(this._sceneTree!=null&&this.getShowSceneTree()&&this.getEnableSceneTree()){this._sceneTree.setVisible(true);this._sceneTree.setLayoutData(new c({size:"320px",minSize:200,resizable:true}));this._content.insertContentArea(this._sceneTree,0);}else if(this._sceneTree!=null){this._content.removeContentArea(this._sceneTree);this._sceneTree.setVisible(false);}this._content.setLayoutData(new d({size:e[1]+"px"}));this._layout.addContent(this._content);if(this._messagePopover!=null){e[1]-=e[0];}if(this._stepNavigation!=null&&this.getShowStepNavigation()&&this.getEnableStepNavigation()){if(this._graphicsCore!=null&&!this._stepNavigation.hasGraphicsCore()){this._stepNavigation.setGraphicsCore(this._graphicsCore);}this._stepNavigation.setLayoutData(new d({size:e[2]+"px"}));this._layout.addContent(this._stepNavigation);}if(this._messagePopover!==null&&this._messagePopover.getAggregation("_messagePopover").getItems().length>0&&this.getEnableNotifications()){this._messagePopover.setVisible(true);this._messagePopover.setLayoutData(new d({size:e[0]+"px"}));this._layout.addContent(this._messagePopover);}else{this._content.removeContentArea(this._messagePopover);this._messagePopover.setVisible(false);}if(this._toolbar){this._toolbar.refresh();}this._updateSize();};
V.prototype._instantiateSceneTree=function(){if(!this._sceneTree){this._sceneTree=new sap.ui.vk.SceneTree();this.setAggregation("sceneTree",this._sceneTree);}return this;};
V.prototype._instantiateStepNavigation=function(){if(!this._stepNavigation){this._stepNavigation=new sap.ui.vk.StepNavigation(this.getId()+"-stepNavigation",{showThumbnails:this.getShowStepNavigationThumbnails()});this.setAggregation("stepNavigation",this._stepNavigation);}return this;};
V.prototype._showViewport=function(){if(!this._viewport){this._viewport=new sap.ui.vk.Viewport(this.getId()+"-viewport",{showAllHotspots:this.getShowAllHotspots(),hotspotColor:this.getHotspotColor(),hotspotColorABGR:this.getHotspotColorABGR()});this.setAggregation("viewport",this._viewport);this._viewport.attachEvent("viewActivated",this._onViewportViewActivated,this);this._viewport.setGraphicsCore(this.getGraphicsCore());}if(this._nativeViewport){this._nativeViewport.setVisible(false);}this._stackedViewport.removeAllContent();this._stackedViewport.addContent(this._viewport);this._viewport.setVisible(true);return this;};
V.prototype._showNativeViewport=function(){if(!this._nativeViewport){this._nativeViewport=new sap.ui.vk.NativeViewport(this.getId()+"-nativeViewport",{limitZoomOut:true});this.setAggregation("nativeViewport",this._nativeViewport);}if(this._viewport){this._viewport.setVisible(false);}this._stackedViewport.removeAllContent();this._stackedViewport.addContent(this._nativeViewport);this._nativeViewport.setVisible(true);return this;};
V.prototype._showOverlay=function(){var o=this._overlayManager;if(o.changed){var O;if(this.getEnableOverlay()){if(!o.initialized){if(!(O=this.getAggregation("overlay"))){O=new sap.ui.vk.Overlay();}O.setZoomOnResize(false);o.control=O;o.initialized=true;}else{O=o.control;O.reset();}if(this._nativeViewport&&this._nativeViewport.getVisible()){O.setTarget(this._nativeViewport);o.savedLimitZoomOutState=this._nativeViewport.getLimitZoomOut();this._nativeViewport.setLimitZoomOut(true);this._nativeViewport.attachEvent("move",o.onNativeViewportMove,o);}else if(this._viewport&&this._viewport.getVisible()){O.setTarget(this._viewport);o.savedLimitZoomOutState=false;this._viewport.attachEvent("zoom",o.onViewportZoom,o);this._viewport.attachEvent("pan",o.onViewportPan,o);}this._stackedViewport.addContent(O);this._stackedViewport.addDelegate(o.delegate);}else{this._nativeViewport.detachEvent("move",o.onNativeViewportMove,o);this._stackedViewport.removeDelegate(o.delegate);this._stackedViewport.removeContent(o.control);this._nativeViewport.setLimitZoomOut(o.savedLimitZoomOutState);}o.changed=false;}};
V.prototype._onAfterRenderingOverlay=function(e){var o=this._overlayManager.control.getDomRef();if(o&&(this._nativeViewport||this._viewport)){var v=this._nativeViewport&&this._nativeViewport.getVisible()?this._nativeViewport.getDomRef():this._viewport.getDomRef();if(o.parentNode!==v){o.parentNode.style.display="none";}v.appendChild(o);o.style.width="100%";o.style.height="100%";}};
V.prototype.setDecryptionHandler=function(h){if(this._graphicsCore){this._graphicsCore.setDecryptionHandler(h);}else{this._deferredDecryptionHandler=h;}return this;};
V.prototype.getDecryptionHandler=function(){return this._graphicsCore?this._graphicsCore.getDecryptionHandler():this._deferredDecryptionHandler;};
V.prototype._instantiateRedlineDesign=function(r){if((this.getViewport()&&this.getViewport().getVisible())||(this.getNativeViewport()&&this.getNativeViewport().getVisible())){q.sap.require("sap.ui.vk.RedlineDesign");var e=this.getViewport()&&this.getViewport().getVisible()?this.getViewport():this.getNativeViewport();var v=e.getOutputSize();this._redlineDesign=new sap.ui.vk.RedlineDesign({visible:false,virtualTop:v.top,virtualLeft:v.left,virtualSideLength:v.sideLength,redlineElements:r});}return this;};
V.prototype.activateRedlineDesign=function(r){r=r||[];this._instantiateRedlineDesign(r);this.getRedlineDesign().placeAt(this._stackedViewport);this.getRedlineDesign().setVisible(true);var o=function(i){var j=i.getParameter("deltaX"),k=i.getParameter("deltaY");this.getViewport().queueCommand(function(j,k){this.getViewport().pan(j,k);this.getViewport().endGesture();}.bind(this,j,k));};var e=function(i){var j=i.getParameter("originX"),k=i.getParameter("originY"),z=i.getParameter("zoomFactor");this.getViewport().queueCommand(function(j,k,z){this.getViewport().beginGesture(j,k);this.getViewport().zoom(z);this.getViewport().endGesture();}.bind(this,j,k,z));};var g=function(i){var j=i.getParameter("deltaX"),k=i.getParameter("deltaY");this.getNativeViewport().queueCommand(function(){this.getNativeViewport().pan(j,k);this.getNativeViewport().endGesture();}.bind(this));};var h=function(i){var j=i.getParameter("originX"),k=i.getParameter("originY"),z=i.getParameter("zoomFactor");this.getNativeViewport().queueCommand(function(j,k,z){this.getNativeViewport().beginGesture(j,k);this.getNativeViewport().zoom(z);this.getNativeViewport().endGesture();}.bind(this,j,k,z));};if(this.getNativeViewport()&&this.getNativeViewport().getVisible()){this.getRedlineDesign().attachEvent("pan",g.bind(this));this.getRedlineDesign().attachEvent("zoom",h.bind(this));}else if(this.getViewport()&&this.getViewport().getVisible()){this.getRedlineDesign().attachEvent("pan",o.bind(this));this.getRedlineDesign().attachEvent("zoom",e.bind(this));}return this;};
V.prototype.destroyRedlineDesign=function(){if(this.getRedlineDesign()){this.getRedlineDesign().destroy();this._redlineDesign=null;}return this;};
V.prototype._onViewportViewActivated=function(e){this._componentsState.sceneTree.shouldBeEnabled=e.getParameter("type")==="3D";};
return V;});
sap.ui.predefine('sap/ui/vk/library',["jquery.sap.global","./TransformationMatrix","./DvlException"],function(q,T,D){"use strict";sap.ui.getCore().initLibrary({name:"sap.ui.vk",dependencies:["sap.ui.core"],types:["sap.ui.vk.CameraFOVBindingType","sap.ui.vk.CameraProjectionType","sap.ui.vk.ContentResourceSourceCategory","sap.ui.vk.GraphicsCoreApi","sap.ui.vk.TransformationMatrix","sap.ui.vk.VisibilityMode"],interfaces:[],controls:["sap.ui.vk.ContainerBase","sap.ui.vk.ContainerContent","sap.ui.vk.DockContainer","sap.ui.vk.DockManager","sap.ui.vk.DockPane","sap.ui.vk.LegendItem","sap.ui.vk.ListPanel","sap.ui.vk.ListPanelStack","sap.ui.vk.MapContainer","sap.ui.vk.NativeViewport","sap.ui.vk.Overlay","sap.ui.vk.SceneTree","sap.ui.vk.StepNavigation","sap.ui.vk.Toolbar","sap.ui.vk.Viewer","sap.ui.vk.Viewport"],elements:["sap.ui.vk.OverlayArea"],noLibraryCSS:false,version:"1.48.2"});sap.ui.vk.GraphicsCoreApi={LegacyDvl:"LegacyDvl"};sap.ui.vk.ContentResourceSourceCategory={"3D":"3D","2D":"2D"};sap.ui.vk.CameraProjectionType={Perspective:"perspective",Orthographic:"orthographic"};sap.ui.vk.CameraFOVBindingType={Minimum:"minimum",Maximum:"maximum",Horizontal:"horizontal",Vertical:"vertical"};sap.ui.vk.VisibilityMode={Complete:"complete",Differences:"differences"};sap.ui.vk.ZoomTo={All:"all",Visible:"visible",Selected:"selected",Node:"node",NodeSetIsolation:"node_setisolation",Restore:"restore",RestoreRemoveIsolation:"restore_removeisolation",ViewLeft:"view_left",ViewRight:"view_right",ViewTop:"view_top",ViewBottom:"view_bottom",ViewBack:"view_back",ViewFront:"view_front"};sap.ui.vk.ContentResourceSourceTypeToCategoryMap={"vds":sap.ui.vk.ContentResourceSourceCategory["3D"],"vdsl":sap.ui.vk.ContentResourceSourceCategory["3D"],"cgm":sap.ui.vk.ContentResourceSourceCategory["3D"],"png":sap.ui.vk.ContentResourceSourceCategory["2D"],"jpg":sap.ui.vk.ContentResourceSourceCategory["2D"],"gif":sap.ui.vk.ContentResourceSourceCategory["2D"],"bmp":sap.ui.vk.ContentResourceSourceCategory["2D"],"tiff":sap.ui.vk.ContentResourceSourceCategory["2D"],"tif":sap.ui.vk.ContentResourceSourceCategory["2D"],"svg":sap.ui.vk.ContentResourceSourceCategory["2D"]};var d="sap.ve.dvl";sap.ui.vk.dvl={checkResult:function(r){if(r<0){var m=sap.ve.dvl.DVLRESULT.getDescription?sap.ve.dvl.DVLRESULT.getDescription(r):"";q.sap.log.error(m,JSON.stringify({errorCode:r}),d);throw new D(r,m);}return r;},getPointer:function(p){if(q.type(p)==="number"){var r=p;var m=sap.ve.dvl.DVLRESULT.getDescription?sap.ve.dvl.DVLRESULT.getDescription(r):"";q.sap.log.error(m,JSON.stringify({errorCode:r}),d);throw new D(r,m);}return p;},getJSONObject:function(o){if(q.type(o)==="number"){var r=o;var m=sap.ve.dvl.DVLRESULT.getDescription?sap.ve.dvl.DVLRESULT.getDescription(r):"";q.sap.log.error(m,JSON.stringify({errorCode:r}),d);throw new D(r,m);}return o;}};
sap.ui.vk.getResourceBundle=function(){var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.vk.i18n");sap.ui.vk.getResourceBundle=function(){return r;};return r;};
sap.ui.vk.utf8ArrayBufferToString=function(a){return decodeURIComponent(escape(String.fromCharCode.apply(null,new Uint8Array(a))));};
sap.ui.vk.Redline={ElementType:{Rectangle:"rectangle",Ellipse:"ellipse",Freehand:"freehand"},svgNamespace:"http://www.w3.org/2000/svg"};sap.ui.vk.cssColorToColor=(function(){var i=false;var a=document.createElement("div");a.id="sap.ui.vk.colorConverter";a.style.setProperty("display","none","important");return function(c){if(!i){if(document.body){document.body.appendChild(a);i=true;}else{return{red:0,green:0,blue:0,alpha:1};}}a.style.setProperty("color","rgba(0, 0, 0, 0)","important");a.style.setProperty("color",c,"important");var e=window.getComputedStyle(a).color;if(e==="transparent"){return{red:0,green:0,blue:0,alpha:0};}else{var b=e.split("(")[1].split(")")[0].split(",");return{red:parseInt(b[0],10),green:parseInt(b[1],10),blue:parseInt(b[2],10),alpha:b.length===4?parseFloat(b[3]):1};}};})();
sap.ui.vk.colorToCSSColor=function(c){return"rgba("+c.red+","+c.green+","+c.blue+","+c.alpha+")";};
sap.ui.vk.abgrToColor=function(a){return{red:a&0xff,green:a>>>8&0xff,blue:a>>>16&0xff,alpha:(a>>>24&0xff)/255};};
sap.ui.vk.colorToABGR=function(c){return(c.alpha*255<<24|c.blue<<16|c.green<<8|c.red)>>>0;};
return sap.ui.vk;});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine('sap/ui/vk/BaseNodeProxy',["jquery.sap.global","./library","sap/ui/base/Object"],function(q,l,B){"use strict";var g=sap.ui.vk.dvl.getJSONObject;
var a=B.extend("sap.ui.vk.BaseNodeProxy",{
metadata:{publicMethods:["getNodeId","getName","getNodeMetadata","getHasChildren"]},
constructor:function(n,b){this.init(n,b);}
});
a.prototype.init=function(n,b){this._dvl=n?n.getGraphicsCore()._getDvl():null;this._dvlSceneId=n?n._getDvlSceneId():null;this._dvlNodeId=b;};
a.prototype.reset=function(){this._dvlNodeId=null;this._dvlSceneId=null;this._dvl=null;};
a.prototype.getNodeId=function(){return this._dvlNodeId;};
a.prototype.getName=function(){return g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,this._dvlNodeId,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_NAME)).NodeName;};
a.prototype.getNodeMetadata=function(){return g(this._dvl.Scene.RetrieveMetadata(this._dvlSceneId,this._dvlNodeId)).metadata;};
a.prototype.getHasChildren=function(){return(g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,this._dvlNodeId,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS)).Flags&(sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_MAPPED_HASCHILDREN|sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_CLOSED))===sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_MAPPED_HASCHILDREN;};
return a;});
sap.ui.predefine('sap/ui/vk/CheckEye',["jquery.sap.global","sap/ui/commons/CheckBox","./library"],function(q,C,l){"use strict";
var a=C.extend("sap.ui.vk.CheckEye",{
metadata:{library:"sap.ui.vk",properties:{}},
onAfterRendering:function(){var $=this.$();$.removeClass("sapUiCb");$.removeClass("sapUiCbChk");$.removeClass("sapUiCbInteractive");$.removeClass("sapUiCbStd");$.addClass("sapUiCheckEye");},
renderer:{}
});
return a;},true);
sap.ui.predefine('sap/ui/vk/ContentResource',["jquery.sap.global","./library","sap/ui/base/ManagedObject"],function(q,l,M){"use strict";
var C=M.extend("sap.ui.vk.ContentResource",{
metadata:{properties:{source:"any",sourceType:"string",sourceId:"string",localMatrix:"sap.ui.vk.TransformationMatrix",name:"string",password:"string"},aggregations:{contentResources:"sap.ui.vk.ContentResource"},publicMethods:["getNodeProxy","getSourceProperties"]},
constructor:function(i,s,S){M.apply(this,arguments);this._nodeProxy=null;}
});
C.prototype.isTreeBinding=function(n){return n==="contentResources";};
C.prototype.destroy=function(){this._nodeProxy=null;M.prototype.destroy.call(this);};
C.prototype.setLocalMatrix=function(v){var n=this.getNodeProxy();if(n){n.setLocalMatrix(v);}this.setProperty("localMatrix",v,true);return this;};
C.prototype.getSourceProperties=function(){return this._shadowContentResource&&this._shadowContentResource.sourceProperties||{};};
C.prototype.getNodeProxy=function(){return this._shadowContentResource&&this._shadowContentResource.nodeProxy||null;};
C.collectCategories=function(r){var c=[];var m={};function g(a){var s=(a.getSourceType()||"").toLowerCase();if(s){var b=sap.ui.vk.ContentResourceSourceTypeToCategoryMap[s]||"unknown";if(!m.hasOwnProperty(b)){m[b]=true;c.push(b);}}a.getContentResources().forEach(g);}r.forEach(g);return c;};
return C;});
sap.ui.predefine('sap/ui/vk/DockManagerRenderer',["jquery.sap.global"],function(q){"use strict";var D={};
D.render=function(r,c){var a=r;a.write("<div");a.writeControlData(c);a.writeClasses();if(c.getWidth()&&c.getWidth()!=""){a.addStyle("width",c.getWidth());}if(c.getHeight()&&c.getHeight()!=""){a.addStyle("height",c.getHeight());}a.writeStyles();a.write(">");a.write("</div>");};
return D;},true);
sap.ui.predefine('sap/ui/vk/DownloadManager',["jquery.sap.global","./library","sap/ui/base/EventProvider","./Messages"],function(q,l,E,M){"use strict";
var D=E.extend("sap.ui.vk.DownloadManager",{
metadata:{publicMethods:["start","attachItemSucceeded","detachItemSucceeded","attachItemFailed","detachItemFailed","attachAllItemsCompleted","detachAllItemsCompleted"],events:{itemSucceeded:{parameters:{source:{type:"any"},response:{type:"object"}}},itemProgress:{parameters:{source:{type:"any"},loaded:{type:"int"},total:{type:"int"}}},itemFailed:{parameters:{source:{type:"any"},status:{type:"any"},statusText:{type:"string"}}},allItemsCompleted:{}}},
constructor:function(s,m){E.apply(this);this._maxParallelTasks=m||5;this._sourcesToProcess=s.slice();this._sourcesBeingProcessed=[];}
});
D.prototype.start=function(){while(this._pickAndDispatchTask()){}return this;};
D.prototype.queue=function(s){this._sourcesToProcess.push(s);this._pickAndDispatchTask();return this;};
D.prototype._pickAndDispatchTask=function(){if(this._sourcesToProcess.length>0&&this._sourcesBeingProcessed.length<this._maxParallelTasks){var s=this._sourcesToProcess.shift();this._sourcesBeingProcessed.push(s);this._runTask(s);return true;}return false;};
D.prototype._taskFinished=function(s){var i=this._sourcesBeingProcessed.indexOf(s);if(i>=0){this._sourcesBeingProcessed.splice(i,1);}return this;};
D.prototype._queueIsEmpty=function(){return this._sourcesToProcess.length===0&&this._sourcesBeingProcessed.length===0;};
D.prototype._runTask=function(s){var t=this;if(typeof s==="string"){var x=new(typeof sinon==="object"&&sinon.xhr&&sinon.xhr.XMLHttpRequest||XMLHttpRequest);x.onerror=function(e){t._taskFinished(s);t._pickAndDispatchTask();t.fireItemFailed({source:s,status:x.status,statusText:x.statusText});if(t._queueIsEmpty()){t._asyncFireAllItemsCompleted();}};x.onload=function(e){t._taskFinished(s);t._pickAndDispatchTask();if(x.status===200||x.status===0){t.fireItemSucceeded({source:s,response:x.response});}else{t.fireItemFailed({source:s,status:x.status,statusText:x.statusText});}if(t._queueIsEmpty()){t._asyncFireAllItemsCompleted();}};x.onprogress=function(e){t.fireItemProgress({source:s,loaded:e.loaded,total:e.total});};x.open("GET",s,true);x.responseType="arraybuffer";x.send(null);}else if(s instanceof File){var f=new FileReader();f.onload=function(e){t._taskFinished(s);t._pickAndDispatchTask();t.fireItemSucceeded({source:s,response:f.result});if(t._queueIsEmpty()){t._asyncFireAllItemsCompleted();}};f.onerror=function(e){t._taskFinished(s);t._pickAndDispatchTask();t.fireItemFailed({source:s,status:f.error.name,statusText:f.error.message});if(t._queueIsEmpty()){t._asyncFireAllItemsCompleted();}};f.onprogress=function(e){t.fireItemProgress({source:s.name,loaded:e.loaded,total:e.total});};f.readAsArrayBuffer(s);}else{q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT5.summary),M.VIT5.code,"sap.ui.vk.DownloadManager");}return this;};
D.prototype._asyncFireAllItemsCompleted=function(){q.sap.delayedCall(0,this,this.fireAllItemsCompleted);};
D.prototype.attachItemSucceeded=function(d,f,a){return this.attachEvent("itemSucceeded",d,f,a);};
D.prototype.detachItemSucceeded=function(f,a){return this.detachEvent("itemSucceeded",f,a);};
D.prototype.fireItemSucceeded=function(p,a,e){return this.fireEvent("itemSucceeded",p,a,e);};
D.prototype.attachItemFailed=function(d,f,a){return this.attachEvent("itemFailed",d,f,a);};
D.prototype.detachItemFailed=function(f,a){return this.detachEvent("itemFailed",f,a);};
D.prototype.fireItemFailed=function(p,a,e){return this.fireEvent("itemFailed",p,a,e);};
D.prototype.attachAllItemsCompleted=function(d,f,a){return this.attachEvent("allItemsCompleted",d,f,a);};
D.prototype.detachAllItemsCompleted=function(f,a){return this.detachEvent("allItemsCompleted",f,a);};
D.prototype.fireAllItemsCompleted=function(p,a,e){return this.fireEvent("allItemsCompleted",p,a,e);};
D.prototype.attachItemProgress=function(d,f,a){return this.attachEvent("itemProgress",d,f,a);};
D.prototype.detachItemProgress=function(f,a){return this.detachEvent("itemProgress",f,a);};
D.prototype.fireItemProgress=function(p,a,e){return this.fireEvent("itemProgress",p,a,e);};
return D;});
sap.ui.predefine('sap/ui/vk/DvlException',["jquery.sap.global","sap/ui/base/Exception"],function(q,E){"use strict";var D=function(c,m){this.name="DvlException";this.code=c;this.message=m;};D.prototype=q.sap.newObject(E.prototype);return D;});
sap.ui.predefine('sap/ui/vk/FlexibleControl',["jquery.sap.global","sap/ui/core/Control","sap/ui/core/EnabledPropagator","./library"],function(q,C,E,l){"use strict";
var F=C.extend("sap.ui.vk.FlexibleControl",{metadata:{library:"sap.ui.vk",properties:{width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},layout:{type:"string",group:"Behavior",defaultValue:"Stacked"},enabled:{type:"boolean",group:"Behavior",defaultValue:true}},defaultAggregation:"content",aggregations:{content:{type:"sap.ui.core.Control",multiple:true,singularName:"content"}},designTime:true}});
E.call(F.prototype);return F;},true);
sap.ui.predefine('sap/ui/vk/FlexibleControlLayoutData',["jquery.sap.global","sap/ui/core/LayoutData","./library"],function(q,L,l){"use strict";
var F=L.extend("sap.ui.vk.FlexibleControlLayoutData",{metadata:{library:"sap.ui.vk",properties:{size:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"auto"},minSize:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"0px"},marginTop:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"0px"},marginBottom:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"0px"}}}});
return F;},true);
sap.ui.predefine('sap/ui/vk/FlexibleControlRenderer',["jquery.sap.global"],function(q){"use strict";var F={};
F.render=function(r,f){var a=r;a.write("<div");a.writeControlData(f);a.addClass("sapUiFlexControl");if(f.getWidth()&&f.getWidth()!=""){a.addStyle("width",f.getWidth());}if(f.getHeight()&&f.getHeight()!=""){a.addStyle("height",f.getHeight());}a.writeStyles();a.writeClasses();a.write(">");var c=f.getContent();var l=f.getLayout();var b="sapUiFlexCellStacked";if(l=="Vertical"){b="sapUiFlexCellVertical";}for(var i=0;i<c.length;i++){var d=c[i];a.write("<div id=\""+f.getId()+"Content_"+i+"\" class=\""+b+"\"");var e=d.getLayoutData();if(e&&l!="Stacked"){a.write(" style=\"");if(e.getSize()&&e.getSize()!=""){a.write("height: "+e.getSize()+";");}if(e.getMinSize()&&e.getMinSize()!=""){a.write("min-height: "+e.getMinSize()+";");}if(e.getMarginTop()&&e.getMarginTop()!=""){a.write("margin-top: "+e.getMarginTop()+";");}if(e.getMarginBottom()&&e.getMarginBottom()!=""){a.write("margin-bottom: "+e.getMarginBottom()+";");}a.write("\"");}a.write(">");a.renderControl(d);a.write("</div>");}a.write("</div>");};
return F;},true);
sap.ui.predefine('sap/ui/vk/GraphicsCore',["jquery.sap.global","./library","sap/ui/base/EventProvider","./ve/thirdparty/html2canvas","./ve/dvl","./Scene","./NodeHierarchy","./ContentResource","./DownloadManager","./ViewStateManager","./DvlException","./Messages"],function(q,l,E,H,D,S,N,C,a,V,b,M){"use strict";var c=q.sap.log;
function g(s){return s instanceof File?"local":"remote";}
function d(s){return s instanceof File?s.name:s;}
var e=function(s){Object.defineProperties(this,{source:{value:s,writable:false,enumerable:true},_refCount:{value:0,writable:true,enumerable:false}});};
e.prototype.isInUse=function(){return this._refCount>0;};
e.prototype.addRef=function(){++this._refCount;return this;};
e.prototype.release=function(){--this._refCount;return this;};
e.prototype.destroy=function(){};
var f=function(s,v,i){e.call(this,s);Object.defineProperties(this,{content:{value:i,writable:false,enumerable:true},vdsSourceDatum:{value:v,writable:false,enumerable:true}});};f.prototype=Object.create(e.prototype);f.prototype.constructor=f;
f.prototype.destroy=function(){if(this.vdsSourceDatum){this.vdsSourceDatum.release();}e.prototype.destroy.call(this);};
var h=function(i,s,r){Object.defineProperties(this,{dvlSceneId:{value:i,writable:false,enumerable:true},sourceDatum:{value:s,writable:false,enumerable:true},root:{value:!!r,writable:false,enumerable:true},_refCount:{value:0,writable:true,enumerable:false}});};
h.prototype.isInUse=function(){return this._refCount>0;};
h.prototype.addRef=function(){++this._refCount;return this;};
h.prototype.release=function(){--this._refCount;return this;};
h.prototype.destroy=function(){if(this.sourceDatum){this.sourceDatum.release();}};
var j=function(i,m){Object.defineProperties(this,{source:{value:i.getSource()},sourceType:{value:i.getSourceType()},sourceId:{value:i.getSourceId(),writable:true},name:{value:i.getName()},localMatrix:{value:i.getLocalMatrix(),writable:true},password:{value:i.getPassword()},children:{value:i.getContentResources().map(function(i){return new j(i);})},dvlSceneDatum:{value:null,writable:true},nodeProxy:{value:null,writable:true},fake:{value:!!m},sourceProperties:{value:null,writable:true}});i._shadowContentResource=this;};
j.prototype.destroy=function(){if(this.dvlSceneDatum){this.dvlSceneDatum.release();}};
var k=function(v,s){Object.defineProperties(this,{vkScene:{value:v},shadowContentResource:{value:s}});};
var G=E.extend("sap.ui.vk.GraphicsCore",{
metadata:{publicMethods:["buildSceneTree","createViewStateManager","destroyScene","destroyViewStateManager","getApi","loadContentResourcesAsync","showDebugInfo"]},
constructor:function(r,w){E.apply(this);var s=q.extend({},r,{filePackagePrefixURL:q.sap.getResourcePath("sap/ve")+"/"});this._dvlClientId=q.sap.uid();this._dvl=sap.ve.dvl.createRuntime(s);this._dvl.CreateCoreInstance(this._dvlClientId);sap.ui.vk.dvl.checkResult(this._dvl.Core.Init(this._DVLMajorVersion,this._DVLMinorVersion));var u=sap.ui.getCore();u.attachLocalizationChanged(this._onlocalizationChanged,this);sap.ui.vk.dvl.checkResult(this._dvl.Core.SetLocale(u.getConfiguration().getLanguageTag()));this._canvas=this._createRenderingCanvasAndContext(w);this._rendererId=sap.ui.vk.dvl.getPointer(this._dvl.Core.CreateRenderer());this._dvl.Renderer.SetOptionF(sap.ve.dvl.DVLRENDEROPTIONF.DVLRENDEROPTIONF_DPI,96*window.devicePixelRatio,this._rendererId);this._sourceData=[];this._dvlSceneData=[];this._vkSceneData=[];this._viewports=[];this._renderLoopRequestId=null;this._renderLoopFunction=this._renderLoop.bind(this);this._viewStateManagers=[];},
_DVLMajorVersion:7,
_DVLMinorVersion:0
});
G.prototype.destroy=function(){sap.ui.getCore().detachLocalizationChanged(this._onlocalizationChanged,this);var v=this._viewports.slice();v.reverse();v.forEach(function(i){i.control.setGraphicsCore(null);});this._viewports=null;this._cleanupVkSceneData();this._vkSceneData=null;this._cleanupDvlSceneData();this._dvlSceneData=null;this._cleanupSourceData();this._sourceData=null;this._viewStateManagers.slice().forEach(this.destroyViewStateManager.bind(this));this._viewStateManagers=null;this._webGLContext=null;this._canvas=null;this._dvl.Core.DeleteRenderer(this._rendererId);this._rendererId=null;this._dvl.Core.Release();this._dvl=null;E.prototype.destroy.apply(this);};
G.prototype._createRenderingCanvasAndContext=function(w){var i=document.createElement("canvas");i.id=q.sap.uid();this._webGLContext=this._dvl.Core.CreateWebGLContext(i,w);return i;};
G.prototype._getCanvas=function(){return this._canvas;};
G.prototype._getWebGLContext=function(){return this._webGLContext;};
G.prototype._getDvl=function(){return this._dvl;};
G.prototype._getDvlClientId=function(){return this._dvlClientId;};
G.prototype._findSourceData=function(i){var m=Object.getOwnPropertyNames(i);return this._sourceData.filter(function(r){return m.every(function(s){return i[s]===r[s];});});};
G.prototype._destroySourceDatum=function(s){if(!(s instanceof f)){this._dvl.Core.DeleteFileByUrl(d(s.source),g(s.source));}s.destroy();return this;};
G.prototype._cleanupSourceData=function(){var m=false;for(var i=this._sourceData.length-1;i>=0;--i){var s=this._sourceData[i];if(!s.isInUse()){var r=s instanceof f?s.vdsSourceDatum:null;this._sourceData.splice(i,1);this._destroySourceDatum(s);if(r&&!r.isInUse()){m=true;}}}if(m){this._cleanupSourceData();}return this;};
G.prototype._findDvlSceneData=function(i){var m=Object.getOwnPropertyNames(i);return this._dvlSceneData.filter(function(r){return m.every(function(s){return i[s]===r[s];});});};
G.prototype._destroyDvlSceneDatum=function(i){this._dvl.Scene.Release(i.dvlSceneId);i.destroy();return this;};
G.prototype._cleanupDvlSceneData=function(){for(var i=this._dvlSceneData.length-1;i>=0;--i){var m=this._dvlSceneData[i];if(!m.isInUse()){this._dvlSceneData.splice(i,1);this._destroyDvlSceneDatum(m);}}};
G.prototype._findVkSceneData=function(i){var m=Object.getOwnPropertyNames(i);return this._vkSceneData.filter(function(r){return m.every(function(s){return i[s]===r[s];});});};
G.prototype._cleanupVkSceneData=function(){for(var i=this._vkSceneData.length-1;i>=0;--i){this.destroyScene(this._vkSceneData[i].vkScene);}};
G.prototype._destroyShadowContentResource=function(v,s){if(s.children){s.children.forEach(this._destroyShadowContentResource.bind(this,v));}if(s.nodeProxy){this._dvl.Scene.DeleteNode(v._getDvlSceneId(),s.nodeProxy.getNodeId());v.getDefaultNodeHierarchy().destroyNodeProxy(s.nodeProxy);}s.destroy();};
G.prototype._filterContentResources=function(i,m){var r=[];i.forEach(function enumerate(s){if(m(s)){r.push(s);}s.getContentResources().forEach(enumerate);});return r;};
G.prototype._getContentResourcesWithMissingPasswords=function(i){var l=this._dvl.Library;return this._filterContentResources(i,function(m){var s=m.getSource();return s&&(l.RetrieveInfo(d(s),g(s)).flags&sap.ve.dvl.DVLFILEFLAG.ENCRYPTED)&&!m.getPassword();});};
G.prototype._getContentResourcesWithEncryptedVds3=function(i){var l=this._dvl.Library;return this._filterContentResources(i,function(m){var s=m.getSource();if(s){var r=l.RetrieveInfo(d(s),g(s));return r.major<=3&&(r.flags&sap.ve.dvl.DVLFILEFLAG.ENCRYPTED);}else{return false;}});};
G.prototype._collectSourceProperties=function(s){var i=this._dvl.Library.RetrieveInfo(d(s.source),g(s.source));s.sourceProperties={version:{major:i.major,minor:i.minor}};if(i.flags&(sap.ve.dvl.DVLFILEFLAG.PAGESCOMPRESSED|sap.ve.dvl.DVLFILEFLAG.WHOLEFILECOMPRESSED)){s.sourceProperties.compressed=true;}if(i.flags&sap.ve.dvl.DVLFILEFLAG.ENCRYPTED){s.sourceProperties.encrypted=true;}return this;};
G.prototype.loadContentResourcesAsync=function(i,r,s){var t=this,u=[],v=new Map();i.forEach(function enumerate(m){var z=m.getSource();if(z&&u.indexOf(z)<0&&t._findSourceData({source:z}).length===0){u.push(z);if(m.getSourceType()==="vdsl"){v.set(z,{});}}m.getContentResources().forEach(enumerate);});var w=[];if(u.length>0){var x;var y=new a(u).attachItemSucceeded(function(z){var A=z.getParameter("source");var B=z.getParameter("response");if(v.has(A)){var F=sap.ui.vk.utf8ArrayBufferToString(B);if(F.trim().length===0){x=x||[];x.push({source:A,status:M.VIT22.code,statusText:sap.ui.vk.getResourceBundle().getText(M.VIT22.summary)});c.error(sap.ui.vk.getResourceBundle().getText(M.VIT22.summary),M.VIT22.code,"sap.ui.vk.GraphicsCore");return;}else{var I=F.split(/\n|\r\n/);var m=I[0].match(/^file=(.+)$/);if(!m){x=x||[];x.push({source:A,status:M.VIT23.code,statusText:sap.ui.vk.getResourceBundle().getText(M.VIT23.summary)});c.error(sap.ui.vk.getResourceBundle().getText(M.VIT23.summary),M.VIT23.code,"sap.ui.vk.GraphicsCore");return;}else{var J=v.get(A);J.content=I;var K=m[1];var L=K;var O=new URI(L);if(O.is("relative")){if(A instanceof File){x=x||[];x.push({source:A,status:M.VIT24.code,statusText:sap.ui.vk.getResourceBundle().getText(M.VIT24.summary)});c.error(sap.ui.vk.getResourceBundle().getText(M.VIT24.summary),M.VIT24.code,"sap.ui.vk.GraphicsCore");return;}else{var P=new URI(A);K=O.absoluteTo(P).href();}}J.referencedSource=K;J.content[0]=J.content[0].replace(L,this._dvl.Core.GetFilename(J.referencedSource,"remote"));if(u.indexOf(J.referencedSource)<0&&this._findSourceData({source:J.referencedSource}).length===0){u.push(J.referencedSource);y.queue(J.referencedSource);}}}}else{var Q=A instanceof File;var R=Q?A.name:A;var T=g(A);this._dvl.Core.CreateFileFromArrayBuffer(B,R,T);w.push(new e(A));}},this).attachAllItemsCompleted(function(m){if(x){w.forEach(this._destroySourceDatum.bind(this));}else{Array.prototype.push.apply(this._sourceData,w);v.forEach(function(z,A){var B=this._findSourceData({source:z.referencedSource})[0];var F=new f(A,B,z.content.join("\n"));this._sourceData.push(F);B.addRef();}.bind(this));}if(r){r(x);}},this).attachItemFailed(function(m){x=x||[];x.push({source:m.getParameter("source"),status:m.getParameter("status"),statusText:m.getParameter("statusText")});},this);if(s){y.attachItemProgress(s,this);}y.start();}else if(r){r();}return this;};
G.prototype._mergeContentResource=function(i,m,r,s,t){var u=this._dvl.Scene.CreateNode(i,r,t.name,s);t.nodeProxy=m.createNodeProxy(u);if(t.localMatrix){t.nodeProxy.setLocalMatrix(t.localMatrix);}if(t.source){var v=this._findSourceData({source:t.source})[0];var w=this._findDvlSceneData({sourceDatum:v,root:false})[0];if(!w){w=new h(sap.ui.vk.dvl.getPointer(v instanceof f?this._dvl.Core.LoadSceneFromVDSL(v.content,t.password):this._dvl.Core.LoadSceneByUrl(d(t.source),t.password,g(t.source))),v,false);this._dvlSceneData.push(w);v.addRef();this._collectSourceProperties(t);if(t.sourceProperties.version.major>=4){c.warning(sap.ui.vk.getResourceBundle().getText(M.VIT20.summary),M.VIT20.code,"sap.ui.vk.GraphicsCore");}}t.dvlSceneDatum=w;w.addRef();this._dvl.Scene.RetrieveSceneInfo(w.dvlSceneId,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_CHILDREN).ChildNodes.forEach(function(x){this._dvl.Scene.CreateNodeCopy(i,x,u,sap.ve.dvl.DVLCREATENODECOPYFLAG.COPY_CHILDREN);}.bind(this));}t.children.forEach(this._mergeContentResource.bind(this,i,m,u,undefined));};
G.prototype.buildSceneTree=function(i){if(i.length===0){return null;}var r;var m;var s=i.map(function(w){return new j(w);});if(s.length===1){m=s[0];if(m.source){var t=this._findSourceData({source:m.source})[0];r=new h(sap.ui.vk.dvl.getPointer(t instanceof f?this._dvl.Core.LoadSceneFromVDSL(t.content,m.password):this._dvl.Core.LoadSceneByUrl(d(m.source),m.password,g(m.source))),t,true);t.addRef();this._collectSourceProperties(m);if(m.sourceProperties.version.major>=4){c.warning(sap.ui.vk.getResourceBundle().getText(M.VIT20.summary),M.VIT20.code,"sap.ui.vk.GraphicsCore");}}else{r=new h(this._dvl.Core.CreateEmptyScene(),null,true);}}else{var u=new C({sourceType:"vds",sourceId:q.sap.uid()});m=new j(u,true);u.destroy();u=null;Array.prototype.push.apply(m.children,s);s=[m];r=new h(this._dvl.Core.CreateEmptyScene(),null,true);}this._dvlSceneData.push(r);m.dvlSceneDatum=r;r.addRef();var v=new S(this,r.dvlSceneId);this._vkSceneData.push(new k(v,m));m.children.forEach(this._mergeContentResource.bind(this,r.dvlSceneId,v.getDefaultNodeHierarchy(),null,undefined));return v;};
G.prototype.updateSceneTree=function(v,m,r){if(m.length===0){return null;}var s=this._getContentResourcesWithEncryptedVds3(m);if(s.length>0){c.error(sap.ui.vk.getResourceBundle().getText(M.VIT25.summary),M.VIT25.code,"sap.ui.vk.GraphicsCore");if(r){r({contentResourcesWithEncryptedVds3:s});}return null;}var t=this._getContentResourcesWithMissingPasswords(m);if(t.length>0){c.error(sap.ui.vk.getResourceBundle().getText(M.VIT21.summary),M.VIT21.code,"sap.ui.vk.GraphicsCore");if(r){r({contentResourcesWithMissingPasswords:t});}return null;}if(!v){return this.buildSceneTree(m);}var u=this._findVkSceneData({vkScene:v})[0].shadowContentResource;var w=!!u.source;var x=m.length===1&&!!m[0].getSource();if(!(w&&x&&u.source===m[0].getSource()||!w&&!x&&u.fake===m.length>1)){return this.buildSceneTree(m);}var y=this;var z=v._getDvlSceneId();var A=v.getDefaultNodeHierarchy();function B(F,m,I){function J(O,P){if(!O&&!P){return true;}else if(!!O^!!P){return false;}else{return O.source===P.getSource()&&O.sourceType===P.getSourceType()&&O.name===P.getName()&&O.password===P.getPassword();}}function K(O,P){P._shadowContentResource=O;O.sourceId=P.getSourceId();O.localMatrix=P.getLocalMatrix();if(O.nodeProxy){O.nodeProxy.setLocalMatrix(O.localMatrix);}}var i=0;var L=q.sap.arrayDiff(F,m,J,true);L.forEach(function(O){for(;i<O.index;++i){B(F[i].children,m[i].getContentResources(),F[i].nodeProxy.getNodeId());K(F[i],m[i]);}if(O.type==="delete"){y._destroyShadowContentResource(v,F[O.index]);F.splice(O.index,1);}else if(O.type==="insert"){var P;if(i<F.length&&F[i].nodeProxy){P=F[i].nodeProxy.getNodeId();}var Q=new j(m[O.index]);y._mergeContentResource(z,A,I,P,Q);F.splice(O.index,0,Q);++i;}});for(;i<F.length;++i){B(F[i].children,m[i].getContentResources(),F[i].nodeProxy&&F[i].nodeProxy.getNodeId());K(F[i],m[i]);}}B(u.fake?u.children:[u],m,0);A.fireChanged();return v;};
G.prototype.destroyScene=function(v){var i;for(i=0;i<this._vkSceneData.length;++i){if(this._vkSceneData[i].vkScene===v){break;}}if(i===this._vkSceneData.length){c.warning("Scene with id '"+v.getId()+"' is not created by this GraphicsCore.");return this;}var m=this._vkSceneData.splice(i,1)[0];this._destroyShadowContentResource(v,m.shadowContentResource);v.destroy();return this;};
var n=function(m,r,t){for(var i=0,s=m.length;i<s;++i){if(r.call(t,m[i],i,m)){return i;}}return-1;};var o=function(v,i){return n(v,function(m){return m.control===i;});};var p=function(v,r){return n(v,function(i){return i.rendererId===r;});};
G.prototype._registerViewport=function(v){if(o(this._viewports,v)>=0){return false;}var i={control:v,canvas:null,rendererId:null};if(this._viewports.length===0){i.canvas=this._canvas;i.rendererId=this._rendererId;this._startRenderLoop();}else{if(this._viewports.length===1){var m=this._viewports[0];m.control._setCanvas(m.canvas=document.createElement("canvas"));this._dvl.Client.attachFrameFinished(this._handleFrameFinished,this);}i.canvas=document.createElement("canvas");i.rendererId=this._dvl.Core.CreateRenderer();}v._setCanvas(i.canvas);v._setRenderer(i.rendererId);v.attachResize(this._handleViewportResize,this);this._viewports.push(i);return true;};
G.prototype._deregisterViewport=function(v){var i=o(this._viewports,v);if(i<0){return false;}var m=this._viewports.splice(i,1)[0];if(this._viewports.length===0){this._stopRenderLoop();}else{if(this._viewports.length===1){this._dvl.Client.detachFrameFinished(this._handleFrameFinished,this);var r=this._viewports[1-i];r.control._setCanvas(r.canvas=this._canvas);}this._dvl.Core.DeleteRenderer(m.rendererId);}v.detachResize(this._handleViewportResize,this);v._setRenderer(null);v._setCanvas(null);return true;};
G.prototype._getViewportCount=function(){return this._viewports.length;};
G.prototype._handleViewportResize=function(i){if(this._viewports.length>1){this._canvas.width=Math.max.apply(null,this._viewports.map(function(v){return v.canvas.width;}));this._canvas.height=Math.max.apply(null,this._viewports.map(function(v){return v.canvas.height;}));}};
G.prototype._startRenderLoop=function(){if(!this._renderLoopRequestId){this._renderLoopRequestId=window.requestAnimationFrame(this._renderLoopFunction);}return this;};
G.prototype._stopRenderLoop=function(){if(this._renderLoopRequestId){window.cancelAnimationFrame(this._renderLoopRequestId);this._renderLoopRequestId=null;}return this;};
G.prototype._renderLoop=(function(){var i;return function(){var m=this._viewports.length>1;this._viewports.forEach(function(v){var r=v.canvas,s=v.rendererId;this._dvl.Renderer._processCommandQueue(s);if(r.width>0&&r.height>0&&this._dvl.Renderer.ShouldRenderFrame(s)){if(m&&i!==s){this._dvl.Renderer.SetDimensions(r.width,r.height,s);}this._dvl.Renderer.RenderFrame(s);i=s;}},this);this._renderLoopRequestId=window.requestAnimationFrame(this._renderLoopFunction);};})();
G.prototype._handleFrameFinished=function(i){if(this._viewports.length>1){var m=p(this._viewports,i.rendererId);if(m>=0){var t=this._viewports[m].canvas,r=t.getContext("2d"),s=t.width,u=t.height;r.drawImage(this._canvas,0,this._canvas.height-u,s,u,0,0,s,u);}}};
G.prototype.createViewStateManager=function(i,s,m){var v=new V(i,s,m);this._viewStateManagers.push(v);return v;};
G.prototype.destroyViewStateManager=function(v){var i=this._viewStateManagers.indexOf(v);if(i>=0){this._viewStateManagers.splice(i,1)[0].destroy();}return this;};
G.prototype.showDebugInfo=function(i){this._viewports.forEach(function(v){v.control.setShowDebugInfo(i);});return this;};
G.prototype.getApi=function(i){switch(i){case sap.ui.vk.GraphicsCoreApi.LegacyDvl:return this._dvl;default:return null;}};
G.prototype.collectGarbage=function(){this._cleanupDvlSceneData();this._cleanupSourceData();return this;};
G.prototype._onlocalizationChanged=function(i){if(i.getParameter("changes").language){sap.ui.vk.dvl.checkResult(this._dvl.Core.SetLocale(sap.ui.getCore().getConfiguration().getLanguageTag()));}};
G.prototype.setDecryptionHandler=function(i){this._dvl.Client.setDecryptionHandler(i);return this;};
G.prototype.getDecryptionHandler=function(){return this._dvl.Client.getDecryptionHandler();};
return G;});
sap.ui.predefine('sap/ui/vk/InputDeviceKeyboard',["jquery.sap.global","sap/ui/base/EventProvider"],function(q,E){"use strict";
var I=E.extend("sap.ui.vk.InputDeviceKeyboard",{
metadata:{publicMethods:["enable","disable"]},
constructor:function(l){this._loco=l;}
});
I.prototype.enable=function(c){this._control=c;this._control.attachBrowserEvent("keydown keyup keypress",this._onKeyEvent,this);};
I.prototype.disable=function(){this._control.detachBrowserEvent("keydown keyup keypress",this._onKeyEvent,this);};
I.prototype._onKeyEvent=function(e){this._loco.keyEventHandler(e,this._control);};
return I;},true);
sap.ui.predefine('sap/ui/vk/InputDeviceMouse',["jquery.sap.global","sap/ui/base/EventProvider"],function(q,E){"use strict";
var I=E.extend("sap.ui.vk.InputDeviceMouse",{
metadata:{publicMethods:["isSupported","enable","disable"]},
constructor:function(L){this._loco=L;this._buttons=0;this._buttonFlagsValue=0;this._zoomOrigin={x:0,y:0};this._mousedownProxy=this._onmousedown.bind(this);this._mouseupProxy=this._onmouseup.bind(this);this._mousemoveProxy=this._onmousemove.bind(this);this._mousewheelProxy=this._onmousewheel.bind(this);this._contextmenuProxy=this._oncontextmenu.bind(this);this._onmouseupWindowListenerProxy=this._onmouseupWindowListener.bind(this);}
});
I.prototype._buttonFlags=function(b,d){if(d){this._buttonFlagsValue|=(1<<b);}else{this._buttonFlagsValue&=~(1<<b);}return this._buttonFlagsValue;};
I.prototype._eventToInput=function(e,b){var a=(e.buttons!=undefined)?e.buttons:this._buttonFlagsValue;if(b){a=b;}var i={x:0,y:0,z:0,d:0,n:0,buttons:a,scroll:e.wheelDelta,points:[],handled:false};var n=0;switch(a){case 0:case 1:n=1;i.points.push({x:e.pageX,y:e.pageY,z:0});break;case 3:case 4:case 5:n=2;i.points.push({x:e.pageX,y:e.pageY,z:0});i.points.push({x:e.pageX,y:e.pageY,z:0});break;case 2:n=2;i.points.push({x:this._zoomOrigin.x,y:e.pageY,z:0});i.points.push({x:this._zoomOrigin.x,y:e.pageY+(this._zoomOrigin.y-e.pageY)*2,z:0});break;default:n=0;break;}i.n=n;return i;};
I.prototype._onmouseup=function(e){this._capturedByControl=true;var b=(e.buttons!=undefined)?e.buttons:this._buttonFlags(e.button,false);if(e["_sapui_handledByControl"]){return;}var i=this._eventToInput(e,this._buttons);this._loco.endGesture(i,this._control);if(b==2){this._zoomOrigin.x=e.pageX;this._zoomOrigin.y=e.pageY;}i=this._eventToInput(e);if(b!=0){i.handled=false;this._loco.beginGesture(i,this._control);}this._buttons=b;if(i.handled){e.preventDefault();e["_sapui_handledByControl"]=true;}};
I.prototype._onmouseupWindowListener=function(e){if(!this._capturedByControl){this._onmouseup(e);}this._capturedByControl=false;};
I.prototype._onmousemove=function(e){if(e["_sapui_handledByControl"]){return;}if(sap.ui.Device.os.name===sap.ui.Device.os.OS.MACINTOSH&&e.buttons===2){e.buttons=3;}var i=this._eventToInput(e);this._loco.move(i,this._control);if(i.handled){e["_sapui_handledByControl"]=true;e.preventDefault();}};
I.prototype._onmousedown=function(e){var b=(e.buttons!=undefined)?e.buttons:this._buttonFlags(e.button,true);if(e["_sapui_handledByControl"]){return;}var i;if(this._buttons!=0){i=this._eventToInput(e,this._buttons);this._loco.endGesture(i,this._control);}if(b==2){this._zoomOrigin.x=e.pageX;this._zoomOrigin.y=e.pageY;}i=this._eventToInput(e);i.handled=false;this._loco.beginGesture(i,this._control);this._prevButtons=b;this._buttons=b;if(i.handled){e["_sapui_handledByControl"]=true;e.preventDefault();}};
I.prototype._onmousewheel=function(e){var a=e.originalEvent?e.originalEvent:e;if(a["_sapui_handledByControl"]||this._buttons!=0){return;}this._zoomOrigin.x=a.pageX;this._zoomOrigin.y=a.pageY;var s={pageX:a.pageX,pageY:a.pageY,buttons:2,wheelDelta:a.wheelDelta};var i=this._eventToInput(s);this._loco.beginGesture(i,this._control);var d=a.detail?a.detail*(-40):a.wheelDelta;s.pageY-=d/5;i=this._eventToInput(s);i.handled=false;this._loco.move(i,this._control);i.handled=false;this._loco.endGesture(i,this._control);if(i.handled){a["_sapui_handledByControl"]=true;a.preventDefault();}};
I.prototype._oncontextmenu=function(e){var i=this._eventToInput(e);this._loco.contextMenu(i,this._control);if(i.handled){e["_sapui_handledByControl"]=true;e.preventDefault();}};
I.prototype.isSupported=function(){return true;};
I.prototype.enable=function(c){this._buttonFlagsValue=0;this._buttons=0;this._control=c;var f=this._control?this._control.attachBrowserEvent.bind(this._control):window.document.addEventListener;f("mousedown",this._mousedownProxy);f("mouseup",this._mouseupProxy);f("mousemove",this._mousemoveProxy);f("mousewheel",this._mousewheelProxy);f("DOMMouseScroll",this._mousewheelProxy);f("contextmenu",this._contextmenuProxy);window.document.addEventListener("mouseup",this._onmouseupWindowListenerProxy);};
I.prototype.disable=function(){var f=this._control?this._control.detachBrowserEvent.bind(this._control):window.document.removeEventListener;f("mousedown",this._mousedownProxy);f("mouseup",this._mouseupProxy);f("mousemove",this._mousemoveProxy);f("mousewheel",this._mousewheelProxy);f("DOMMouseScroll",this._mousewheelProxy);f("contextmenu",this._contextmenuProxy);window.document.removeEventListener("mouseup",this._onmouseupWindowListenerProxy);};
return I;},true);
sap.ui.predefine('sap/ui/vk/InputDevicePointer',["jquery.sap.global","sap/ui/base/EventProvider","./InputDeviceMouse"],function(q,E,I){"use strict";
var a=E.extend("sap.ui.vk.InputDevicePointer",{
metadata:{publicMethods:["isSupported","enable","disable"]},
constructor:function(L){this._loco=L;this._pointerIds=[];this._pointers=[];this._count=0;this._points=0;this._buttons=0;this._mouse=new I(this._loco);this._pointerdownProxy=this._onpointerdown.bind(this);this._pointerupProxy=this._onpointerup.bind(this);this._pointermoveProxy=this._onpointermove.bind(this);this._mousewheelProxy=this._mouse._onmousewheel.bind(this._mouse);this._contextmenuProxy=this._mouse._oncontextmenu.bind(this._mouse);this._onpointerupWindowListenerProxy=this._onpointerupWindowListener.bind(this);}
});
a.prototype._clearPointers=function(){this._pointerIds=[];this._pointers=[];this._count=0;this._points=0;this._buttons=0;};
a.prototype._addPointer=function(i,_,b){if(this._pointerIds[i]==null){this._pointerIds[i]=this._count;}var c=this._pointerIds[i];if(this._pointers.length<=c||this._pointers[c]==null){this._count++;}this._pointers[c]={x:_,y:b};return this._count;};
a.prototype._removePointer=function(i){if(this._pointerIds[i]==null){return this._count;}var b=this._pointerIds[i];this._pointerIds[i]=null;if(this._pointers.length>b&&this._pointers[b]!=null){this._count--;}this._pointers[b]=null;return this._count;};
a.prototype._eventToInput=function(e){var b={x:0,y:0,z:0,d:0,n:this._count,buttons:0,scroll:0,points:[],handled:false};var t=this._pointers;var l=t.length;for(var i=0;i<l;i++){var c=t[i];if(c!=null){b.points.push({x:c.x,y:c.y,z:0});}}return b;};
a.prototype._onpointerdown=function(e){var b=e.originalEvent?e.originalEvent:e;if(b.pointerType!="touch"&&b.pointerType!="pen"){this._buttons=b.buttons;this._mouse._onmousedown(b);return;}if(b.isPrimary){this._clearPointers();}this._addPointer(b.pointerId,b.pageX,b.pageY);b.target.setPointerCapture(b.pointerId);var i=this._eventToInput(b);if(this._points!=0&&this._points!=i.n){this._loco.endGesture(i,this._control);}this._points=i.n;i.handled=false;this._loco.beginGesture(i,this._control);if(i.handled){b["_sapui_handledByControl"]=true;b.preventDefault();}else{this._removePointer(b.pointerId);}};
a.prototype._onpointerup=function(e){this._capturedByControl=true;var b=e.originalEvent?e.originalEvent:e;if(b.pointerType!="touch"&&b.pointerType!="pen"){this._buttons=0;this._mouse._onmouseup(b);return;}this._removePointer(b.pointerId);b.target.releasePointerCapture(b.pointerId);var i=this._eventToInput(b);this._loco.endGesture(i,this._control);if(i.n!=0&&this._points!=i.n){i.handled=false;this._loco.beginGesture(i,this._control);}this._points=i.n;if(i.handled){b["_sapui_handledByControl"]=true;b.preventDefault();}};
a.prototype._onpointerupWindowListener=function(e){if(!this._capturedByControl){this._onpointerup(e);}this._capturedByControl=false;};
a.prototype._onpointermove=function(e){if(e.buttons!==0||sap.ui.Device.system.desktop){var b=e.originalEvent?e.originalEvent:e;if(b.pointerType!="touch"&&b.pointerType!="pen"){if(this._buttons!=b.buttons){this._mouse._onmousedown(b);this._buttons=b.buttons;}else{this._mouse._onmousemove(b);}return;}this._addPointer(b.pointerId,b.pageX,b.pageY);var i=this._eventToInput(b);if(this._points!=i.n){this._loco.endGesture(i,this._control);i.handled=false;this._loco.beginGesture(i,this._control);this._points=i.n;}else{this._loco.move(i,this._control);}if(i.handled){b["_sapui_handledByControl"]=true;b.preventDefault();}}};
a.prototype.isSupported=function(){if((sap.ui.Device.browser.edge||sap.ui.Device.browser.msie)&&sap.ui.Device.support.pointer){return true;}return false;};
a.prototype.enable=function(c){this._pointerIds=[];this._pointers=[];this._points=0;this._count=0;this._buttons=0;this._mouse._buttons=0;this._control=c;this._mouse._control=c;var f=this._control?this._control.attachBrowserEvent.bind(this._control):window.document.addEventListener;f("pointerdown",this._pointerdownProxy);f("pointerup",this._pointerupProxy);f("pointermove",this._pointermoveProxy);f("mousewheel",this._mousewheelProxy);f("DOMMouseScroll",this._mousewheelProxy);f("contextmenu",this._contextmenuProxy);window.document.addEventListener("pointerup",this._onpointerupWindowListenerProxy);};
a.prototype.disable=function(){var f=this._control?this._control.detachBrowserEvent.bind(this._control):window.document.removeEventListener;f("pointerdown",this._pointerdownProxy);f("pointerup",this._pointerupProxy);f("pointermove",this._pointermoveProxy);f("mousewheel",this._mousewheelProxy);f("DOMMouseScroll",this._mousewheelProxy);f("contextmenu",this._contextmenuProxy);window.document.removeEventListener("pointerup",this._onpointerupWindowListenerProxy);};
return a;},true);
sap.ui.predefine('sap/ui/vk/InputDeviceTouch',["jquery.sap.global","sap/ui/base/EventProvider"],function(q,E){"use strict";
var I=E.extend("sap.ui.vk.InputDeviceTouch",{
metadata:{publicMethods:["isSupported","enable","disable"]},
constructor:function(L){this._loco=L;this._points=0;this._touchdownProxy=this._ontouchdown.bind(this);this._touchupProxy=this._ontouchup.bind(this);this._touchmoveProxy=this._ontouchmove.bind(this);}
});
I.prototype._eventToInput=function(e){var a={x:0,y:0,z:0,d:0,n:e.touches.length,buttons:0,scroll:0,points:[],handled:false};for(var i=0;i<a.n;i++){var b=e.touches[i];a.points.push({x:b.pageX,y:b.pageY,z:0});}return a;};
I.prototype._ontouchdown=function(e){var i=this._eventToInput(e);if(this._points!=0&&this._points!=i.n){this._loco.endGesture(i,this._control);}this._points=i.n;i.handled=false;this._loco.beginGesture(i,this._control);if(i.handled){e["_sapui_handledByControl"]=true;e.preventDefault();}};
I.prototype._ontouchup=function(e){var i=this._eventToInput(e);this._loco.endGesture(i,this._control);this._points=0;if(i.handled){e["_sapui_handledByControl"]=true;e.preventDefault();}};
I.prototype._ontouchmove=function(e){var i=this._eventToInput(e);if(this._points!=i.n){this._loco.endGesture(i,this._control);i.handled=false;this._loco.beginGesture(i,this._control);this._points=i.n;}else{this._loco.move(i,this._control);}if(i.handled){e["_sapui_handledByControl"]=true;e.preventDefault();}};
I.prototype.isSupported=function(){return typeof window.ontouchstart!=="undefined";};
I.prototype.enable=function(c){this._points=0;this._control=c;var f=this._control?this._control.attachBrowserEvent.bind(this._control):window.document.addEventListener;f("touchstart",this._touchdownProxy);f("touchend",this._touchupProxy);f("touchmove",this._touchmoveProxy);};
I.prototype.disable=function(){var f=this._control?this._control.detachBrowserEvent.bind(this._control):window.document.removeEventListener;f("touchstart",this._touchdownProxy);f("touchend",this._touchupProxy);f("touchmove",this._touchmoveProxy);};
return I;},true);
sap.ui.predefine('sap/ui/vk/LayerProxy',["jquery.sap.global","./library","sap/ui/base/ManagedObject"],function(q,l,M){"use strict";var g=sap.ui.vk.dvl.getJSONObject;
var L=M.extend("sap.ui.vk.LayerProxy",{
metadata:{properties:{layerId:"string",veIds:"object[]",name:"string",description:"string",layerMetadata:"object"}},
constructor:function(n,a){M.call(this);this._dvl=n?n.getGraphicsCore()._getDvl():null;this._dvlSceneId=n?n._getDvlSceneId():null;this._dvlLayerId=a;}
});
L.prototype.destroy=function(){this._dvlLayerId=null;this._dvlSceneId=null;this._dvl=null;M.prototype.destroy.call(this);};
L.prototype.getLayerId=function(){return this._dvlLayerId;};
L.prototype.getVeIds=function(){return g(this._dvl.Scene.RetrieveVEIDs(this._dvlSceneId,this._dvlLayerId));};
L.prototype.getName=function(){return g(this._dvl.Scene.RetrieveLayerInfo(this._dvlSceneId,this._dvlLayerId)).name;};
L.prototype.getDescription=function(){return g(this._dvl.Scene.RetrieveLayerInfo(this._dvlSceneId,this._dvlLayerId)).description;};
L.prototype.getLayerMetadata=function(){return g(this._dvl.Scene.RetrieveMetadata(this._dvlSceneId,this._dvlLayerId)).metadata;};
L.prototype.getNodes=function(){return g(this._dvl.Scene.RetrieveLayerInfo(this._dvlSceneId,this._dvlLayerId)).nodes;};
delete L.prototype.setDescription;delete L.prototype.setLayerId;delete L.prototype.setLayerMetadata;delete L.prototype.setName;delete L.prototype.setVeIds;return L;});
sap.ui.predefine('sap/ui/vk/Loco',["jquery.sap.global","sap/ui/base/EventProvider","./InputDevicePointer","./InputDeviceMouse","./InputDeviceTouch","./InputDeviceKeyboard"],function(q,E,I,a,b,c){"use strict";
var L=E.extend("sap.ui.vk.Loco",{
metadata:{publicMethods:["addHandler","removeHandler","beginGesture","move","endGesture","contextMenu"]},
constructor:function(){if(L._instance){return L._instance;}E.apply(this);this._handlers=[];this._handlerMap=[];this._gesture=[];this._touchOrigin={x:0,y:0,z:0};this._touchMoved=false;this._touchButton=0;this._touchStart=0;this._touchEnd=0;this._clickTimer=0;this._isDoubleClick=false;L._instance=this;}
});
L.prototype.destroy=function(){this._gesture=[];this._handlers=[];};
L.prototype.addHandler=function(h){if(this._handlers.indexOf(h)>=0){return;}this._handlers.push(h);var v=h.getViewport();var d=this._handlerMap[v];if(d==null){this._handlerMap[v]=[];d=this._handlerMap[v];d.push(h);}else if(d.indexOf(h)==-1){d.push(h);}var p=new I(this);if(p.isSupported()){p.enable(v);v._pointer=p;}else{var m=new a(this);if(m.isSupported()){m.enable(v);v._mouse=m;}var t=new b(this);if(t.isSupported()){t.enable(v);v._touch=t;}}v._keyboard=new c(this);v._keyboard.enable(v);};
L.prototype.removeHandler=function(d){var v=d.getViewport();var h=this._handlers;var e=this._handlerMap[v];var f;if(e!=null){f=e.indexOf(d);if(f>=0){e.splice(f,1);}}f=h.indexOf(d);if(f>=0){h.splice(f,1);if(v._pointer){v._pointer.disable();v._pointer=null;}if(v._touch){v._touch.disable();v._touch=null;}if(v._mouse){v._mouse.disable();v._mouse=null;}if(v._keyboard){v._keyboard.disable();v._keyboard=null;}}};
L.prototype._processClick=function(d,v){this._clickTimer=0;var e={x:0,y:0,z:0,d:0,n:0,buttons:0,scrolls:[],points:[],handled:false};e.x=this._touchOrigin.x;e.y=this._touchOrigin.y;e.z=this._touchOrigin.z;e.buttons=this._touchButton;var h=this._handlerMap[v];if(h!=null){for(var i=h.length-1;i>=0;i--){if(d){var n=h[i].getViewport().getId();var p=/-nativeViewport$/.test(n)?n.replace(/-nativeViewport$/,""):null;var f=sap.ui.getCore().byId(p);if(!f||!f.getOverlay()||!(typeof f.getOverlay().mIACreateCB==="function")){h[i].doubleClick(e,v);}}else{h[i].click(e,v);}}}};
L.prototype._processInput=function(e){var d=e.points;switch(e.n){case 0:e.x=0;e.y=0;e.z=0;e.d=0;break;case 2:var f=d[0].x-d[1].x,g=d[0].y-d[1].y,h=d[0].z-d[1].z;e.x=(d[0].x+d[1].x)/2;e.y=(d[0].y+d[1].y)/2;e.z=(d[0].z+d[1].z)/2;e.d=Math.sqrt(f*f+g*g+h*h);break;default:e.x=d[0].x;e.y=d[0].y;e.z=d[0].z;e.d=0;break;}return e;};
L.prototype.beginGesture=function(e,v){if(this._gesture[v]){return;}if(this._clickTimer>0){clearTimeout(this._clickTimer);this._clickTimer=0;this._isDoubleClick=true;if(e.n==1&&e.buttons<=1&&this._touchButton<=1){this._processClick(true,v);}}this._processInput(e);var h=this._handlerMap[v];if(h!=null){for(var i=h.length-1;i>=0;i--){h[i].beginGesture(e);if(e.handled){break;}}}var n=new Date();this._touchStart=n.getTime();this._touchMoved=false;this._gesture[v]=true;this._touchOrigin.x=e.x;this._touchOrigin.y=e.y;this._touchOrigin.z=e.z;this._touchButton=e.buttons;if(this._touchEnd!=0&&this._touchStart-this._touchEnd<50){this._touchMoved=true;}};
L.prototype.move=function(e,v){this._processInput(e);var h=this._handlerMap[v];var i;if(this._gesture[v]){if(h!=null){for(i=h.length-1;i>=0;i--){h[i].move(e);if(e.handled){break;}}}var d=this._touchOrigin.x-e.x;var f=this._touchOrigin.y-e.y;var g=this._touchOrigin.z-e.z;if((d*d+f*f+g*g)>8){this._touchMoved=true;}}else if(h!=null){for(i=h.length-1;i>=0;i--){if(h[i].hover!=undefined){h[i].hover(e);if(e.handled){break;}}}}};
L.prototype.endGesture=function(e,v){if(!this._gesture[v]){return;}this._processInput(e);var h=this._handlerMap[v];if(h!=null){for(var i=h.length-1;i>=0;i--){h[i].endGesture(e);if(e.handled){break;}}}var n=new Date();this._touchEnd=n.getTime();if(!this._touchMoved&&!this._isDoubleClick&&(this._touchEnd-this._touchStart)<2000){this._clickTimer=setTimeout(function(l){l._processClick(false,v);},200,this);}this._isDoubleClick=false;this._gesture[v]=false;};
L.prototype.contextMenu=function(e,v){this._processInput(e);var h=this._handlerMap[v];if(h!=null){for(var i=h.length-1;i>=0;i--){h[i].contextMenu(e);if(e.handled){break;}}}};
L.prototype.keyEventHandler=function(e,v){var h=this._handlerMap[v];if(h!==null&&h!==undefined){for(var i=h.length-1;i>=0;i--){if(h[i].keyEventHandler){h[i].keyEventHandler(e);}}}};
return L;},true);
sap.ui.predefine('sap/ui/vk/Messages',["jquery.sap.global","sap/ui/base/ManagedObject"],function(q,M){"use strict";var a={VIT1:{summary:"NATIVEVIEWPORT_MSG_NOTBELOADED_SUMMARY",cause:"NATIVEVIEWPORT_MSG_NOTBELOADED_NOTFOUND_CAUSE",resolution:"NATIVEVIEWPORT_MSG_NOTBELOADED_NOTFOUND_CHECKEXISTS_RESOLUTION",code:"VIT1"},VIT2:{summary:"NATIVEVIEWPORT_MSG_NOTBELOADED_SUMMARY",cause:"NATIVEVIEWPORT_MSG_NOTBELOADED_NOTFOUND_CAUSE",resolution:"NATIVEVIEWPORT_MSG_NOTBELOADED_NOTFOUND_CHECKEXISTS_RESOLUTION",code:"VIT2"},VIT3:{summary:"NATIVEVIEWPORT_MSG_NOTBELOADED_SUMMARY",cause:"NATIVEVIEWPORT_MSG_NOTBELOADED_UNSUPPORTEDFILEFORMAT_CAUSE",resolution:"NATIVEVIEWPORT_MSG_NOTBELOADED_UNSUPPORTEDFILEFORMAT_CHECKFILEFORMAT_RESOLUTION",code:"VIT3"},VIT4:{summary:"NATIVEVIEWPORT_MSG_NOTBELOADED_SUMMARY",cause:"NATIVEVIEWPORT_MSG_NOTBELOADED_UNSUPPORTEDFILEFORMAT_CAUSE",resolution:"NATIVEVIEWPORT_MSG_NOTBELOADED_UNSUPPORTEDFILEFORMAT_CHECKFILEFORMAT_RESOLUTION",code:"VIT4"},VIT5:{summary:"DOWNLOADMANAGER_MSG_NOTBELOADED_SUMMARY",cause:"DOWNLOADMANAGER_MSG_NOTBELOADED_VALUESOURCEUNSUPPORTED_CAUSE",resolution:"DOWNLOADMANAGER_MSG_NOTBELOADED_VALUESOURCEUNSUPPORTED_CHECKSOURCEISURLORFILE_RESOLUTION",code:"VIT5"},VIT6:{summary:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_SUMMARY",cause:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_INVALIDQUERY_CAUSE",resolution:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_INVALIDQUERY_SPECIFYVALUEPROPERTY_RESOLUTION",code:"VIT6"},VIT7:{summary:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_SUMMARY",cause:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_PREDICATENOTSPECIFIED_CAUSE",resolution:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_PREDICATENOTSPECIFIED_SPECIFYPREDICATE_RESOLUTION",code:"VIT7"},VIT8:{summary:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_SUMMARY",cause:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_INCORRECTPREDICATEVALUE_CAUSE",resolution:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_INCORRECTPREDICATEVALUE_INVALIDPREDICATE_RESOLUTION",code:"VIT8"},VIT9:{summary:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_SUMMARY",cause:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_INCORRECTPREDICATEVALUE_CAUSE",resolution:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_INCORRECTPREDICATEVALUE_INVALIDPREDICATE_RESOLUTION",code:"VIT9"},VIT10:{summary:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_SUMMARY",cause:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_NOMETADATASPECIFIED_CAUSE",resolution:"NODEHIERARCHY_MSG_COULDNOTSEARCHNODES_NOMETADATASPECIFIED_SPECIFYMETADATACATEGORY_RESOLUTION",code:"VIT10"},VIT11:{summary:"OVERLAY_MSG_EVENTHANDLERFAILED_SUMMARY",cause:"OVERLAY_MSG_EVENTHANDLERFAILED_UNSUPPORTEDEVENTTYPE_CAUSE",resolution:"OVERLAY_MSG_EVENTHANDLERFAILED_UNSUPPORTEDEVENTTYPE_CHECKEVENTTYPE_RESOLUTION",code:"VIT11"},VIT12:{summary:"STEPNAVIGATION_MSG_STEPCOULDNOTBEPLAYED_SUMMARY",cause:"STEPNAVIGATION_MSG_STEPCOULDNOTBEPLAYED_INCORRECTSTEPEVENTTYPE_CAUSE",resolution:"STEPNAVIGATION_MSG_STEPCOULDNOTBEPLAYED_INCORRECTSTEPEVENTTYPE_CHECKSTEPEVENTTYPEVALUE_RESOLUTION",code:"VIT12"},VIT13:{summary:"VIEWER_MSG_CONTENTRESOURCESNOTLOADED_SUMMARY",cause:"VIEWER_MSG_CONTENTRESOURCESNOTLOADED_NONEXISTINGORUNSUPPORTEDFILE_CAUSE",resolution:"VIEWER_MSG_CONTENTRESOURCESNOTLOADED_NONEXISTINGORUNSUPPORTEDFILE_CHECKFILEEXISTSANDIFSUPPORT_RESOLUTION",code:"VIT13"},VIT14:{summary:"VIEWER_MSG_FAILEDTOBUILDSCENE_SUMMARY",cause:"VIEWER_MSG_FAILEDTOBUILDSCENE_COULDNOTCREATESCENE_CAUSE",resolution:"VIEWER_MSG_FAILEDTOBUILDSCENE_COULDNOTCREATESCENE_RELOADORSELECTANOTHERFILE_RESOLUTION",code:"VIT14"},VIT15:{summary:"VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_SUMMARY",cause:"VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_LOADINGMULTIPLE2DNOTSUPPORTED_CAUSE",resolution:"VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_LOADINGMULTIPLE2DNOTSUPPORTED_LOADONE2D_RESOLUTION",code:"VIT15"},VIT16:{summary:"VIEWER_MSG_NOTBELOADED_SUMMARY",cause:"VIEWER_MSG_NOTBELOADED_NONATIVESUPPORT_CAUSE",resolution:"VIEWER_MSG_NOTBELOADED_NONATIVESUPPORT_CHECKFILEFORMATSUPPORT_RESOLUTION",code:"VIT16"},VIT17:{summary:"VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_SUMMARY",cause:"VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_COMBINATIONOF2D3DNOTSUPPORTED_CAUSE",resolution:"VIEWER_MSG_ERRORLOADINGMULTIPLEFILES_COMBINATIONOF2D3DNOTSUPPORTED_MULTIPLESUPPORTFOR3DONLY_RESOLUTION",code:"VIT17"},VIT18:{summary:"VIEWPORT_MSG_ERRORLOADINGVIEWPORT_SUMMARY",cause:"VIEWPORT_MSG_ERRORLOADINGVIEWPORT_CREATINGMULTIPLEVIEWPORTINSTANCES_CAUSE",resolution:"VIEWPORT_MSG_ERRORLOADINGVIEWPORT_CREATINGMULTIPLEVIEWPORTINSTANCES_ONEINSTANCEOFVIEWPORTSUPPORTED_RESOLUTION",code:"VIT18"},VIT19:{summary:"VIEWPORT_MSG_COULDNOTSETCAMERAPROJECTION_SUMMARY",cause:"VIEWPORT_MSG_COULDNOTSETCAMERAPROJECTION_SPECIFIEDCAMERAPROJECTIONNOTSUPPORTED_CAUSE",resolution:"VIEWPORT_MSG_COULDNOTSETCAMERAPROJECTION_SPECIFIEDCAMERAPROJECTIONNOTSUPPORTED_CHECKPROJECTIONTYPESUPPORTED_RESOLUTION",code:"VIT19"},VIT20:{summary:"DOWNLOADMANAGER_MSG_VDS4_BETA_WARNING_SUMMARY",cause:"DOWNLOADMANAGER_MSG_VDS4_BETA_WARNING_CAUSE",resolution:"DOWNLOADMANAGER_MSG_VDS4_BETA_WARNING_RESOLUTION",code:"VIT20"},VIT21:{summary:"VIEWER_MSG_FAILEDTOBUILDSCENE_SUMMARY",cause:"VIEWER_MSG_FAILEDTOBUILDSCENE_MISSINGPASSWORD_CAUSE",resolution:"VIEWER_MSG_FAILEDTOBUILDSCENE_MISSINGPASSWORD_PROVIDEPASSWORD_RESOLUTION",code:"VIT21"},VIT22:{summary:"GRAPHICSCORE_MSG_VDSL_NOFILEPROPERTY_SUMMARY",cause:"GRAPHICSCORE_MSG_VDSL_EMPTY_CAUSE",resolution:"GRAPHICSCORE_MSG_VDSL_FIRSTLINE_WRONGFORMAT_RESOLUTION",code:"VIT22"},VIT23:{summary:"GRAPHICSCORE_MSG_VDSL_FIRSTLINE_WRONGFORMAT_SUMMARY",cause:"GRAPHICSCORE_MSG_VDSL_WRONGFORMAT_CAUSE",resolution:"GRAPHICSCORE_MSG_VDSL_FIRSTLINE_WRONGFORMAT_RESOLUTION",code:"VIT23"},VIT24:{summary:"GRAPHICSCORE_MSG_VDSL_RELATIVE_IN_LOCAL_SUMMARY",cause:"GRAPHICSCORE_MSG_VDSL_WRONGFORMAT_CAUSE",resolution:"GRAPHICSCORE_MSG_VDSL_RELATIVE_IN_LOCAL_RESOLUTION",code:"VIT24"},VIT25:{summary:"GRAPHICSCORE_MSG_VDS3ENCRYPTED_SUMMARY",cause:"GRAPHICSCORE_MSG_VDS3ENCRYPTED_CAUSE",resolution:"GRAPHICSCORE_MSG_VDS3ENCRYPTED_RESOLUTION",code:"VIT25"},VIT26:{summary:"VIEWPORT_UNSUPPORTED_STEP_INDEX_SUMMARY",cause:"VIEWPORT_UNSUPPORTED_STEP_INDEX_CAUSE",resolution:"VIEWPORT_UNSUPPORTED_STEP_INDEX_RESOLUTION",code:"VIT26"},VIT27:{summary:"VIEWPORT_UNSUPPORTED_PROCEDURE_INDEX_SUMMARY",cause:"VIEWPORT_UNSUPPORTED_PROCEDURE_INDEX_CAUSE",resolution:"VIEWPORT_UNSUPPORTED_PROCEDURE_INDEX_RESOLUTION",code:"VIT27"},VIT28:{summary:"VIEWPORT_UNSUPPORTED_VISIBILITY_MODE_SUMMARY",cause:"VIEWPORT_UNSUPPORTED_VISIBILITY_MODE_CAUSE",resolution:"VIEWPORT_UNSUPPORTED_VISIBILITY_MODE_RESOLUTION",code:"VIT28"},VIT29:{summary:"VIEWER_RUNTIME_SETTINGS_NOT_CHANGEABLE_SUMMARY",cause:"VIEWER_RUNTIME_SETTINGS_NOT_CHANGEABLE_CAUSE",resolution:"VIEWER_RUNTIME_SETTINGS_NOT_CHANGEABLE_RESOLUTION",code:"VIT29"},VIT30:{summary:"VIEWER_WEBGLCONTEXTATTRIBUTES_NOT_CHANGEABLE_SUMMARY",cause:"VIEWER_WEBGLCONTEXTATTRIBUTES_NOT_CHANGEABLE_CAUSE",resolution:"VIEWER_WEBGLCONTEXTATTRIBUTES_NOT_CHANGEABLE_RESOLUTION",code:"VIT30"},VIT31:{summary:"VIEWPORT_UNSUPPORTED_RESET_OPTIONS_SUMMARY",cause:"VIEWPORT_UNSUPPORTED_RESET_OPTIONS_CAUSE",resolution:"VIEWPORT_UNSUPPORTED_RESET_OPTIONS_RESOLUTION",code:"VIT31"},VIT32:{summary:"VIEWPORT_UNSUPPORTED_VISIBILITY_TRACKING_SUMMARY",cause:"VIEWPORT_UNSUPPORTED_VISIBILITY_TRACKING_CAUSE",resolution:"VIEWPORT_UNSUPPORTED_VISIBILITY_TRACKING_RESOLUTION",code:"VIT32"}};q.sap.setObject("sap.ui.vk.Messages",a);return a;});
sap.ui.predefine('sap/ui/vk/NativeViewportRenderer',["jquery.sap.global"],function(q){"use strict";var N={};
N.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapVizKitNativeViewport");r.writeClasses();r.writeAttribute("tabindex",0);r.write(">");r.write("</div>");};
return N;},true);
sap.ui.predefine('sap/ui/vk/NodeHierarchy',["jquery.sap.global","./library","sap/ui/base/EventProvider","sap/ui/base/ObjectPool","./BaseNodeProxy","./NodeProxy","./LayerProxy","./Messages"],function(q,l,E,O,B,N,L,M){"use strict";var g=sap.ui.vk.dvl.getJSONObject;var s={modeDictionary:{equals:function(i){return i?sap.ve.dvl.DVLFINDNODEMODE.DVLFINDNODEMODE_EQUAL:sap.ve.dvl.DVLFINDNODEMODE.DVLFINDNODEMODE_EQUAL_CASE_INSENSITIVE;},contains:function(i){return i?sap.ve.dvl.DVLFINDNODEMODE.DVLFINDNODEMODE_SUBSTRING:sap.ve.dvl.DVLFINDNODEMODE.DVLFINDNODEMODE_SUBSTRING_CASE_INSENSITIVE;},startsWith:function(i){return i?sap.ve.dvl.DVLFINDNODEMODE.DVLFINDNODEMODE_STARTS_WITH:sap.ve.dvl.DVLFINDNODEMODE.DVLFINDNODEMODE_STARTS_WITH_CASE_INSENSITIVE;}}};
var a=E.extend("sap.ui.vk.NodeHierarchy",{
metadata:{publicMethods:["attachChanged","attachNodeCreated","attachNodeRemoving","createLayerProxy","createNode","createNodeCopy","createNodeProxy","destroyLayerProxy","destroyNodeProxy","detachChanged","detachNodeCreated","detachNodeRemoving","enumerateAncestors","enumerateChildren","findNodesById","findNodesByMetadata","findNodesByName","fireChanged","fireNodeChanged","fireNodeRemoving","getAncestors","getChildren","getGraphicsCore","getLayers","getScene","removeNode"]},
_baseNodeProxyPool:new O(B),
constructor:function(b){E.apply(this);this._graphicsCore=b.getGraphicsCore();this._scene=b;this._dvlSceneId=this._scene._getDvlSceneId();this._dvl=this._graphicsCore._getDvl();this._nodeProxies=[];this._layerProxies=[];}
});
a.prototype.destroy=function(){this._layerProxies.slice().forEach(this.destroyLayerProxy,this);this._nodeProxies.slice().forEach(this.destroyNodeProxy,this);this._dvl=null;this._dvlSceneId=null;this._scene=null;this._graphicsCore=null;E.prototype.destroy.apply(this);};
a.prototype.getGraphicsCore=function(){return this._graphicsCore;};
a.prototype.getScene=function(){return this._scene;};
a.prototype._getDvlSceneId=function(){return this._dvlSceneId;};
a.prototype.enumerateChildren=function(n,c,b,p){if(typeof n==="function"){p=b;b=c;c=n;n=undefined;}var d;if(n){if(b||(g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS)).Flags&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_CLOSED)===0){d=g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_CHILDREN)).ChildNodes;}else{d=[];}}else{d=g(this._dvl.Scene.RetrieveSceneInfo(this._dvlSceneId,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_CHILDREN)).ChildNodes;}if(p){d.forEach(c);}else{var e=this._baseNodeProxyPool.borrowObject();try{d.forEach(function(n){e.init(this,n);c(e);e.reset();}.bind(this));}finally{this._baseNodeProxyPool.returnObject(e);}}return this;};
a.prototype.enumerateAncestors=function(n,c,p){var b=g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_PARENTS)).ParentNodes;if(p){b.forEach(c);}else{var d=this._baseNodeProxyPool.borrowObject();try{b.forEach(function(n){d.init(this,n);c(d);d.reset();}.bind(this));}finally{this._baseNodeProxyPool.returnObject(d);}}return this;};
a.prototype.createNodeProxy=function(n){var b=new N(this,n);this._nodeProxies.push(b);return b;};
a.prototype.destroyNodeProxy=function(n){var i=this._nodeProxies.indexOf(n);if(i>=0){this._nodeProxies.splice(i,1)[0].destroy();}return this;};
a.prototype.getChildren=function(n,b){if(typeof n==="boolean"){b=n;n=undefined;}if(n){if(b||(g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS)).Flags&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_CLOSED)===0){return g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_CHILDREN)).ChildNodes;}else{return[];}}else{return g(this._dvl.Scene.RetrieveSceneInfo(this._dvlSceneId,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_CHILDREN)).ChildNodes;}};
a.prototype.getAncestors=function(n){return g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,n,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_PARENTS)).ParentNodes;};
a.prototype.findNodesById=function(b){if(b.fields.some(function(h){return!h.caseSensitive;})){b=q.extend(true,{},b);b.fields.forEach(function(h){if(!h.caseSensitive){h.value=h.value.toLowerCase();}});}var c=function(p,h,v,j){var m;p=p||"equals";j=j||"";var k=h?v:v.toLowerCase();switch(p){case"equals":m=(k===j);break;case"contains":m=(k.indexOf(j)!==-1);break;case"startsWith":m=(k.indexOf(j)===0);break;default:m=false;q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT8.summary),M.VIT8.code,"sap.ui.vk.NodeHierarchy");}return m;};var i=function(h,j){return!h.some(function(v){return j.name===v.name?c(j.predicate,j.caseSensitive,v.value,j.value):false;});};var f=function(b,v){return b.source===v.source&&b.type===v.type&&!b.fields.some(i.bind(undefined,v.fields));};var d=this.findNodesByName();var e=d.filter(function(n){var h=this.createNodeProxy(n);var v=h.getVeIds();this.destroyNodeProxy(h);return v.some(f.bind(undefined,b));}.bind(this));return e;};
a.prototype.findNodesByName=function(b){var c=sap.ve.dvl.DVLFINDNODETYPE.DVLFINDNODETYPE_NODE_NAME,d=[],e,f;if(b===undefined||b===null||q.isEmptyObject(b)){e=s.modeDictionary.contains(false);f=[""];}else{if(b.value===undefined||b.value===null||b.value===""){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT6.summary),M.VIT6.code,"sap.ui.vk.NodeHierarchy");}var p=b.hasOwnProperty("predicate")?b.predicate:"equals";if(p===undefined||p===null||p===""){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT7.summary),M.VIT7.code,"sap.ui.vk.NodeHierarchy");}else if(["equals","contains","startsWith"].indexOf(p)===-1){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT8.summary),M.VIT8.code,"sap.ui.vk.NodeHierarchy");}e=s.modeDictionary[p](b.caseSensitive);f=(typeof b.value==="string")?[b.value]:b.value;}for(var i=0;i<f.length;i++){d=d.concat(g(this._dvl.Scene.FindNodes(this._dvlSceneId,c,e,f[i])).nodes);}return q.sap.unique(d);};
a.prototype.findNodesByMetadata=function(b){var c=function(m,k,n,v,i,j){if(m.hasOwnProperty(k)){var o=m[k];if(o.hasOwnProperty(n)){var t=o[n];if(!j){t=t.toLowerCase();}return v.some(i.bind(undefined,t));}}return false;};var d=function(m,k){return m.hasOwnProperty(k);};var e=function(f,h,k,m,v,i,j){var n=this._baseNodeProxyPool.borrowObject();var r=f.filter(function(o){n.init(this,o);var t=n.getNodeMetadata();var u=h(t,k,m,v,i,j);n.reset();return u;}.bind(this));this._baseNodeProxyPool.returnObject(n);return r;};var f=this.findNodesByName(),r=[];if(b===undefined||b===null||q.isEmptyObject(b)){r=f;}else if(b.category!==null&&b.category!==undefined&&b.category!==""){var h,v,p,i,j=!!(b&&b.caseSensitive);if(b.key===undefined||b.key===null){h=d;}else{v=b.value;p=b.predicate||"equals";if(v===undefined||v===null){v="";p="contains";}if(!Array.isArray(v)){v=[v];}if(!j){v=v.map(function(k){return k.toLowerCase();});}switch(p){case"equals":i=function(m,k){return m===k;};break;case"contains":i=function(m,k){return m.indexOf(k)!==-1;};break;case"startsWith":i=function(m,k){return m.indexOf(k)===0;};break;default:q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT9.summary),M.VIT9.code,"sap.ui.vk.NodeHierarchy");}h=c;}r=e.bind(this)(f,h,b.category,b.key,v,i,j);}else{q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT10.summary),M.VIT10.code,"sap.ui.vk.NodeHierarchy");}return q.sap.unique(r);};
a.prototype.createLayerProxy=function(b){var c=new L(this,b);this._layerProxies.push(c);return c;};
a.prototype.destroyLayerProxy=function(b){var i=this._layerProxies.indexOf(b);if(i>=0){this._layerProxies.splice(i,1)[0].destroy();}return this;};
a.prototype.getLayers=function(){return g(this._dvl.Scene.RetrieveSceneInfo(this._dvlSceneId,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_LAYERS)).Layers;};
a.prototype.getHotspotNodeIds=function(){var h=g(this._dvl.Scene.RetrieveSceneInfo(this._dvlSceneId,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_HOTSPOTS).ChildNodes);return h.length>0?h:this._getLegacyHotspotNodeIds();};
a.prototype._getLegacyHotspotNodeIds=function(){var b=this.getLayers(),h=[];for(var i=0;i<b.length;i++){var c=this.createLayerProxy(b[i]),d=c.getName();if(d.toLowerCase()==="hotspots"){h=c.getNodes();this.destroyLayerProxy(c);break;}this.destroyLayerProxy(c);}return h;};
a.prototype.attachChanged=function(d,f,b){return this.attachEvent("changed",d,f,b);};
a.prototype.detachChanged=function(d,f,b){return this.detachEvent("changed",d,f,b);};
a.prototype.fireChanged=function(p,b,e){return this.fireEvent("changed",p,b,e);};
a.prototype.attachNodeCreated=function(d,f,b){return this.attachEvent("nodeCreated",d,f,b);};
a.prototype.detachNodeCreated=function(d,f,b){return this.detachEvent("nodeCreated",d,f,b);};
a.prototype.fireNodeCreated=function(p,b,e){return this.fireEvent("nodeCreated",p,b,e);};
a.prototype.attachNodeRemoving=function(d,f,b){return this.attachEvent("nodeRemoving",d,f,b);};
a.prototype.detachNodeRemoving=function(d,f,b){return this.detachEvent("nodeRemoving",d,f,b);};
a.prototype.fireNodeRemoving=function(p,b,e){return this.fireEvent("nodeRemoving",p,b,e);};
a.prototype.createNode=function(p,n,i){var b=this._dvl.Scene.CreateNode(this._dvlSceneId,p,n,i);this.fireNodeCreated({nodeId:b});this.fireChanged();return b;};
a.prototype.createNodeCopy=function(n,p,b,i){var c=this._dvl.Scene.CreateNodeCopy(this._dvlSceneId,n,p,sap.ve.dvl.DVLCREATENODECOPYFLAG.COPY_CHILDREN,b,i);this.fireNodeCreated({nodeId:c});this.fireChanged();return c;};
a.prototype.removeNode=function(n){this.fireNodeRemoving({nodeId:n});this._dvl.Scene.DeleteNode(this._dvlSceneId,n);this.fireChanged();return this;};
return a;});
sap.ui.predefine('sap/ui/vk/NodeProxy',["jquery.sap.global","./library","sap/ui/base/ManagedObject"],function(q,l,M){"use strict";var g=sap.ui.vk.dvl.getJSONObject;
var N=M.extend("sap.ui.vk.NodeProxy",{
metadata:{properties:{nodeId:"string",veIds:"object[]",name:"string",localMatrix:{type:"sap.ui.vk.TransformationMatrix",bindable:"bindable"},worldMatrix:{type:"sap.ui.vk.TransformationMatrix",bindable:"bindable"},opacity:{type:"float",bindable:"bindable"},tintColorABGR:{type:"int",bindable:"bindable"},tintColor:{type:"sap.ui.core.CSSColor",bindable:"bindable"},nodeMetadata:"object",hasChildren:"boolean",closed:"boolean"}},
constructor:function(n,a){M.call(this);this._dvl=n?n.getGraphicsCore()._getDvl():null;this._dvlSceneId=n?n._getDvlSceneId():null;this._dvlNodeId=a;}
});
N.prototype.destroy=function(){this._dvlNodeId=null;this._dvlSceneId=null;this._dvl=null;M.prototype.destroy.call(this);};
N.prototype.getNodeId=function(){return this._dvlNodeId;};
N.prototype.getVeIds=function(){return g(this._dvl.Scene.RetrieveVEIDs(this._dvlSceneId,this._dvlNodeId));};
N.prototype.getName=function(){return g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,this._dvlNodeId,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_NAME)).NodeName;};
N.prototype.getLocalMatrix=function(){return sap.ui.vk.TransformationMatrix.convertTo4x3(g(this._dvl.Scene.GetNodeLocalMatrix(this._dvlSceneId,this._dvlNodeId)).matrix);};
N.prototype.setLocalMatrix=function(v){this._dvl.Scene.SetNodeLocalMatrix(this._dvlSceneId,this._dvlNodeId,v&&sap.ui.vk.TransformationMatrix.convertTo4x4(v));this.setProperty("localMatrix",v,true);return this;};
N.prototype.getWorldMatrix=function(){return sap.ui.vk.TransformationMatrix.convertTo4x3(g(this._dvl.Scene.GetNodeWorldMatrix(this._dvlSceneId,this._dvlNodeId)).matrix);};
N.prototype.setWorldMatrix=function(v){this._dvl.Scene.SetNodeWorldMatrix(this._dvlSceneId,this._dvlNodeId,v&&sap.ui.vk.TransformationMatrix.convertTo4x4(v));this.setProperty("worldMatrix",v,true);return this;};
N.prototype.getOpacity=function(){return g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,this._dvlNodeId,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_OPACITY)).Opacity;};
N.prototype.setOpacity=function(v){this._dvl.Scene.SetNodeOpacity(this._dvlSceneId,this._dvlNodeId,v);this.setProperty("opacity",v,true);return this;};
N.prototype.getTintColorABGR=function(){return g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,this._dvlNodeId,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_HIGHLIGHT_COLOR)).HighlightColor;};
N.prototype.setTintColorABGR=function(v){this._dvl.Scene.SetNodeHighlightColor(this._dvlSceneId,this._dvlNodeId,v);this.setProperty("tintColorABGR",v,true);this.setProperty("tintColor",sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(v)),true);return this;};
N.prototype.getTintColor=function(){return sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(this.getTintColorABGR()));};
N.prototype.setTintColor=function(v){var a=sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(v));this._dvl.Scene.SetNodeHighlightColor(this._dvlSceneId,this._dvlNodeId,a);this.setProperty("tintColorABGR",a,true);this.setProperty("tintColor",v,true);return this;};
N.prototype.getNodeMetadata=function(){return g(this._dvl.Scene.RetrieveMetadata(this._dvlSceneId,this._dvlNodeId)).metadata;};
N.prototype.getHasChildren=function(){return(g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,this._dvlNodeId,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS)).Flags&(sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_MAPPED_HASCHILDREN|sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_CLOSED))===sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_MAPPED_HASCHILDREN;};
N.prototype.getClosed=function(){return(g(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,this._dvlNodeId,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS)).Flags&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_CLOSED)!==0;};
delete N.prototype.setClosed;delete N.prototype.setHasChildren;delete N.prototype.setName;delete N.prototype.setNodeId;delete N.prototype.setNodeMetadata;delete N.prototype.setVeIds;return N;});
sap.ui.predefine('sap/ui/vk/NotificationsRenderer',["jquery.sap.global"],function(q){"use strict";var N={};
N.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapVizKitNotifications");r.writeClasses();r.write(">");r.renderControl(c.getAggregation("_messagePopoverToggleButton"));r.write("</div>");};
return N;},true);
sap.ui.predefine('sap/ui/vk/ProgressIndicator',["jquery.sap.global","./library","sap/ui/core/Control"],function(q,l,C){"use strict";
var P=C.extend("sap.ui.vk.ProgressIndicator",{metadata:{library:"sap.ui.vk",properties:{numberOfFiles:{type:"int",defaultValue:0}},publicMethods:["reset","updateDownloadStatus","updateRenderStatus"],aggregations:{progressBar:{type:"sap.m.ProgressIndicator",multiple:false,visibility:"hidden"},progressText:{type:"sap.m.Text",multiple:false,visibility:"hidden"}}}});
P.prototype.init=function(){this._progressBar=new sap.m.ProgressIndicator({width:"100%",height:"0.375em"});this.setAggregation("progressBar",this._progressBar);this._progressText=new sap.m.Text();this._progressText.addStyleClass("sapUiVizkitProgressIndicatorText");this.setAggregation("progressText",this._progressText);this.reset();};
P.prototype.reset=function(){this._downloadStatusByFile={};this._downloadStatusTotal=0;this._renderStatusFileCounter=0;this._renderStatusByFile={};this._renderStatusPreviousUpdate=-1;this._renderStatusTotal=0;this.setNumberOfFiles(0);this._progressBar.setPercentValue(0);return this;};
P.prototype.updateDownloadStatus=function(f,a,t){if(!t){this._downloadStatusTotal=50;this._progressText.setText(sap.ui.vk.getResourceBundle().getText("PROGRESS_INDICATOR_DOWNLOADING"));}else{var s=a/t*100/this.getNumberOfFiles()/2;this._downloadStatusByFile[f]=s;this._downloadStatusTotal=0;for(var p in this._downloadStatusByFile){if(this._downloadStatusByFile.hasOwnProperty(p)){this._downloadStatusTotal+=this._downloadStatusByFile[p];}}var b=Math.floor(this._downloadStatusTotal+this._renderStatusTotal);this._progressBar.setPercentValue(b);this._progressText.setText(sap.ui.vk.getResourceBundle().getText("PROGRESS_INDICATOR_DOWNLOADING")+b+"%");}return this;};
P.prototype.updateRenderStatus=function(c){if(c<this._renderStatusPreviousUpdate){this._renderStatusFileCounter++;}this._renderStatusPreviousUpdate=c;this._renderStatusTotal=(c+this._renderStatusFileCounter)*100/this.getNumberOfFiles()/2;var b=Math.floor(this._downloadStatusTotal+this._renderStatusTotal);this._progressBar.setPercentValue(b);this._progressText.setText(sap.ui.vk.getResourceBundle().getText("PROGRESS_INDICATOR_RENDERING")+b+"%");return this;};
return P;});
sap.ui.predefine('sap/ui/vk/ProgressIndicatorRenderer',["jquery.sap.global"],function(q){"use strict";var P={};
P.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapUiVizkitProgressIndicator");r.writeClasses();r.write(">");r.renderControl(c.getAggregation("progressText"));r.renderControl(c.getAggregation("progressBar"));r.write("</div>");};
return P;},true);
sap.ui.predefine('sap/ui/vk/RedlineDesign',["jquery.sap.global","./library","sap/ui/core/Control","./RedlineSurface","./RedlineElement","./RedlineGesturesHandler","./RedlineDesignHandler","./Loco"],function(q,l,C,R,a,b,c,L){"use strict";
var d=R.extend("sap.ui.vk.RedlineDesign",{metadata:{library:"sap.ui.vk",events:{elementCreated:{parameters:{element:"object"}}},aggregations:{activeElementInstance:{type:"sap.ui.vk.RedlineElement",multiple:false,visibility:"hidden"}}}});
d.prototype.init=function(){this._isAddingModeActive=false;this._isDrawingOn=false;this._activeElementInstance=null;this.addStyleClass("sapUiVizkitRedlineInteractionMode");this._gestureHandler=new b(this);this._designHandler=new c(this);};
d.prototype.onBeforeRendering=function(){if(this._loco){this._loco.removeHandler(this._gestureHandler);this._loco.removeHandler(this._designHandler);}};
d.prototype.onAfterRendering=function(){var e=this.getDomRef();e.style.width="100%";e.style.height="100%";this._loco=new L();if(this._isAddingModeActive){this._loco.addHandler(this._designHandler);}else{this._loco.addHandler(this._gestureHandler);}this.updatePanningRatio();};
d.prototype._editElement=function(e,o,f){e.edit(o,f);return this;};
d.prototype._getIsDrawingOn=function(){return this._isDrawingOn;};
d.prototype._setIsDrawingOn=function(i){this._isDrawingOn=i;return this;};
d.prototype.startAdding=function(e){this._isAddingModeActive=true;this._activeElementInstance=e;this.setAggregation("activeElementInstance",this._activeElementInstance);this.addStyleClass("sapUiVizkitRedlineDesignMode");this.removeStyleClass("sapUiVizkitRedlineInteractionMode");return this;};
d.prototype.stopAdding=function(){this._isAddingModeActive=false;this._setIsDrawingOn(false);this.setAggregation("activeElementInstance",null);this._activeElementInstance=null;this.addStyleClass("sapUiVizkitRedlineInteractionMode");this.removeStyleClass("sapUiVizkitRedlineDesignMode");return this;};
d.prototype._getOffset=function(o){var r=o.getBoundingClientRect();return{x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};};
return d;});
sap.ui.predefine('sap/ui/vk/RedlineDesignHandler',["jquery.sap.global","sap/ui/base/EventProvider","sap/ui/core/ResizeHandler"],function(q,E,R){"use strict";
var a=E.extend("RedlineDesignHandler",{
metadata:{publicMethods:["beginGesture","move","endGesture","click","doubleClick","contextMenu","getViewport"]},
constructor:function(r){this._redlineDesign=r;this._x=0;this._y=0;this._gesture=false;}
});
a.prototype.destroy=function(){this._redlineDesign=null;this._rect=null;this._gesture=false;};
a.prototype._getOffset=function(d){var r=d.getBoundingClientRect();return{x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};};
a.prototype._inside=function(e,r){var b=r.getDomRef(),i=false;if(b!==null){var c=this._getOffset(b);var d={x:c.x,y:c.y,width:b.getBoundingClientRect().width,height:b.getBoundingClientRect().height};i=(e.x>=d.x&&e.x<=d.x+d.width&&e.y>=d.y&&e.y<=d.y+d.height);}return i;};
a.prototype._onresize=function(e){this._gesture=false;};
a.prototype.beginGesture=function(e){var v=this.getViewport();if(this._inside(e,v)&&v._activeElementInstance){this._gesture=true;this._x=e.x;this._y=e.y;v._setIsDrawingOn(true);var d=v.getDomRef();var t=v._toVirtualSpace(e.x-d.getBoundingClientRect().left-window.pageXOffset,e.y-d.getBoundingClientRect().top-window.pageYOffset);v._activeElementInstance.setOriginX(t.x);v._activeElementInstance.setOriginY(t.y);if(sap.ui.Device.browser.msie||sap.ui.Device.browser.edge){v.invalidate();}else{var r=sap.ui.getCore().createRenderManager();v._activeElementInstance.render(r);r.flush(v.getDomRef(),false,true);r.destroy();var x=v.$();x.html(x.html());}e.handled=true;}return this;};
a.prototype.move=function(e){var v=this.getViewport();if(v._activeElementInstance&&v._getIsDrawingOn()){var b=v.getDomRef().getBoundingClientRect(),o=e.x-b.left-window.pageXOffset,c=e.y-b.top-window.pageYOffset;v._editElement(v._activeElementInstance,o,c);}e.handled=true;return this;};
a.prototype.endGesture=function(e){var v=this.getViewport();this._gesture=false;if(v._activeElementInstance){v.addRedlineElement(v._activeElementInstance);v.fireElementCreated({element:v._activeElementInstance});v.stopAdding();}return this;};
a.prototype.click=function(e){};
a.prototype.doubleClick=function(e){};
a.prototype.contextMenu=function(e){e.handled=true;};
a.prototype.getViewport=function(){return this._redlineDesign;};
return a;},true);
sap.ui.predefine('sap/ui/vk/RedlineDesignRenderer',["jquery.sap.global","./RedlineSurfaceRenderer","sap/ui/core/Renderer"],function(q,R,a){"use strict";var b=a.extend(R);
b.render=function(r,c){R.render.call(this,r,c);};
b.renderAfterRedlineElements=function(r,c){if(c._activeElementInstance&&c._getIsDrawingOn()){c._activeElementInstance.render(r);}};
return b;},true);
sap.ui.predefine('sap/ui/vk/RedlineElement',["jquery.sap.global","sap/ui/core/Element"],function(q,E){"use strict";
var R=E.extend("sap.ui.vk.RedlineElement",{metadata:{library:"sap.ui.vk",properties:{originX:{type:"float",defaultValue:0},originY:{type:"float",defaultValue:0},opacity:{type:"float",defaultValue:1},strokeWidth:{type:"float",defaultValue:2},strokeColor:{type:"sap.ui.core.CSSColor",defaultValue:"#e6600d"}}}});
R.prototype.init=function(){};
R.prototype.onAfterRendering=function(){};
R.prototype.setOriginX=function(o){this.setProperty("originX",o,true);};
R.prototype.setOriginY=function(o){this.setProperty("originY",o,true);};
R.prototype.applyZoom=function(){};
R.prototype.render=function(r){};
R.prototype.exportJSON=function(){return{originX:this.getOriginX(),originY:this.getOriginY(),opacity:this.getOpacity(),strokeColor:this.getStrokeColor(),strokeWidth:this.getStrokeWidth()};};
R.prototype.importJSON=function(j){if(j.hasOwnProperty("originX")){this.setOriginX(j.originX);}if(j.hasOwnProperty("originY")){this.setOriginY(j.originY);}if(j.hasOwnProperty("opacity")){this.setOpacity(j.opacity);}if(j.hasOwnProperty("strokeColor")){this.setStrokeColor(j.strokeColor);}if(j.hasOwnProperty("strokeWidth")){this.setStrokeWidth(j.strokeWidth);}return this;};
return R;});
sap.ui.predefine('sap/ui/vk/RedlineElementEllipse',["jquery.sap.global","./RedlineElement"],function(q,R){"use strict";
var a=R.extend("sap.ui.vk.RedlineElementEllipse",{metadata:{library:"sap.ui.vk",properties:{radiusX:{type:"float",defaultValue:0.0001},radiusY:{type:"float",defaultValue:0.0001},fillColor:{type:"sap.ui.core.CSSColor",defaultValue:"rgba(0, 0, 0, 0)"}}}});
a.prototype.init=function(){};
a.prototype.edit=function(o,b){var p=this.getParent(),t=p._toVirtualSpace(o,b),r=t.x-this.getOriginX(),c=t.y-this.getOriginY(),d=p._toVirtualSpace(1);this.setRadiusX(r>0?r:d);this.setRadiusY(c>0?c:d);return this;};
a.prototype.applyZoom=function(z){this.setProperty("radiusX",this.getRadiusX()*z,true);this.setProperty("radiusY",this.getRadiusY()*z,true);return this;};
a.prototype.setRadiusX=function(r){this.setProperty("radiusX",r,true);var d=this.getDomRef();if(d){d.setAttribute("rx",this.getParent()._toPixelSpace(r));}};
a.prototype.setRadiusY=function(r){this.setProperty("radiusY",r,true);var d=this.getDomRef();if(d){d.setAttribute("ry",this.getParent()._toPixelSpace(r));}};
a.prototype.render=function(r){var p=this.getParent();r.write("<ellipse");r.writeElementData(this);var o=p._toPixelSpace(this.getOriginX(),this.getOriginY());r.writeAttribute("cx",o.x);r.writeAttribute("cy",o.y);r.writeAttribute("rx",p._toPixelSpace(this.getRadiusX()));r.writeAttribute("ry",p._toPixelSpace(this.getRadiusY()));r.writeAttribute("fill",this.getFillColor());r.writeAttribute("stroke",this.getStrokeColor());r.writeAttribute("stroke-width",this.getStrokeWidth());r.writeAttribute("opacity",this.getOpacity());r.write("></ellipse>");};
a.prototype.exportJSON=function(){return q.extend(true,R.prototype.exportJSON.call(this),{type:sap.ui.vk.Redline.ElementType.Ellipse,version:1,radiusX:this.getRadiusX(),radiusY:this.getRadiusY(),fillColor:this.getFillColor()});};
a.prototype.importJSON=function(j){if(j.type===sap.ui.vk.Redline.ElementType.Ellipse){if(j.version===1){R.prototype.importJSON.call(this,j);if(j.hasOwnProperty("radiusX")){this.setRadiusX(j.radiusX);}if(j.hasOwnProperty("radiusY")){this.setRadiusY(j.radiusY);}if(j.hasOwnProperty("fillColor")){this.setFillColor(j.fillColor);}}else{q.sap.log.error("wrong version number");}}else{q.sap.log.error("wrong element type");}return this;};
return a;});
sap.ui.predefine('sap/ui/vk/RedlineElementFreehand',["jquery.sap.global","./RedlineElement"],function(q,R){"use strict";
var a=R.extend("sap.ui.vk.RedlineElementFreehand",{metadata:{library:"sap.ui.vk",properties:{path:{type:"float[]",defaultValue:null}}}});
a.prototype.init=function(){};
a.prototype.setPath=function(p){this.setProperty("path",p,true);var d=this.getDomRef();if(d){d.setAttribute("d",this._getProcessedPath());}};
a.prototype.edit=function(o,b){var p=this.getParent();var t=p._toVirtualSpace(o,b);var c=this.getPath()||[];c.push(t.x-this.getOriginX(),t.y-this.getOriginY());this.setPath(c);var d=this.getDomRef();if(d){d.setAttribute("d",this._getProcessedPath());}return this;};
a.prototype.applyZoom=function(z){this.setProperty("path",this.getPath().map(function(v){return v*z;}),true);return this;};
a.prototype._getProcessedPath=function(){var p=this.getParent(),o=p._toPixelSpace(this.getOriginX(),this.getOriginY());var d="";(this.getPath()||[]).forEach(function(e,i){e=p._toPixelSpace(e);if(i===0){d+="M "+(o.x+e);}else if(i===1){d+=" "+(o.y+e);}else{d+=" "+(i%2===0?"L "+(o.x+e):(o.y+e));}});return d;};
a.prototype.render=function(r){r.write("<path");r.writeElementData(this);r.writeAttribute("d",this._getProcessedPath());r.writeAttribute("stroke",this.getStrokeColor());r.writeAttribute("stroke-width",this.getStrokeWidth());r.writeAttribute("opacity",this.getOpacity());r.writeAttribute("fill","none");r.write("></path>");};
a.prototype.exportJSON=function(){return q.extend(true,R.prototype.exportJSON.call(this),{type:sap.ui.vk.Redline.ElementType.Freehand,version:1,path:(this.getPath()||[]).slice()});};
a.prototype.importJSON=function(j){if(j.type===sap.ui.vk.Redline.ElementType.Freehand){if(j.version===1){R.prototype.importJSON.call(this,j);if(j.hasOwnProperty("path")){this.setPath(j.path.slice());}}else{q.sap.log.error("wrong version number");}}else{q.sap.log.error("wrong element type");}return this;};
return a;});
sap.ui.predefine('sap/ui/vk/RedlineElementRectangle',["jquery.sap.global","./RedlineElement"],function(q,R){"use strict";
var a=R.extend("sap.ui.vk.RedlineElementRectangle",{metadata:{library:"sap.ui.vk",properties:{width:{type:"float",defaultValue:0.001},height:{type:"float",defaultValue:0.001},fillColor:{type:"sap.ui.core.CSSColor",defaultValue:"rgba(0, 0, 0, 0)"}}}});
a.prototype.init=function(){};
a.prototype.edit=function(o,b){var p=this.getParent(),t=p._toVirtualSpace(o,b),w=t.x-this.getOriginX(),h=t.y-this.getOriginY(),c=p._toVirtualSpace(1);this.setWidth(w>0?w:c);this.setHeight(h>0?h:c);return this;};
a.prototype.applyZoom=function(z){this.setProperty("width",this.getWidth()*z,true);this.setProperty("height",this.getHeight()*z,true);return this;};
a.prototype.setWidth=function(w){this.setProperty("width",w,true);var d=this.getDomRef();if(d){d.setAttribute("width",this.getParent()._toPixelSpace(w));}};
a.prototype.setHeight=function(h){this.setProperty("height",h,true);var d=this.getDomRef();if(d){d.setAttribute("height",this.getParent()._toPixelSpace(h));}};
a.prototype.render=function(r){var p=this.getParent();r.write("<rect");r.writeElementData(this);var o=p._toPixelSpace(this.getOriginX(),this.getOriginY());r.writeAttribute("x",o.x);r.writeAttribute("y",o.y);r.writeAttribute("width",p._toPixelSpace(this.getWidth()));r.writeAttribute("height",p._toPixelSpace(this.getHeight()));r.writeAttribute("fill",this.getFillColor());r.writeAttribute("stroke",this.getStrokeColor());r.writeAttribute("stroke-width",this.getStrokeWidth());r.writeAttribute("opacity",this.getOpacity());r.write("></rect>");};
a.prototype.exportJSON=function(){return q.extend(true,R.prototype.exportJSON.call(this),{type:sap.ui.vk.Redline.ElementType.Rectangle,version:1,width:this.getWidth(),height:this.getHeight(),fillColor:this.getFillColor()});};
a.prototype.importJSON=function(j){if(j.type===sap.ui.vk.Redline.ElementType.Rectangle){if(j.version===1){R.prototype.importJSON.call(this,j);if(j.hasOwnProperty("width")){this.setWidth(j.width);}if(j.hasOwnProperty("height")){this.setHeight(j.height);}if(j.hasOwnProperty("fillColor")){this.setFillColor(j.fillColor);}}else{q.sap.log("wrong version number");}}else{q.sap.log("wrong element type");}return this;};
return a;});
sap.ui.predefine('sap/ui/vk/RedlineGesturesHandler',["jquery.sap.global","sap/ui/base/EventProvider","sap/ui/core/ResizeHandler"],function(q,E,R){"use strict";
var a=E.extend("RedlineGesturesHandler",{
metadata:{publicMethods:["beginGesture","move","endGesture","click","doubleClick","contextMenu","getViewport"]},
constructor:function(r){this._redlineDesign=r;this._x=0;this._y=0;this._gesture=false;var v=this.getViewport();v._currentPosition={x:0,y:0};v._totalMoveX=0;v._totalMoveY=0;}
});
a.prototype.destroy=function(){this._redlineDesign=null;this._rect=null;this._gesture=false;};
a.prototype._getOffset=function(d){var r=d.getBoundingClientRect();return{x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};};
a.prototype._inside=function(e,r){var b=r.getDomRef(),i=false;if(b!==null){var c=this._getOffset(b);var d={x:c.x,y:c.y,width:b.getBoundingClientRect().width,height:b.getBoundingClientRect().height};i=(e.x>=d.x&&e.x<=d.x+d.width&&e.y>=d.y&&e.y<=d.y+d.height);}return i;};
a.prototype._onresize=function(e){this._gesture=false;};
a.prototype.beginGesture=function(e){var v=this.getViewport();if(this._inside(e,v)){this._gesture=true;this._x=e.x;this._y=e.y;var o=this._getOffset(v.getDomRef());this._gestureOriginX=e.x-o.x;this._gestureOriginY=e.y-o.y;this._distanceBetweenTouchPoints=null;if(e.n===1){this._lastMoveCoordinates={};this._totalDeltaMove={x:0,y:0};}e.handled=true;}return this;};
a.prototype._pan=function(e){if(this._totalDeltaMove){var v=this.getViewport(),d=e.x-(this._lastMoveCoordinates.x||e.x),b=e.y-(this._lastMoveCoordinates.y||e.y);this._totalDeltaMove.x+=d;this._totalDeltaMove.y+=b;if(d||b){var p=v.getPanningRatio();v.firePan({deltaX:d*p,deltaY:b*p});v.getRedlineElements().forEach(function(c){c.setOriginX(c.getOriginX()+v._toVirtualSpace(d));c.setOriginY(c.getOriginY()+v._toVirtualSpace(b));});this._manualRender(v);}this._lastMoveCoordinates.x=e.x;this._lastMoveCoordinates.y=e.y;}else{this._totalDeltaMove={x:0,y:0};this._lastMoveCoordinates={};}};
a.prototype._zoom=function(e){var v=this.getViewport(),z;if(e.scroll!==undefined){if(e.scroll>0){z=1.05;}else if(e.scroll<0){z=1/1.05;}else if(this._distanceBetweenTouchPoints!==null){var d=e.d-this._distanceBetweenTouchPoints;if(d>0){z=1.05;}else if(d<0){z=1/1.05;}else{return;}this._distanceBetweenTouchPoints=e.d;}else{this._distanceBetweenTouchPoints=e.d;return;}}else if(e.points[0].y<e.points[1].y){z=1.05;}else{z=1/1.05;}var s=1-z,p=v._toVirtualSpace(this._gestureOriginX,this._gestureOriginY);v.getRedlineElements().forEach(function(b){b.applyZoom(z);var o=b.getOriginX(),c=b.getOriginY();o+=(p.x-o)*s;c+=(p.y-c)*s;b.setOriginX(o);b.setOriginY(c);});this._manualRender(v);v.fireZoom({originX:this._gestureOriginX,originY:this._gestureOriginY,zoomFactor:z});};
a.prototype.move=function(e){if(this.getViewport().getDomRef()){if(e.n===2&&(e.buttons===4||e.buttons===3)||e.n===1){this._pan(e);}else if((e.n===2&&e.buttons===2)||(sap.ui.Device.system.tablet&&e.n===2&&e.buttons===0)){this._zoom(e);}}e.handled=true;return this;};
a.prototype._manualRender=function(r){if(sap.ui.Device.browser.msie||sap.ui.Device.browser.edge){r.invalidate();}else{var b=sap.ui.getCore().createRenderManager();r.getRedlineElements().forEach(function(e){e.render(b);});b.flush(r.getDomRef(),false,false);b.destroy();var x=r.$();x.html(x.html());}};
a.prototype.endGesture=function(e){this._gestureOriginX=0;this._gestureOriginY=0;this._lastMoveCoordinates={};this._totalDeltaMove={x:0,y:0};this._gesture=false;e.handled=true;return this;};
a.prototype.click=function(e){};
a.prototype.doubleClick=function(e){};
a.prototype.contextMenu=function(e){e.handled=true;};
a.prototype.getViewport=function(){return this._redlineDesign;};
return a;},true);
sap.ui.predefine('sap/ui/vk/RedlineSurface',["jquery.sap.global","./library","sap/ui/core/Control","./Loco","./RedlineGesturesHandler"],function(q,l,C,L){"use strict";
var R=C.extend("sap.ui.vk.RedlineSurface",{metadata:{library:"sap.ui.vk",aggregations:{redlineElements:{type:"sap.ui.vk.RedlineElement"}},properties:{virtualLeft:{type:"float"},virtualTop:{type:"float"},virtualSideLength:{type:"float"},panningRatio:{type:"float",defaultValue:1}},events:{pan:{parameters:{deltaX:"float",deltaY:"float"}},zoom:{parameters:{originX:"float",originY:"float",zoomFactor:"float"}}}}});
R.prototype.init=function(){};
R.prototype.onAfterRendering=function(){};
R.prototype.exportJSON=function(){return this.getRedlineElements().map(function(e){return e.exportJSON();});};
R.prototype.importJSON=function(j){if(!q.isArray(j)){j=[j];}q.sap.require("sap.ui.vk.RedlineElementRectangle");q.sap.require("sap.ui.vk.RedlineElementEllipse");q.sap.require("sap.ui.vk.RedlineElementFreehand");var v=this.getVirtualLeft(),a=this.getVirtualTop(),b=this.getVirtualSideLength();j.forEach(function(c){var E;switch(c.type){case sap.ui.vk.Redline.ElementType.Rectangle:E=sap.ui.vk.RedlineElementRectangle;break;case sap.ui.vk.Redline.ElementType.Ellipse:E=sap.ui.vk.RedlineElementEllipse;break;case sap.ui.vk.Redline.ElementType.Freehand:E=sap.ui.vk.RedlineElementFreehand;break;default:}this.addRedlineElement(new E().importJSON(c,v,a,b));}.bind(this));return this;};
R.prototype._toVirtualSpace=function(x,y){if(arguments.length===1){return x/this.getVirtualSideLength();}else{return{x:(x-this.getVirtualLeft())/this.getVirtualSideLength(),y:(y-this.getVirtualTop())/this.getVirtualSideLength()};}};
R.prototype._toPixelSpace=function(x,y){if(arguments.length===1){return x*this.getVirtualSideLength();}else{return{x:x*this.getVirtualSideLength()+this.getVirtualLeft(),y:y*this.getVirtualSideLength()+this.getVirtualTop()};}};
R.prototype.setPanningRatio=function(p){this.setProperty("panningRatio",p,true);};
R.prototype.updatePanningRatio=function(){var v=this.getVirtualLeft(),a=this.getVirtualTop(),r=this.getDomRef(),b=r.getBoundingClientRect(),h=b.height,w=b.width,p;if(v===0&&(h<w&&a<0||(h>w&&a>0))){p=h/w;}else{p=1;}this.setPanningRatio(p);return this;};
return R;});
sap.ui.predefine('sap/ui/vk/RedlineSurfaceRenderer',["jquery.sap.global"],function(q){"use strict";var R={};
R.render=function(r,c){r.write("<svg");r.writeControlData(c);r.addClass("sapUiVizkitRedlineSurface");r.writeClasses();r.write(">");c.getRedlineElements().forEach(function(a){a.render(r);});this.renderAfterRedlineElements(r,c);r.write("</svg>");};
R.renderAfterRedlineElements=function(r,c){};
return R;},true);
sap.ui.predefine('sap/ui/vk/Scene',["jquery.sap.global","./library","sap/ui/base/EventProvider","./NodeHierarchy"],function(q,l,E,N){"use strict";var a=q.sap.log;
var S=E.extend("sap.ui.vk.Scene",{
metadata:{publicMethods:["getId","getGraphicsCore","getDefaultNodeHierarchy"]},
constructor:function(g,d){a.debug("sap.ui.vk.Scene.constructor() called.");E.apply(this);this._id=q.sap.uid();this._graphicsCore=g;this._dvlSceneId=d;this._defaultNodeHierarchy=null;}
});
S.prototype.destroy=function(){a.debug("sap.ui.vk.Scene.destroy() called.");if(this._defaultNodeHierarchy){this._defaultNodeHierarchy.destroy();this._defaultNodeHierarchy=null;}this._dvlSceneId=null;this._graphicsCore=null;E.prototype.destroy.apply(this);};
S.prototype.getId=function(){return this._id;};
S.prototype.getGraphicsCore=function(){return this._graphicsCore;};
S.prototype.getDefaultNodeHierarchy=function(){if(!this._defaultNodeHierarchy){this._defaultNodeHierarchy=new N(this);}return this._defaultNodeHierarchy;};
S.prototype._getDvlSceneId=function(){return this._dvlSceneId;};
return S;});
sap.ui.predefine('sap/ui/vk/SceneTree',["jquery.sap.global","./library","sap/ui/core/Control","sap/ui/table/TreeTable","sap/ui/table/Column","sap/ui/model/json/JSONModel","sap/m/Title","./CheckEye","./NodeProxy"],function(q,l,C,T,a,J,b,c,N){"use strict";
var S=C.extend("sap.ui.vk.SceneTree",{metadata:{library:"sap.ui.vk",properties:{},events:{},associations:{},aggregations:{_tree:{type:"sap.ui.table.TreeTable",multiple:false,visibility:"hidden"}}}});
var g=function(i,s){return sap.ui.vk.getResourceBundle().getText(i?"SCENETREE_VISIBILITYSTATEVISIBLE":"SCENETREE_VISIBILITYSTATEHIDDEN");};
S.prototype._createNodeForSceneTree=function(n,d,v){var e=v.getVisibilityState(d);return{name:n,id:d,visible:e,checkEyeTooltip:g(e,this)};};
S.prototype.setScene=function(s,v){if(this._viewStateManager){this._viewStateManager.detachSelectionChanged(this._nodeSelectionChanged,this);this._viewStateManager.detachVisibilityChanged(this._nodeVisibilityChanged,this);}this._scene=s;this._viewStateManager=v;if(this._viewStateManager){this._viewStateManager.attachSelectionChanged(this._nodeSelectionChanged,this);this._viewStateManager.attachVisibilityChanged(this._nodeVisibilityChanged,this);}this.refresh();};
S.prototype.init=function(){if(C.prototype.init){C.prototype.init.apply(this);}var _=new b({text:sap.ui.vk.getResourceBundle().getText("SCENETREE_TITLE"),tooltip:sap.ui.vk.getResourceBundle().getText("SCENETREE_TITLE")});_.onAfterRendering=function(){var $=this.$();$.addClass("sapUiVkTitle");};this._visibilityColumnHeader=new c({checked:true,tooltip:g(true,this),change:function(e){var i=e.getParameters("checked").checked;this.setTooltip(g(i,this));this._toggleVisibilityForAllChildren(this._model.getData(),i);}.bind(this)});this._tree=new T({title:_,columnHeaderHeight:32,columns:[new a({label:sap.ui.vk.getResourceBundle().getText("SCENETREE_NAME"),tooltip:sap.ui.vk.getResourceBundle().getText("SCENETREE_NAME"),template:new sap.m.Text({text:"{name}",maxLines:1,tooltip:"{name}"}),resizable:false}),new a({label:this._visibilityColumnHeader,template:new c({checked:"{visible}",tooltip:"{checkEyeTooltip}"}),width:"2.7em",resizable:false,hAlign:"Center"})],selectionMode:"MultiToggle",selectionBehavior:"RowSelector",visibleRowCountMode:"Auto",expandFirstLevel:false,collapseRecursive:true,rowHeight:32});this.setAggregation("_tree",this._tree,true);this._model=new J();this._tree.setModel(this._model);this._tree.bindRows({path:"/"});this._tree.attachRowSelectionChange(this._nodeSelection.bind(this));this._tree.getBinding("rows").attachChange(this._dataChange.bind(this));this._viewStateManager=null;this._scene=null;this._syncing=false;this._selected={};this._toggled={};this._vsmSelected={};this._forwardTimer=0;this._reverseTimer=0;this._vSyncing=false;this._lastChangeIsExpand=false;this._forwardVTimer=0;this._reverseVTimer=0;this._scrollTimer=0;this._totalNodes=null;};
S.prototype.exit=function(){};
S.prototype.onBeforeRendering=function(){this._tree.setVisible(true);};
S.prototype._pathToNode=function(p,d,t){p=p.substr(1);if(d==undefined){d=this._model.getData();}var n=d;var e=n;var f="";while(p.length>0){var h=p.indexOf("/");if(h>=0){f=p.substr(0,h);p=p.substr(h+1);}else{f=p;p="";}e=n;n=e[f];}if(t!=undefined){e[f]=t;}return n;};
S.prototype._indexToNodeId=function(i){var d=this._tree.getContextByIndex(i);if(d){var n=this._pathToNode(d.sPath,d.oModel.oData);return n.id;}else{return null;}};
S.prototype._deselectHidden=function(){var v=this._vsmSelected;var d=this._viewStateManager;var e=[];var u={};for(var i=0;;i++){var f=this._indexToNodeId(i);if(f==null){break;}if(v.hasOwnProperty(f)){u[f]=true;}}for(var k in v){if(v.hasOwnProperty(k)&&v[k]==true&&!u.hasOwnProperty(k)&&k!=""){e.push(k);v[k]=false;}}if(e.length>0){this._syncing=true;d.setSelectionState(e,false,true);this._syncing=false;}};
S.prototype._nodeSelection=function(e){if(this._tree.getBinding("rows")._aSelectedContexts!=undefined){return;}if(!this._syncing){if(this._forwardTimer>0){clearTimeout(this._forwardTimer);}var p=e.mParameters;var d=p.rowIndices;var f=this._tree.getSelectedIndices();if(d.length>=1&&f.length==1){if(d.indexOf(f[0])!=-1){this._deselectHidden();}}for(var i=0;i<d.length;i++){var h=d[i];if(this._toggled.hasOwnProperty(h)){this._toggled[h]=!this._toggled[h];}else{this._toggled[h]=true;}if(!this._selected.hasOwnProperty(h)){this._selected[h]=false;}}this._forwardTimer=setTimeout(this._resyncSelectionForward.bind(this,d),100);}};
S.prototype._nodeSelectionChanged=function(e){if(!this._syncing){if(this._reverseTimer>0){clearTimeout(this._reverseTimer);}var s=e.mParameters.selected;var d=e.mParameters.unselected;for(var i=0;i<d.length;i++){if(this._vsmSelected[d[i]]!=undefined){delete this._vsmSelected[d[i]];}}for(var j=0;j<s.length;j++){this._vsmSelected[s[j]]=true;}if(s.length==1){this._expandToNode(s[0],this._resyncSelectionReverse.bind(this));}else{this._reverseTimer=setTimeout(this._resyncSelectionReverse.bind(this),100,true);}}};
S.prototype._resyncSelectionForward=function(t){this._forwardTimer=0;if(this._syncing){return false;}this._syncing=true;for(var i in this._selected){if(this._selected.hasOwnProperty(i)){var d=this._indexToNodeId(parseInt(i,10));if(d==null||d==""){continue;}var e=this._selected[i];if(this._toggled[i]){e=!e;}if(t.indexOf(parseInt(i,10))!==-1){this._viewStateManager.setSelectionState(d,e,true);if(!e){var n=this._viewStateManager.getNodeHierarchy();var f=n.getAncestors(d);var p=f[f.length-1];if(this._viewStateManager._selectedNodes.has(p)){this._viewStateManager.setSelectionState(p,false);var s=this._tree.getSelectedIndices();for(var j=0,h=s.length;j<h;j++){var k=s[j];if(p===this._indexToNodeId(k)){this._selected[k]=false;break;}}this._vsmSelected[p]=false;}}}this._selected[i]=e;this._vsmSelected[d]=e;}}this._toggled={};this._syncing=false;};
S.prototype._resyncSelectionReverse=function(s){this._reverseTimer=0;if(this._syncing){return;}this._syncing=true;var v=this._viewStateManager;var t=this._tree;var d=0;this._selected={};for(var i=0;;i++){var e=this._indexToNodeId(i);if(e==null||e==""){break;}var f=v.getSelectionState(e);if(f){this._selected[i]=true;d++;}if(f!=t.isIndexSelected(i)){if(f){t.addSelectionInterval(i,i);}else{t.removeSelectionInterval(i,i);}}}this._syncing=false;};
S.prototype._expandToNode=function(n,d){var t=this._totalNodes;var e=function(o,r){r.forEach(function(u){o=o[u];});return o;};var f=function(o,r,u){var v;if((r<o)||(r>=(o+u))){v=r-(u/2);}else{v=o;}v=v>0?Math.floor(v):0;return v;};var s=function(o,r){var u=o.getVisibleRowCount(),v=o.getFirstVisibleRow(),w=f(v,r,u);if(w!==v){o.setFirstVisibleRow(w);}};var h=function(o,n){var r=null,u;for(var v=0;v<t;v++){u=o.getContextByIndex(v);if(u){var w=u.getPath().split("/");w.shift();var x=u.getModel().getData();if(e(x,w).id===n){r=v;break;}}}return r;};var i=this._scene.getDefaultNodeHierarchy(),j=i.getAncestors(n);var k=function(o,r,j,u){if(u.getParameter("reason")==="expand"){o(r,j);}};var m;var p=function(o,j){setTimeout(function(){if(j.length){var r=j.shift();var u=h(o,r);if(u!==null){o.expand(u);}}else{var v=h(o,n);if(v!==null){s(o,v);o.getBinding("rows").detachChange(m);d();}}},70);};m=k.bind(this,p,this._tree,j);this._tree.getBinding("rows").attachChange(m);p(this._tree,j);};
S.prototype._dataChange=function(e){if(this._viewStateManager==null||this._scene==null||this._vSyncing){return;}if(this._lastChangeIsExpand){this._lastChangeIsExpand=false;return;}if(this._forwardVTimer>0){clearTimeout(this._forwardVTimer);}this._forwardVTimer=setTimeout(this._resyncVisibilityForward.bind(this),100);};
S.prototype._resyncVisibilityForward=function(){if(!this._vSyncing){this._vSyncing=true;this._forwardVTimer=0;this._setNodeVisibilityRecursive(this._model.getData(),this._viewStateManager);this._vSyncing=false;}};
S.prototype._enumerateChildrenIntoArray=function(n,d){var e=this._scene.getDefaultNodeHierarchy();e.enumerateChildren(n,function(p){var i=p.getNodeId();d.push(i);if(p.getHasChildren()){this._enumerateChildrenIntoArray(i,d);}});};
S.prototype._setNodeVisibilityRecursive=function(n,v){if(n.id!=null&&v.getVisibilityState(n.id)!=n.visible){v.setVisibilityState(n.id,n.visible,true);if(n[0]!=undefined){if(this._reverseVTimer>0){clearTimeout(this._reverseVTimer);}this._reverseVTimer=setTimeout(this._resyncVisibilityReverse.bind(this),100);}}else{for(var i=0;n[i]!=null;i++){this._setNodeVisibilityRecursive(n[i],v);}}};
S.prototype._toggleVisibilityForAllChildren=function(n,d){for(var i=0;n[i]!=null;i++){this._viewStateManager.setVisibilityState(n[i].id,d,true);}};
S.prototype._nodeVisibilityChanged=function(e){if(!this._vSyncing){if(this._reverseVTimer>0){clearTimeout(this._reverseVTimer);}this._reverseVTimer=setTimeout(this._resyncVisibilityReverse.bind(this),100);}};
S.prototype._resyncVisibilityReverse=function(){if(!this._vSyncing){this._vSyncing=true;this._forwardVTimer=0;this._getNodeVisibilityRecursive(this._model.getData(),this._viewStateManager);this._tree.getModel().refresh(true);this._vSyncing=false;}};
S.prototype._getNodeVisibilityRecursive=function(n,v){if(n.id!=null){n.visible=v.getVisibilityState(n.id);n.checkEyeTooltip=g(n.visible,this);}for(var i=0;n[i]!=null;i++){this._getNodeVisibilityRecursive(n[i],v);}};
S.prototype.refresh=function(){if(this._scene==null){this._model.setData([]);return;}var n=this._scene.getDefaultNodeHierarchy();var t={};this._totalNodes=0;var d=function(t,e){e.forEach(function(f,i){var h=new N(n,f);var j=this._createNodeForSceneTree(h.getName(),h.getNodeId(),this._viewStateManager);t[i]=j;h.destroy();this._totalNodes++;d.bind(this)(t[i],n.getChildren(f));}.bind(this));};d.bind(this)(t,n.getChildren());this._model.setData(t);this._tree.setModel(this._model);this._tree.bindRows({path:"/"});this._tree.getBinding("rows").attachChange(this._dataChange.bind(this));this._visibilityColumnHeader.setChecked(true);this._visibilityColumnHeader.setTooltip(g(true,this));};
S.prototype.onAfterRendering=function(){};
return S;},true);
sap.ui.predefine('sap/ui/vk/SceneTreeRenderer',["jquery.sap.global"],function(q){"use strict";var S={};
S.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapUiSizeCompact");r.addClass("sapRULTSceneTree");r.writeClasses();r.write(">");r.renderControl(c.getAggregation("_tree"));r.write("</div>");};
return S;},true);
sap.ui.predefine('sap/ui/vk/Smart2DHandler',["jquery.sap.global","sap/ui/base/EventProvider","sap/ui/core/ResizeHandler"],function(q,E,R){"use strict";
var S=E.extend("Smart2DHandler",{
metadata:{publicMethods:["beginGesture","move","endGesture","click","doubleClick","contextMenu","getViewport"]},
constructor:function(v,a){this._viewport=v;this._rect=null;this._x=0;this._y=0;this._gesture=false;this._hitEndTimer=0;this._lastRender=0;this._viewport.attachEvent("resize",this,this._onresize);this._viewStateManager=a;this._previousColoring={nodeId:null,color:null};}
});
S.prototype.destroy=function(){this._viewport=null;this._rect=null;this._gesture=false;this._viewport.detachEvent("resize",this,this._onresize);this._viewStateManager=null;this._previousColoring=null;};
S.prototype._getOffset=function(d){var r=d.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};
S.prototype._inside=function(e){var v=this._viewport.getDomRef();if(v==null){return false;}var a=this._getOffset(v);this._rect={x:a.x,y:a.y,w:v.offsetWidth,h:v.offsetHeight};return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};
S.prototype._onresize=function(e){this._gesture=false;this._rect=null;};
S.prototype.beginGesture=function(e){if(this._inside(e)){this._gesture=true;this._x=e.x;this._y=e.y;}};
S.prototype.callbackHover=function(){var n=this._viewStateManager.getNodeHierarchy();this._lastRender=Date.now();this._hitEndTimer=0;var h=this._viewport.hitTest(this._x,this._y);if(this._highlightedNodeId!==h){if(this._highlightedNodeId!==sap.ve.dvl.DVLID_INVALID){var t=this._highlightedNodeId===this._previousColoring.nodeId?this._previousColoring.color:0;this._viewport.showHotspots(this._highlightedNodeId,true,t);}if(n.getHotspotNodeIds().indexOf(h)!==-1){var a=n.createNodeProxy(h);this._previousColoring={nodeId:h,color:a.getTintColorABGR()};n.destroyNodeProxy(a);this._viewport.showHotspots(h,true);}this._highlightedNodeId=h;}this._viewport.renderFrame();};
S.prototype.hover=function(e){if(e.n==1&&this._inside(e)){this._x=e.x-this._rect.x;this._y=e.y-this._rect.y;if(!this.getViewport().getShowAllHotspots()){var t=Date.now();if(t-this._lastRender>20){this.callbackHover();}if(this._hitEndTimer!=0){clearTimeout(this._hitEndTimer);}this._hitEndTimer=setTimeout(this.callbackHover.bind(this),20);}e.handled=true;}};
S.prototype.move=function(e){if(this._gesture&&e.n==1){this._viewport.pan(e.x-this._x,e.y-this._y);this._x=e.x;this._y=e.y;e.handled=true;}};
S.prototype.endGesture=function(e){this._gesture=false;};
S.prototype.click=function(e){};
S.prototype.doubleClick=function(e){};
S.prototype.contextMenu=function(e){};
S.prototype.getViewport=function(){return this._viewport;};
return S;},true);
sap.ui.predefine('sap/ui/vk/StepNavigation',["jquery.sap.global","./library","sap/ui/core/Control","sap/ui/core/ResizeHandler","./Loco","./ViewportHandler","sap/ui/core/Popup","sap/ui/core/IconPool","./Messages","./DvlException"],function(q,l,C,R,L,V,P,I,M,D){"use strict";
var S=C.extend("sap.ui.vk.StepNavigation",{metadata:{library:"sap.ui.vk",properties:{settings:"object",width:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},showThumbnails:{type:"boolean",group:"Appearance",defaultValue:true},showToolbar:{type:"boolean",group:"Appearance",defaultValue:true},showStepInfo:{type:"boolean",group:"Appearance",defaultValue:false}},publicMethods:["setGraphicsCore","setScene","playStep","pauseStep","playAllSteps","getStep","getNextStep","getPreviousStep","getProceduresAndSteps","refresh","clear"],associations:{},aggregations:{procedureItemTemplate:{type:"sap.ui.core.Item",multiple:false},stepInfoPopup:{type:"sap.ui.core.Control",multiple:false},layout:{type:"sap.m.Toolbar",multiple:false},thumbnailsContainer:{type:"sap.m.Panel",multiple:false}},events:{"resize":{parameters:{oldSize:"object",size:"object"}},"stepChanged":{parameters:{clientId:"object",type:"object",stepId:"object"}}}}});
S.prototype.setGraphicsCore=function(g){if(g!=this._graphicsCore){if(this._graphicsCore){var o=this._graphicsCore.getApi(sap.ui.vk.GraphicsCoreApi.LegacyDvl);if(o){o.Client.detachStepEvent(this._onStepEvent,this);}}this._graphicsCore=g;}this.instanceSettings={};if(this._graphicsCore){this.oDvl=this._graphicsCore.getApi(sap.ui.vk.GraphicsCoreApi.LegacyDvl);if(this.oDvl){this.oDvl.Client.attachStepEvent(this._onStepEvent,this);}}return this;};
S.prototype._onStepEvent=function(p){var s=this.getSettings();this.instanceSettings.currentStepId=p.stepId;switch(p.type){case sap.ve.dvl.DVLSTEPEVENT.DVLSTEPEVENT_FINISHED:s.currentStepFinished=true;s.currentStepPaused=false;s.playAllActive=false;s.isPlaying=false;this._togglePlayPause(true);break;case sap.ve.dvl.DVLSTEPEVENT.DVLSTEPEVENT_SWITCHED:case sap.ve.dvl.DVLSTEPEVENT.DVLSTEPEVENT_STARTED:s.currentStepId=p.stepId;s.currentStepFinished=false;this._highlightStep(p.stepId);if(s.currentStepPaused){this.pauseStep();}break;default:q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT12.summary),M.VIT12.code,"sap.ui.vk.StepNavigation");}this.fireStepChanged({clientId:p.clientId,type:p.type,stepId:p.stepId});};
S.prototype.hasGraphicsCore=function(){if(this._graphicsCore){return true;}return false;};
S.prototype.setScene=function(s){this._scene=s;if(this["_getStepThumbnails"]){if(!this._graphicsCore){this.setGraphicsCore(this._scene.getGraphicsCore());}delete this._procedures;var p=this.getProcedureList();var o=this.getSettings();o.reset();p.unbindItems();p.setSelectedItem(p.getFirstItem());if(o.stepInfo.stepMessagePopup){if(!o.stepInfo.stepMessagePopup.isOpen()){o.stepInfo.stepMessagePopup.close();}o.stepInfo.stepMessagePopup.destroy();o.stepInfo.stepMessagePopup=null;this.getShowStepInfoButton().setText(sap.ui.vk.getResourceBundle().getText("STEP_NAV_STEPDESCRIPTIONHEADING"));}var a=this._getStepThumbnails();this.oModel.setData(a);this._togglePlayPause(true);this._refreshControl();}this.refresh();};
S.prototype.init=function(){if(C.prototype.init){C.prototype.init.call(this);}if(this.getSettings()==undefined){this.setSettings(new this._settings());}this._graphicsCore=null;this.oModel=new sap.ui.model.json.JSONModel();this._layout=new sap.m.Toolbar({design:sap.m.ToolbarDesign.Solid});this.setAggregation("layout",this._layout);if(this.getShowThumbnails()){this._thumbnailsScroller=new sap.m.ScrollContainer(this.getId()+"-scroller",{width:"100%",horizontal:true,vertical:false,focusable:true});this._thumbnailsContainer=new sap.m.Panel({expandable:false,content:[this._thumbnailsScroller]});this.setAggregation("thumbnailsContainer",this._thumbnailsContainer);}this.playPreviousButton=new sap.m.Button(this.getId()+"-playPreviousButton",{type:sap.m.ButtonType.Transparent,icon:"sap-icon://slim-arrow-left",tooltip:sap.ui.vk.getResourceBundle().getText("STEP_NAV_PREVIOUSSTEPBUTTON"),visible:true,press:function(e){var s=this.getSettings();var p=this.getPreviousStep(s.currentProcedureIndex);if(p){s.currentStepPaused=false;this.playStep(p.id,true,s.playAllActive);this._togglePlayPause(false);}}.bind(this)});this.playNextButton=new sap.m.Button(this.getId()+"-playNextButton",{type:sap.m.ButtonType.Transparent,icon:"sap-icon://slim-arrow-right",tooltip:sap.ui.vk.getResourceBundle().getText("STEP_NAV_NEXTSTEPBUTTON"),visible:true,press:function(e){var s=this.getSettings();var n=this.getNextStep(s.currentProcedureIndex);if(n){s.currentStepPaused=false;this.playStep(n.id,true,s.playAllActive);this._togglePlayPause(false);}}.bind(this)});this.playOptionButton=new sap.m.Button(this.getId()+"-playOptionButton",{type:sap.m.ButtonType.Transparent,icon:"sap-icon://media-play",tooltip:sap.ui.vk.getResourceBundle().getText("STEP_NAV_PLAYBUTTON_PLAY"),visible:true,press:function(e){var k=this.getPlayMenuButton().getSelectedKey();var s=this.getSettings();var f=null;switch(k){case"0":if(!s.currentStepId){f=this.getNextStep(s.currentProcedureIndex);if(f){s.currentStepId=f.id;}else{return;}}s.playAllActive=false;this.playStep(s.currentStepId,!s.currentStepPaused,s.playAllActive);s.isPlaying=true;s.currentStepPaused=false;this._togglePlayPause(false);break;case"1":s.playAllActive=true;s.currentStepPaused=false;this.playAllSteps(s.currentProcedureId);s.isPlaying=true;this._togglePlayPause(false);break;case"2":if(!s.currentStepId){f=this.getNextStep(s.currentProcedureIndex);if(f){s.currentStepId=f.id;}else{return;}}s.playAllActive=true;var p=!s.currentStepPaused;s.currentStepPaused=false;this.playStep(s.currentStepId,p,s.playAllActive);s.isPlaying=true;this._togglePlayPause(false);break;default:break;}}.bind(this)});this.procedureList=new sap.m.Select(this.getId()+"-procedureList",{tooltip:sap.ui.vk.getResourceBundle().getText("STEP_NAV_PROCEDURESLISTHEADING"),selectedKey:"0",type:sap.m.SelectType.Default,enabled:true,width:"30%",autoAdjustWidth:true,change:function(c){var p=this.getProcedureList();var s=this.getSettings();s.currentProcedureIndex=0;s.currentProcedureId=this.instanceSettings.currentProcedureId=p.getSelectedKey();s.currentStepId=this.instanceSettings.currentStepId=null;for(var i=0;i<this.oModel.oData.procedures.length;i++){if(this.oModel.oData.procedures[i].id==s.currentProcedureId){s.currentProcedureIndex=i;s.currentProcedure=this.oModel.oData.procedures[i];break;}}if(s.stepInfo.stepMessagePopup){if(!s.stepInfo.stepMessagePopup.isOpen()){s.stepInfo.stepMessagePopup.close();}s.stepInfo.stepMessagePopup.destroy();s.stepInfo.stepMessagePopup=null;}this._refreshItems();}.bind(this)});this.procedureList.addStyleClass("sapVizKitStepNavigationProcedureList");this.setAggregation("procedureItemTemplate",(new sap.ui.core.ListItem().bindProperty("text","name").bindProperty("key","id").bindProperty("tooltip","name")));this.playMenuButton=(new sap.m.Select(this.getId()+"-playMenuButtonIcon",{selectedKey:"0",type:sap.m.SelectType.Default,tooltip:sap.ui.vk.getResourceBundle().getText("STEP_NAV_PLAYMENU_PLAYOPTIONS"),enabled:true,autoAdjustWidth:false,items:[new sap.ui.core.ListItem({key:"0",icon:"sap-icon://media-play",text:sap.ui.vk.getResourceBundle().getText("STEP_NAV_PLAYMENU_PLAY"),tooltip:sap.ui.vk.getResourceBundle().getText("STEP_NAV_PLAYMENU_PLAY")}),new sap.ui.core.ListItem({key:"1",icon:"sap-icon://media-play",text:sap.ui.vk.getResourceBundle().getText("STEP_NAV_PLAYMENU_PLAYALL"),tooltip:sap.ui.vk.getResourceBundle().getText("STEP_NAV_PLAYMENU_PLAYALL")}),new sap.ui.core.ListItem({key:"2",icon:"sap-icon://media-play",text:sap.ui.vk.getResourceBundle().getText("STEP_NAV_PLAYMENU_PLAYALLREMAINING"),tooltip:sap.ui.vk.getResourceBundle().getText("STEP_NAV_PLAYMENU_PLAYALLREMAINING")})]}));this.playMenuButton.addStyleClass("sapVizKitStepNavigationPlayOptionsSelect");this.pauseButton=new sap.m.Button(this.getId()+"-pauseButton",{type:sap.m.ButtonType.Transparent,icon:"sap-icon://media-pause",visible:false,tooltip:sap.ui.vk.getResourceBundle().getText("STEP_NAV_PLAYMENU_PAUSE"),press:function(e){var s=this.getSettings();this.pauseStep();s.currentStepPaused=true;s.isPlaying=false;this._togglePlayPause(true);}.bind(this)});this.showStepInfoButton=new sap.m.ToggleButton(this.getId()+"-showStepInfoButton",{icon:"sap-icon://hide",type:sap.m.ButtonType.Transparent,pressed:false,text:sap.ui.vk.getResourceBundle().getText("STEP_NAV_STEPDESCRIPTIONHEADING"),tooltip:sap.ui.vk.getResourceBundle().getText("STEP_NAV_STEPDESCRIPTIONHEADING"),press:function(e){var t=e.getSource();if(t.getPressed()){this.setShowStepInfo(true);t.setIcon("sap-icon://show");t.setTooltip(sap.ui.vk.getResourceBundle().getText("STEP_NAV_HIDESTEPDESCRIPTIONBUTTON"));}else{this.setShowStepInfo(false);t.setIcon("sap-icon://hide");t.setTooltip(sap.ui.vk.getResourceBundle().getText("STEP_NAV_SHOWSTEPDESCRIPTIONBUTTON"));}}.bind(this)});this._layout.addContent(this.playPreviousButton);this._layout.addContent(this.playOptionButton);this._layout.addContent(this.pauseButton);this._layout.addContent(this.playMenuButton);this._layout.addContent(this.procedureList);this._layout.addContent(this.showStepInfoButton);this._layout.addContent(new sap.m.ToolbarSpacer());this._layout.addContent(this.playNextButton);};
S.prototype.destroy=function(){this.setGraphicsCore(null);return C.prototype.destroy.call(this);};
S.prototype.getScroller=function(){return this._thumbnailsScroller;};
S.prototype.getProcedureList=function(){var i=this.getId()+"-procedureList";var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};
S.prototype.getPlayMenuButton=function(){var i=this.getId()+"-playMenuButtonIcon";var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};
S.prototype.getPlayOptionButton=function(){var i=this.getId()+"-playOptionButton";var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};
S.prototype.getPauseButton=function(){var i=this.getId()+"-pauseButton";var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};
S.prototype.getPlayNextButton=function(){var i=this.getId()+"-playNextButton";var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};
S.prototype.getPlayPreviousButton=function(){var i=this.getId()+"-playPreviousButton";var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};
S.prototype.getShowStepInfoButton=function(){var i=this.getId()+"-showStepInfoButton";var h=this._layout;var c=sap.ui.getCore().byId(i);return h.getContent()[h.indexOfContent(c)];};
S.prototype.exit=function(){if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}if(C.prototype.exit){C.prototype.exit.apply(this);}};
S.prototype._settings=function(){return{enabled:false,toggle:{addCss:function(k,p,o,a){if(!this.targets[k]){this.targets[k]={"type":"css","property":p,"onValue":o,"offValue":a};}},addMethod:function(t,m,o,a,u){var k=t.getId();if(!this.targets[k]){this.targets[k]={"type":"method","target":t,"method":m,"onValue":o,"offValue":a,"useJQuery":u};}},targets:{}},currentProcedureIndex:0,currentProcedureId:"",currentProcedure:null,currentStepId:null,currentStep:null,currentStepPaused:false,isPlaying:false,currentStepFinished:true,playAllActive:false,showToolbar:true,showThumbnails:true,portfolioMode:false,reset:function(){this.currentStep=null;this.currentProcedure=null;this.currentProcedureIndex=0;this.currentProcedureId="";this.currentStepId=null;this.currentStepPaused=false;this.currentStepFinished=true;this.playAllActive=false;this.portfolioMode=false;},stepInfo:{lastTop:null,lastLeft:null,stepMessagePopup:null,openPopup:function(p,t,a,b){this._customHeaderText=this._customHeaderText||new sap.m.Text({width:"100%",textAlign:sap.ui.core.TextAlign.Center}).addStyleClass("sapVizKitStepNavigationPopoverTitle");this._customHeaderText.setText(p);this._customHeaderText.setTooltip(p);this._customHeader=this._customHeader||new sap.m.Bar({contentLeft:[this._customHeaderText]});this._textContent=this._textContent||new sap.m.Text({});this._textContent.addStyleClass("sapVizKitStepNavigationPopoverContent");this._textContent.setText(t);this.stepMessagePopup=this.stepMessagePopup||new sap.m.ResponsivePopover({placement:b,showCloseButton:true,verticalScrolling:true,contentHeight:"10%",contentWidth:"30%",content:[this._textContent],customHeader:this._customHeader});this.stepMessagePopup.addStyleClass("sapVizKitStepNavigationPopoverStepInfo");this.stepMessagePopup.openBy(a);}}};};
S.prototype.refresh=function(s){q.sap.log.info("StepNavigation refresh() called.");if(this.getVisible()&&(this["_getStepThumbnails"]&&this._scene!=null)){var p=this.getProcedureList();var o=this.getSettings();o.reset();p.setSelectedItem(p.getFirstItem());var a=this._getStepThumbnails();if(o.stepInfo.stepMessagePopup){if(!o.stepInfo.stepMessagePopup.isOpen()){o.stepInfo.stepMessagePopup.close();}o.stepInfo.stepMessagePopup.destroy();o.stepInfo.stepMessagePopup=null;}this.oModel.setData(a);this._togglePlayPause(true);this._refreshControl();}else if(this.getVisible()){this._refreshControl();}return true;};
S.prototype.clear=function(){q.sap.log.info("StepNavigation clear() called.");return true;};
S.prototype.onBeforeRendering=function(){if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}if(this.getShowToolbar()){var p=this.getProcedureList();p.setModel(this.oModel);var o=this.getProcedureItemTemplate();p.bindItems("/procedures",o);}};
S.prototype.onAfterRendering=function(){if(this._canvas){var a=this.getDomRef();a.appendChild(this._canvas);this._resizeListenerId=R.register(this,this._handleResize.bind(this));this._bestFit();this.fireResize({size:{width:a.clientWidth,height:a.clientHeight}});}var s=this.getSettings();this._togglePlayPause(!s.isPlaying);if(s.currentStepId){this._highlightStep(s.currentStepId);}};
S.prototype._handleResize=function(e){this.fireResize({oldSize:e.oldSize,size:e.size});this._update();};
S.prototype._reset=function(){this._x=0;this._y=0;this._s=1.0;this._r=0;};
S.prototype._update=function(){var x=this._x-(this._imageW-this._canvas.clientWidth)/2;var y=this._y-(this._imageH-this._canvas.clientHeight)/2;var t="matrix("+this._s+",0,0,"+this._s+","+x+","+y+")";this._img.style.transform=t;this._img.style.webkitTransform=t;this._img.style.msTransform=t;this._img.style.MozTransform=t;this._img.style.OTransform=t;};
S.prototype._bestFit=function(){this._reset();var s=this._canvas.clientWidth/this._img.width;var a=this._canvas.clientHeight/this._img.height;this._s=s<a?s:a;if(this._s==0){this._s=1.0;}this._x=0;this._y=0;this._update();};
var d={onAfterRendering:function(e){e.srcControl.focus();e.srcControl.removeEventDelegate(this);}};
S.prototype._togglePlayPause=function(p){this.togglePlayPauseActive=true;if(this.getSettings().showToolbar){var a=this.getPlayOptionButton(),b=this.getPauseButton();if(p){if(sap.ui.getCore().getCurrentFocusedControlId()===b.getId()){a.addEventDelegate(d);}b.setVisible(false);a.setVisible(true);}else{if(sap.ui.getCore().getCurrentFocusedControlId()===a.getId()){b.addEventDelegate(d);}a.setVisible(false);b.setVisible(true);}}};
S.prototype._refreshControl=function(){var p=this.getProcedureList();var o=this.getProcedureItemTemplate();var s=this.getSettings();if(s.stepInfo.stepMessagePopup){if(!s.stepInfo.stepMessagePopup.isOpen()){s.stepInfo.stepMessagePopup.close();}s.stepInfo.stepMessagePopup.destroy();s.stepInfo.stepMessagePopup=null;this.getShowStepInfoButton().setText(sap.ui.vk.getResourceBundle().getText("STEP_NAV_STEPDESCRIPTIONHEADING"));}p.unbindItems();if(this.oModel.oData.procedures.length>0){var f=this.oModel.oData.procedures[0];if(this.getShowToolbar()){p.bindItems("/procedures",o);p.selectedKey=f.id;p.enabled=true;}this._refreshItems();}else{if(this.getShowToolbar()){p.bindItems("/procedures",o);p.enabled=false;}if(this.getShowThumbnails()){var a=this.getScroller();a.destroyContent();}}};
S.prototype._refreshItems=function(){var t=this;var s=[];var p=this.getProcedureList();var o=t.getSettings();var a=new sap.m.HBox();if(!o.currentProcedure){o.currentProcedure=t.oModel.oData.procedures[o.currentProcedureIndex];p.setSelectedItem(p.getFirstItem());}if(o.currentProcedureId!=""||t.oModel.oData.procedures.length>0){if(t.getShowThumbnails()){var b=t.getScroller();b.removeAllContent();s=t.oModel.oData.procedures[o.currentProcedureIndex].steps;var c=function(f){o.currentStepPaused=false;var g=sap.ui.getCore().byId(f.getSource().getId());t.playStep(g.getCustomData()[0].getValue("stepId"));o.playAllActive=false;t._togglePlayPause(false);};for(var i=0;i<s.length;i++){var e=new sap.m.Image({alt:s[i].name,src:"data:image/"+s[i].thumbnailType+";base64,"+s[i].thumbnailData,densityAware:false,tooltip:s[i].name,press:c.bind(t),layoutData:new sap.m.FlexItemData({shrinkFactor:0})});e.data("stepId",s[i].id);e.addCustomData(new sap.ui.core.CustomData({key:"stepId",value:s[i].id}));e.addStyleClass("sapVizKitStepNavigationStepItem");a.addItem(e);}b.addContent(a);}}};
S.prototype._getPopupPlacement=function(e){var p=null;var y=0;while(e){y+=e.offsetTop;e=e.offsetParent;}if(y>200){p=sap.m.PlacementType.Top;}else{p=sap.m.PlacementType.Bottom;}return p;};
S.prototype._isScrollingNecessary=function(i,s){var a;if(i&&s){var b=q(i).offset().left+q(i).width();var t=q(s).width();if(b-q(i).width()<0){a=true;}else if((t-b)<q(i).width()){a=true;}else{a=false;}}else{a=false;}return a;};
S.prototype._scrollToItem=function(i,s){var p={},o=q(i).offset(),c=q(s).scrollLeft();p.scrollLeft=o.left+(c-q(s).offset().left);p.scrollLeft-=parseInt(q(i).css("marginLeft"),10)||0;p.scrollLeft-=parseInt(q(i).css("borderLeftWidth"),10)||0;q(s).animate(p,50);};
S.prototype._highlightStep=function(s){var t=this;if(t.getVisible()){var o=t.getSettings();var a=t.getStep(0,o.currentProcedureIndex,s);if(!o.currentProcedure){o.currentProcedure=t.oModel.oData.procedures[t.oSettings.currentProcedureIndex];}var b=t.getShowStepInfoButton();var p;var c=document.getElementById(b.getId());p=t._getPopupPlacement(c);if(t.getShowStepInfo()){o.stepInfo.openPopup.call(this,a.name,a.description,b,p);}else if(o.stepInfo.stepMessagePopup&&o.stepInfo.stepMessagePopup.isOpen()){o.stepInfo.stepMessagePopup.close();}if(t.getShowThumbnails()){var e=t.getScroller();var T=e.getContent()[0].getItems();for(var i=0;i<T.length;i++){if(T[i].getCustomData()[0].getValue("stepId")==s){T[i].addStyleClass("selected");if(t._isScrollingNecessary(T[i].$()[0],q("#"+e.sId)[0])){t._scrollToItem(T[i].$()[0],q("#"+e.sId)[0]);}}else{T[i].removeStyleClass("selected");}}}}};
S.prototype.getProceduresAndSteps=function(){return this._getStepThumbnails();};
S.prototype._getStepThumbnails=function(){var p=function(s,b,c){var t,i,e;try{t=sap.ui.vk.dvl.getPointer(b.Scene.RetrieveThumbnail(s,c.id));e=t.substring(0,3);if(e==="iVB"){i="png";}else{i="jpg";}c.thumbnailData=t;c.thumbnailType=i;}catch(f){if(f.code!==sap.ve.dvl.DVLRESULT.NOTFOUND){q.sap.log.error(f.message,f.code,"sap.ui.vk.StepNavigation");}c.thumbnailData=null;c.thumbnailType=null;}};var a=this._retrieveProcedures();if(a.sceneId!=null){a.procedures.forEach(function(b){b.steps.forEach(p.bind(this,a.sceneId,this.oDvl));},this);a.portfolios.forEach(function(b){b.steps.forEach(p.bind(this,a.sceneId,this.oDvl));},this);a.hasThumbnails=true;}this._procedures=a;return a;};
S.prototype._retrieveProcedures=function(a){var t=this;var p={};if(!t._procedures){p={sceneId:null,hasThumbnails:false,"procedures":[],"portfolios":[]};}else{p=t._procedures;}if(t._scene&&(p.sceneId!=(a||t._scene._dvlSceneId))){var s=a||t._scene._dvlSceneId;if(s!=null){p={sceneId:null,hasThumbnails:false,"procedures":[],"portfolios":[]};try{var b=sap.ui.vk.dvl.getJSONObject(t.oDvl.Scene.RetrieveProcedures(s));if(b!=null){p.hasThumbnails=false;p.sceneId=t._scene._dvlSceneId;p.procedures=b.procedures;p.portfolios=b.portfolios;}}catch(e){if(!(e instanceof D&&e.code===sap.ve.dvl.DVLRESULT.NOTIMPLEMENTED)){throw e;}}}}return p;};
S.prototype.getStep=function(r,a,s){var t=this;var b=t.oDvl.Settings.LastLoadedSceneId;var c=null;if(b!=null){a=a!=null?a:0;var e=s?s:t.instanceSettings.currentStepId;var p=t._retrieveProcedures(b);var f=p.procedures[a];if(f&&f.steps.length>0){c=f.steps[0];}else{return null;}if(e!=""){for(var g=0;g<f.steps.length;g++){var _=f.steps[g];if(_.id==e){var x=g+r;if(x<f.steps.length&&x>=0){c=f.steps[x];}else{c=null;}break;}}}}return c;};
S.prototype.pauseStep=function(){var t=this;var s=t.oDvl.Settings.LastLoadedSceneId;if(s!=null){t.oDvl.Scene.PauseCurrentStep(s);}};
S.prototype._stepCount=function(a){var t=this;var s=t.oDvl.Settings.LastLoadedSceneId;var b=0;if(s!=null){var p=t._retrieveProcedures(s);for(var c=0;c<p.procedures.length;c++){if(p.procedures[c].id==a){b=p.procedures[c].steps.length;break;}else if(a==null){b+=p.procedures[c].steps.length;}}}return b;};
S.prototype.getPreviousStep=function(p){var t=this;return t.getStep(-1,p);};
S.prototype.getNextStep=function(p){var t=this;return t.getStep(1,p);};
S.prototype.playStep=function(a,f,c){var t=this;var s=t.oDvl.Settings.LastLoadedSceneId;if(s!=null){t.instanceSettings.currentStepId=a;t.oDvl.Scene.ActivateStep(s,a,f!=null?f:true,c!=null?c:false);}};
S.prototype.playAllSteps=function(p){var t=this;var a=t.oDvl.Settings.LastLoadedSceneId;if(a!=null){var b=t._retrieveProcedures(a);var c=0;if(p!=null&&b.procedures.length>1){for(var i=0;i<b.procedures.length;i++){if(b.procedures[i].id==p){c=i;break;}}}if(b.procedures.length>0){var s=b.procedures[c].steps[0];if(s){t.instanceSettings.currentStepId=s.id;t.oDvl.Scene.ActivateStep(a,s.id,true,true);}}}};
return S;});
sap.ui.predefine('sap/ui/vk/StepNavigationRenderer',["jquery.sap.global"],function(q){"use strict";var S={};
S.render=function(r,c){if(!c.getVisible()){return;}if(c.getShowToolbar()||c.getShowThumbnails){var w=c.getWidth()!=="auto"?c.getWidth():"100%";var h=c.getHeight()!=="auto"?c.getHeight():"auto";r.write("<div");r.addStyle("width",w);r.addStyle("height",h);r.writeControlData(c);r.addClass("sapVizKitStepNavigation");r.writeClasses();var t=c.getTooltip_AsString();if(t){r.writeAttributeEscaped("title",t);}if(!c.getVisible()){r.addStyle("visibility","hidden");}r.writeStyles();r.write(">");r.renderControl(c.getAggregation("layout"));if(c.getShowThumbnails()){S._renderScrollerDiv(r,c);}r.write("</div>");}};
S._renderScrollerDiv=function(r,c){r.renderControl(c.getAggregation("thumbnailsContainer"));};
return S;},true);
sap.ui.predefine('sap/ui/vk/Toolbar',["jquery.sap.global","./library","sap/ui/core/Control","sap/ui/model/json/JSONModel"],function(q,l,C,J){"use strict";
var T=C.extend("sap.ui.vk.Toolbar",{metadata:{library:"sap.ui.vk",properties:{title:{type:"string",group:"Appearance",defaultValue:""}},events:{},associations:{viewer:{type:"sap.ui.vk.Viewer",cardinality:"0..1"}},aggregations:{_toolbar:{type:"sap.m.Toolbar",multiple:false,visibility:"hidden"},_helpButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_stepNavigationButton:{type:"sap.m.ToggleButton",multiple:false,visibility:"hidden"},_sceneTreeButton:{type:"sap.m.ToggleButton",multiple:false,visibility:"hidden"},_enterFullScreenButton:{type:"sap.m.ToggleButton",multiple:false,visibility:"hidden"},_exitFullScreenButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_toolbarTitle:{type:"sap.m.Title",multiple:false,visibility:"hidden"}}}});
T.prototype._isUsingIOS=function(){return(sap.ui.Device.system.tablet||sap.ui.Device.system.phone)&&sap.ui.Device.os.ios;};
T.prototype._onSceneTree=function(){this.oViewer=sap.ui.getCore().byId(this.getViewer());if(this.oViewer!=null){this.oViewer._componentsState.sceneTree.userInteractionShow=this._sceneTreeButton.getPressed();this.oViewer.setShowSceneTree(this.oViewer._componentsState.sceneTree.userInteractionShow);}};
T.prototype._onStepNavigation=function(){this.oViewer=sap.ui.getCore().byId(this.getViewer());if(this.oViewer!=null){this.oViewer._componentsState.stepNavigation.userInteractionShow=this._stepNavigationButton.getPressed();this.oViewer.setShowStepNavigation(this.oViewer._componentsState.stepNavigation.userInteractionShow);}};
T.prototype._onFullScreen=function(){this.oViewer=sap.ui.getCore().byId(this.getViewer());if(this.oViewer!=null){var n=this._enterFullScreenButton.getPressed();this.oViewer.activateFullScreenMode(n);}};
T.prototype._fullScreenHandler=function(e){var f=e.mParameters.isFullScreen;this._enterFullScreenButton.setPressed(f);if(f){this._enterFullScreenButton.setIcon("sap-icon://exit-full-screen");}else{this._enterFullScreenButton.setIcon("sap-icon://full-screen");}};
T.prototype.init=function(){if(C.prototype.init){C.prototype.init.apply(this);}var _=new sap.m.ToolbarSpacer();var a=new sap.m.Button({icon:"sap-icon://sys-help",type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText("VIEWER_HELPBUTTONTOOLTIP")});this.setAggregation("_helpButton",a);this._stepNavigationButton=new sap.m.ToggleButton({icon:"sap-icon://step",type:sap.m.ButtonType.Transparent,enabled:false,tooltip:sap.ui.vk.getResourceBundle().getText("STEP_NAV_MENUBUTTONTOOLTIP"),press:this._onStepNavigation.bind(this)});this.setAggregation("_stepNavigationButton",this._stepNavigationButton);this._sceneTreeButton=new sap.m.ToggleButton({icon:"sap-icon://tree",type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText("SCENETREE_MENUBUTTONTOOLTIP"),press:this._onSceneTree.bind(this)});this.setAggregation("_sceneTreeButton",this._sceneTreeButton);var t;this._toolbarTitle=new sap.m.Title();if(!this._isUsingIOS()){this._enterFullScreenButton=new sap.m.ToggleButton({icon:"sap-icon://full-screen",type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText("VIEWER_FULLSCREENBUTTONTOOLTIP"),press:this._onFullScreen.bind(this)});this.setAggregation("_enterFullScreenButton",this._enterFullScreenButton);var b=new sap.m.Button({icon:"sap-icon://exit-full-screen",type:sap.m.ButtonType.Transparent,tooltip:sap.ui.vk.getResourceBundle().getText("VIEWER_FULLSCREENBUTTONTOOLTIP")});this.setAggregation("_exitFullScreenButton",b);t=[this._toolbarTitle,_,new sap.m.ToolbarSeparator(),this._sceneTreeButton,new sap.m.ToolbarSeparator(),this._stepNavigationButton,new sap.m.ToolbarSeparator(),this._enterFullScreenButton];}else{t=[this._toolbarTitle,_,new sap.m.ToolbarSeparator(),this._sceneTreeButton,new sap.m.ToolbarSeparator(),this._stepNavigationButton];}this.setAggregation("_toolbarTitle",this._toolbarTitle);this._toolbar=new sap.m.Toolbar({design:sap.m.ToolbarDesign.Solid,content:t});this.setAggregation("_toolbar",this._toolbar,true);};
T.prototype.exit=function(){this.oViewer=sap.ui.getCore().byId(this.getViewer());if(this.oViewer){this.oViewer.detachFullScreen(this._fullScreenHandler.bind(this));}};
T.prototype.onBeforeRendering=function(){this._toolbar.setVisible(true);this._toolbarTitle.setText(this.getTitle());};
T.prototype.refresh=function(){this.oViewer=sap.ui.getCore().byId(this.getViewer());this._stepNavigationButton.setPressed(this.oViewer.getShowStepNavigation());this._stepNavigationButton.setEnabled(this.oViewer.getEnableStepNavigation());this._sceneTreeButton.setPressed(this.oViewer.getShowSceneTree());this._sceneTreeButton.setEnabled(this.oViewer.getEnableSceneTree());this.oViewer.attachFullScreen(this._fullScreenHandler.bind(this));return true;};
T.prototype.onAfterRendering=function(){this.refresh();};
return T;},true);
sap.ui.predefine('sap/ui/vk/ToolbarRenderer',["jquery.sap.global"],function(q){"use strict";var T={};
T.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapVizKitToolbar");r.writeClasses();r.write(">");r.renderControl(c.getAggregation("_toolbar"));r.write("</div>");};
return T;},true);
sap.ui.predefine('sap/ui/vk/TransformationMatrix',["jquery.sap.global","sap/ui/base/DataType"],function(q,D){"use strict";var T=D.createType("sap.ui.vk.TransformationMatrix",{isValid:function(v){return T.getBaseType().isValid(v)&&v.length===12;}},D.getType("float[]"));
T.parseValue=function(v){var c=T.getComponentType();return v.split(/\s*,\s*|\s+/).map(c.parseValue.bind(c));};
T.convertTo4x4=function(a){var m=a;return[m[0],m[1],m[2],0,m[3],m[4],m[5],0,m[6],m[7],m[8],0,m[9],m[10],m[11],1];};
T.convertTo4x3=function(a){var m=a;return[m[0],m[1],m[2],m[4],m[5],m[6],m[8],m[9],m[10],m[12],m[13],m[14]];};
q.sap.setObject("sap.ui.vk.TransformationMatrix",T);return T;});
sap.ui.predefine('sap/ui/vk/ViewStateManager',["jquery.sap.global","./library","sap/ui/base/ManagedObject"],function(q,l,M){"use strict";var V,a=q.sap.log;
var b=M.extend("sap.ui.vk.ViewStateManager",{
metadata:{publicMethods:["enumerateSelection","getNodeHierarchy","getOpacity","getSelectionState","getTintColor","getVisibilityChanges","getVisibilityState","setOpacity","setSelectionState","setTintColor","setVisibilityState"],events:{visibilityChanged:{parameters:{visible:{type:"string[]"},hidden:{type:"string[]"}},enableEventBubbling:true},selectionChanged:{parameters:{selected:{type:"string[]"},unselected:{type:"string[]"}},enableEventBubbling:true},opacityChanged:{parameters:{changed:{type:"string[]"},opacity:{type:"float"}},enableEventBubbling:true},tintColorChanged:{parameters:{changed:{type:"string[]"},tintColor:{type:"sap.ui.core.CSSColor"},tintColorABGR:"int"},enableEventBubbling:true}}},
constructor:function(n,c,d){a.debug("sap.ui.vk.ViewStateManager.constructor() called.");M.apply(this);var e=n.getScene(),f=e._getDvlSceneId();this._nodeHierarchy=n;this._dvl=e.getGraphicsCore()._getDvl();this._canTrackVisibilityChanges=d;this._shouldTrackVisibilityChanges=c;this._nodeHierarchy.attachChanged(this._handleNodeHierarchyChanged,this);this._handleNodeHierarchyChanged();this._nodeStates=new Map();this._selectedNodes=new Set();var t=this;function h(i){var j=t._dvl.Scene.RetrieveNodeInfo(f,i,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_FLAGS|sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_CHILDREN);t._nodeStates.set(i,{flags:j.Flags});if(j.Flags&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED){t._selectedNodes.add(i);}j.ChildNodes.forEach(h);}t._dvl.Scene.RetrieveSceneInfo(f,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_CHILDREN|sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_HOTSPOTS).ChildNodes.forEach(h);}
});
b.prototype.destroy=function(){a.debug("sap.ui.vk.ViewStateManager.destroy() called.");this._newlyHiddenNodes=null;this._newlyVisibleNodes=null;this._selectedNodes=null;this._nodeStates=null;if(this._dvl){this._dvl.Client.detachStepEvent(this._handleStepEvent,this);}this._dvl=null;this._scene=null;this._nodeHierarchy.detachChanged(this._handleNodeHierarchyChanged,this);M.prototype.destroy.apply(this);};
b.prototype.getNodeHierarchy=function(){return this._nodeHierarchy;};
b.prototype.getVisibilityChanges=function(){return(this._getShouldTrackVisibilityChanges()&&this.getCanTrackVisibilityChanges())?this._visibilityTracker.getInfo(this.getNodeHierarchy()):null;};
b.prototype.getVisibilityComplete=function(){var n=this.getNodeHierarchy(),c=n.findNodesByName(),v=[],h=[];q.sap.require("sap.ui.vk.NodeProxy");c.forEach(function(d){var e=new sap.ui.vk.NodeProxy(n,d),f=q.grep(e.getVeIds(),function(f){return f.type==="VE_LOCATOR";})[0].fields[0].value;e.destroy();if(this.getVisibilityState(d)){v.push(f);}else{h.push(f);}},this);return{visible:v,hidden:h};};
var g=function(n,f,c){return n.has(c)&&(n.get(c).flags&f)!==0;};
b.prototype._getVisibilityFlagState=function(n){return g(this._nodeStates,sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE,n);};
b.prototype._getSelectionFlagState=function(n){return g(this._nodeStates,sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED,n);};
var s=function(n,f,c,d){if(n.has(d)){var i=n.get(d);i.flags=i.flags&~c|f&c;}else{n.set(d,{flags:f&c});}};
b.prototype._setFlags=function(n,f,c){if(c&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE){this.setVisibilityState(n,(f&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE)!==0,false);}if(c&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED){this.setSelectionState(n,(f&sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED)!==0,false);}s(this._nodeStates,f,c&~(sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE|sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED),n);return this;};
b.prototype._getFlags=function(n,f){var c=this._nodeStates.get(n),d=c&&c.flags;return d!==undefined?d&f:null;};
b.prototype.getVisibilityState=function(n){return Array.isArray(n)?n.map(this._getVisibilityFlagState,this):this._getVisibilityFlagState(n);};
b.prototype.setVisibilityState=function(n,v,r){if(!Array.isArray(n)){n=[n];}var c=q.sap.unique(r?this._collectNodesRecursively(n):n).filter(function(d){return this._getVisibilityFlagState(d)!==v;},this);if(c.length>0){c.forEach(function(d){var e=this._nodeStates.get(d);if(e){if(e.flags===undefined){e.flags=0;}if(v){e.flags|=sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE|sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_TEMPORARY_PREVIOUS_VISIBILITY;}else{e.flags&=~(sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE|sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_TEMPORARY_PREVIOUS_VISIBILITY);}}else{this._nodeStates.set(d,{flags:v?sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_VISIBLE:0});}},this);if(this._getShouldTrackVisibilityChanges()&&this.getCanTrackVisibilityChanges()){c.forEach(this._visibilityTracker.trackNodeId,this._visibilityTracker);}this.fireVisibilityChanged({visible:v?c:[],hidden:v?[]:c});}return this;};
b.prototype.enumerateSelection=function(c){this._selectedNodes.forEach(c);return this;};
b.prototype.getSelectionState=function(n){return Array.isArray(n)?n.map(this._getSelectionFlagState,this):this._getSelectionFlagState(n);};
b.prototype.setSelectionState=function(n,c,r){if(!Array.isArray(n)){n=[n];}var d=q.sap.unique(r?this._collectNodesRecursively(n):n).filter(function(e){return this._getSelectionFlagState(e)!==c;},this);if(d.length>0){d.forEach(function(e){var f=this._nodeStates.get(e);if(f){if(f.flags===undefined){f.flags=0;}if(c){f.flags|=sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED;}else{f.flags&=~sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED;}}else{this._nodeStates.set(e,{flags:c?sap.ve.dvl.DVLNODEFLAG.DVLNODEFLAG_SELECTED:0});}this._selectedNodes[c?"add":"delete"](e);},this);this.fireSelectionChanged({selected:c?d:[],unselected:c?[]:d});}return this;};
b.prototype._handleNodeHierarchyChanged=function(){if(this._getShouldTrackVisibilityChanges()&&this.getCanTrackVisibilityChanges()){if(!this._visibilityTracker){this._visibilityTracker=new V();this._dvl.Client.attachStepEvent(this._handleStepEvent,this);}}};
b.prototype._handleStepEvent=function(e){if(e.type===sap.ve.dvl.DVLSTEPEVENT.DVLSTEPEVENT_STARTED){this._visibilityTracker.clear();}};
b.prototype.getCanTrackVisibilityChanges=function(){return this._canTrackVisibilityChanges;};
b.prototype.setCanTrackVisibilityChanges=function(c){this._canTrackVisibilityChanges=c;};
b.prototype._getShouldTrackVisibilityChanges=function(){return this._shouldTrackVisibilityChanges;};
b.prototype._collectNodesRecursively=function(n){var r=[],t=this;n.forEach(function collectChildNodes(c){r.push(c);t._nodeHierarchy.enumerateChildren(c,collectChildNodes,false,true);});return r;};
b.prototype._getOpacity=function(n){if(this._nodeStates.has(n)){var o=this._nodeStates.get(n).opacity;return o===undefined?null:o;}else{return null;}};
b.prototype.getOpacity=function(n){if(Array.isArray(n)){return n.map(this._getOpacity,this);}else{return this._getOpacity(n);}};
b.prototype.setOpacity=function(n,o,r){if(!Array.isArray(n)){n=[n];}var c=q.sap.unique(r?this._collectNodesRecursively(n):n).filter(function(d){return this._getOpacity(d)!==o;},this);if(c.length>0){c.forEach(function(d){var e=this._nodeStates.get(d);if(e){if(o===null){delete e.opacity;}else{e.opacity=o;}}else if(o!==null){this._nodeStates.set(d,{opacity:o});}},this);this.fireOpacityChanged({changed:c,opacity:o});}return this;};
b.prototype._getTintColorABGR=function(n){if(this._nodeStates.has(n)){var t=this._nodeStates.get(n).tintColorABGR;return t===undefined?null:t;}else{return null;}};
b.prototype._getTintColor=function(n){if(this._nodeStates.has(n)){var t=this._nodeStates.get(n).tintColorABGR;return t===undefined?null:sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(t));}else{return null;}};
b.prototype.getTintColor=function(n,i){var c=i?"_getTintColorABGR":"_getTintColor";if(Array.isArray(n)){return n.map(this[c],this);}else{return this[c](n);}};
b.prototype.setTintColor=function(n,t,r){if(!Array.isArray(n)){n=[n];}var c=null;switch(typeof t){case"number":c=t;break;case"string":if(sap.ui.core.CSSColor.isValid(t)){c=sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(t));}break;default:t=null;break;}var d=q.sap.unique(r?this._collectNodesRecursively(n):n).filter(function(e){return this._getTintColorABGR(e)!==c;},this);if(d.length>0){d.forEach(function(e){var f=this._nodeStates.get(e);if(f){if(c===null){delete f.tintColorABGR;}else{f.tintColorABGR=c;}}else if(c!==null){this._nodeStates.set(e,{tintColorABGR:c});}},this);this.fireTintColorChanged({changed:d,tintColor:t,tintColorABGR:c});}return this;};
V=function(){this._visibilityChanges=new Set();};
V.prototype.getInfo=function(n){var f=function(v){return v.type==="VE_LOCATOR";};q.sap.require("sap.ui.vk.NodeProxy");var c=[];this._visibilityChanges.forEach(function(d){var e=new sap.ui.vk.NodeProxy(n,d),v=q.grep(e.getVeIds(),f)[0].fields[0].value;e.destroy();c.push(v);});return c;};
V.prototype.clear=function(){this._visibilityChanges.clear();};
V.prototype.trackNodeId=function(n){if(this._visibilityChanges.has(n)){this._visibilityChanges.delete(n);}else{this._visibilityChanges.add(n);}};
return b;});
sap.ui.predefine('sap/ui/vk/ViewerRenderer',["jquery.sap.global"],function(q){"use strict";var V={};
V.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapVizKitViewer");r.writeClasses();r.addStyle("width",c.getWidth());r.addStyle("height",c.getHeight());r.writeStyles();r.write(">");r.renderControl(c.getAggregation("layout"));r.renderControl(c.getAggregation("progressIndicator"));r.write("</div>");};
return V;},true);
sap.ui.predefine('sap/ui/vk/Viewport',["jquery.sap.global","./library","sap/ui/core/Control","sap/ui/core/ResizeHandler","./Loco","./ViewportHandler","./Smart2DHandler","./GraphicsCore","./Messages"],function(q,l,C,R,L,V,S,G,M){"use strict";var d={encodedProjectionType:{},decodedProjectionType:{},encodedBindingType:{},decodedBindingType:{},decodedZoomTo:{}};d.decodedProjectionType[sap.ui.vk.CameraProjectionType.Perspective]=sap.ve.dvl.DVLCAMERAPROJECTION.PERSPECTIVE;d.decodedProjectionType[sap.ui.vk.CameraProjectionType.Orthographic]=sap.ve.dvl.DVLCAMERAPROJECTION.ORTHOGRAPHIC;d.encodedProjectionType[sap.ve.dvl.DVLCAMERAPROJECTION.PERSPECTIVE]=sap.ui.vk.CameraProjectionType.Perspective;d.encodedProjectionType[sap.ve.dvl.DVLCAMERAPROJECTION.ORTHOGRAPHIC]=sap.ui.vk.CameraProjectionType.Orthographic;d.decodedBindingType[sap.ui.vk.CameraFOVBindingType.Minimum]=sap.ve.dvl.DVLCAMERAFOVBINDING.MIN;d.decodedBindingType[sap.ui.vk.CameraFOVBindingType.Maximum]=sap.ve.dvl.DVLCAMERAFOVBINDING.Max;d.decodedBindingType[sap.ui.vk.CameraFOVBindingType.Horizontal]=sap.ve.dvl.DVLCAMERAFOVBINDING.HORZ;d.decodedBindingType[sap.ui.vk.CameraFOVBindingType.Vertical]=sap.ve.dvl.DVLCAMERAFOVBINDING.VERT;d.encodedBindingType[sap.ve.dvl.DVLCAMERAFOVBINDING.MIN]=sap.ui.vk.CameraFOVBindingType.Minimum;d.encodedBindingType[sap.ve.dvl.DVLCAMERAFOVBINDING.MAX]=sap.ui.vk.CameraFOVBindingType.Maximum;d.encodedBindingType[sap.ve.dvl.DVLCAMERAFOVBINDING.HORZ]=sap.ui.vk.CameraFOVBindingType.Horizontal;d.encodedBindingType[sap.ve.dvl.DVLCAMERAFOVBINDING.VERT]=sap.ui.vk.CameraFOVBindingType.Vertical;d.decodedZoomTo[sap.ui.vk.ZoomTo.All]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_ALL;d.decodedZoomTo[sap.ui.vk.ZoomTo.Visible]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_VISIBLE;d.decodedZoomTo[sap.ui.vk.ZoomTo.Selected]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_SELECTED;d.decodedZoomTo[sap.ui.vk.ZoomTo.Node]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_NODE;d.decodedZoomTo[sap.ui.vk.ZoomTo.NodeSetIsolation]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_NODE_SETISOLATION;d.decodedZoomTo[sap.ui.vk.ZoomTo.Restore]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_RESTORE;d.decodedZoomTo[sap.ui.vk.ZoomTo.RestoreRemoveIsolation]=sap.ve.dvl.DVLZOOMTO.DVLZOOMTO_RESTORE_REMOVEISOLATION;d.decodedZoomTo[sap.ui.vk.ZoomTo.ViewLeft]=sap.ve.dvl.DVLZOOMTO.VIEW_LEFT;d.decodedZoomTo[sap.ui.vk.ZoomTo.ViewRight]=sap.ve.dvl.DVLZOOMTO.VIEW_RIGHT;d.decodedZoomTo[sap.ui.vk.ZoomTo.ViewTop]=sap.ve.dvl.DVLZOOMTO.VIEW_TOP;d.decodedZoomTo[sap.ui.vk.ZoomTo.ViewBottom]=sap.ve.dvl.DVLZOOMTO.VIEW_BOTTOM;d.decodedZoomTo[sap.ui.vk.ZoomTo.ViewBack]=sap.ve.dvl.DVLZOOMTO.VIEW_BACK;d.decodedZoomTo[sap.ui.vk.ZoomTo.ViewFront]=sap.ve.dvl.DVLZOOMTO.VIEW_FRONT;
var a=C.extend("sap.ui.vk.Viewport",{metadata:{library:"sap.ui.vk",publicMethods:["setGraphicsCore","getGraphicsCore","setScene","setViewStateManager","beginGesture","endGesture","pan","rotate","zoom","tap","hitTest","queueCommand","getViewInfo","setViewInfo"],properties:{showDebugInfo:"boolean",showAllHotspots:{type:"boolean",defaultValue:false},hotspotColorABGR:{type:"int",defaultValue:0xc00000ff},hotspotColor:{type:"sap.ui.core.CSSColor",defaultValue:"rgba(255, 0, 0, 0.7529411764705882)"},backgroundColorTopABGR:{type:"int",defaultValue:0xff000000},backgroundColorTop:{type:"sap.ui.core.CSSColor",defaultValue:"rgba(0, 0, 0, 1)"},backgroundColorBottomABGR:{type:"int",defaultValue:0xffffffff},backgroundColorBottom:{type:"sap.ui.core.CSSColor",defaultValue:"rgba(255, 255, 255, 1)"},width:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",defaultValue:"100%"}},events:{urlClicked:{parameters:{nodeId:"string",url:"string"},enableEventBubbling:true},nodeClicked:{parameters:{nodeId:"string",x:"int",y:"int"},enableEventBubbling:true},pan:{parameters:{dx:"int",dy:"int"}},zoom:{parameters:{zoomFactor:"float"}},rotate:{parameters:{dx:"int",dy:"int"}},resize:{parameters:{size:"object"}},viewActivated:{parameters:{type:{type:"string"}}},frameRenderingFinished:{}}}});
a.prototype.init=function(){if(C.prototype.init){C.prototype.init.call(this);}this._graphicsCore=null;this._dvl=null;this._dvlRendererId=null;this._viewStateManager=null;this._canvas=null;this._resizeListenerId=null;this._is2D=false;this._viewportHandler=new V(this);this._loco=new L();this._loco.addHandler(this._viewportHandler);this._smart2DHandler=null;this._lastPlayedStep=null;};
a.prototype.exit=function(){this._loco.removeHandler(this._viewportHandler);this._viewportHandler.destroy();if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}this.setViewStateManager(null);this.setScene(null);this.setGraphicsCore(null);if(C.prototype.exit){C.prototype.exit.call(this);}};
a.prototype.setGraphicsCore=function(h){if(h!=this._graphicsCore){if(this._graphicsCore){this._dvl.Client.detachFrameFinished(this._handleFrameFinished,this);this._dvl.Client.detachStepEvent(this._updateLastPlayedStep,this);this._graphicsCore._deregisterViewport(this);this._dvl=null;}this._graphicsCore=h;if(this._graphicsCore){this._dvl=this._graphicsCore._getDvl();this._graphicsCore._registerViewport(this);this.setShowDebugInfo(this.getShowDebugInfo());this._dvl.Client.attachStepEvent(this._updateLastPlayedStep,this);this._dvl.Client.attachFrameFinished(this._handleFrameFinished,this);}}return this;};
a.prototype.getGraphicsCore=function(){return this._graphicsCore;};
a.prototype._setCanvas=function(h){var i=this.getDomRef()&&this._canvas!==h;this._canvas=h;if(i){this.invalidate();}return this;};
a.prototype._setRenderer=function(h){this._dvlRendererId=h;return this;};
a.prototype._updateLastPlayedStep=function(h){if(h.type===sap.ve.dvl.DVLSTEPEVENT.DVLSTEPEVENT_STARTED){this._lastPlayedStep=h.stepId;}};
a.prototype.setScene=function(h){if(this._dvlRendererId){this._dvl.Renderer.AttachScene(h&&h._getDvlSceneId()||null,this._dvlRendererId);this._dvlSceneId=h?h._getDvlSceneId():null;if(h){this._dvl.Client.attachUrlClicked(this._fireUrlClicked,this);var i=this._isSmart2DContent()||this._isSmart2DContentLegacy();if(i){this._dvl.Renderer.SetBackgroundColor(1,1,1,1,1,1,1,1,this._dvlRendererId);}else{var t=this._getDecomposedABGR(this.getBackgroundColorTopABGR());var j=this._getDecomposedABGR(this.getBackgroundColorBottomABGR());this._dvl.Renderer.SetBackgroundColor(t.red,t.green,t.blue,t.alpha,j.red,j.green,j.blue,j.alpha,this._dvlRendererId);}this.fireViewActivated({type:i?"2D":"3D"});}else{this._dvl.Client.detachUrlClicked(this._fireUrlClicked,this);if(this._smart2DHandler){var k=new L();k.removeHandler(this._smart2DHandler);}}}return this;};
a.prototype._isSmart2DContent=function(){var h=sap.ui.vk.dvl.getJSONObject(this._dvl.Scene.RetrieveSceneInfo(this._dvlSceneId,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_HOTSPOTS).ChildNodes);return h&&h.length>0;};
a.prototype._isSmart2DContentLegacy=function(){var h=this._dvl.Scene.GetCurrentCamera(this._dvlSceneId),i=this._dvl.Camera.GetRotation(h),j=this._dvl.Camera.GetProjection(h);return i[0]===90&&i[1]===-90&&i[2]===0&&j===sap.ve.dvl.DVLCAMERAPROJECTION.ORTHOGRAPHIC;};
a.prototype._initializeSmart2DHandler=function(){if(this._viewStateManager){if(this._smart2DHandler){this._loco.removeHandler(this._smart2DHandler);}this._smart2DHandler=new S(this,this._viewStateManager);this._loco.addHandler(this._smart2DHandler);}if(this.getShowAllHotspots()){var n=this._viewStateManager.getNodeHierarchy(),h=n.getHotspotNodeIds();this.showHotspots(h,true);}};
a.prototype._fireUrlClicked=function(h){this.fireUrlClicked({url:h.url,nodeId:h.nodeId});};
a.prototype._getStepAndProcedureIndexes=function(h,k){var m=-1,n=-1,t=false;for(var i=0;i<h.length;i++){if(!t){for(var j=0;j<h[i].steps.length;j++){if(h[i].steps[j].id===k){n=j;m=i;t=true;break;}}}else{break;}}return{stepIndex:n,procedureIndex:m};};
a.prototype._getStepVeIdById=function(h){if(h){var v=this._dvl.Scene.RetrieveVEIDs(this._dvlSceneId,h);if(Array.isArray(v)){for(var i=0,j=v.length;i<j;++i){var k=v[i];if(k.source==="SAP"&&k.type==="VE_VIEWPORT"&&Array.isArray(k.fields)){for(var m=0,n=k.fields.length;m<n;++m){var t=k.fields[m];if(t.name==="ID"){return t.value;}}}}}}return null;};
a.prototype._getStepIdByVeId=function(h,i){for(var j=0,k=h.length;j<k;++j){var m=h[j].steps;for(var n=0,t=m.length;n<t;++n){var u=m[n].id;if(this._getStepVeIdById(u)===i){return u;}}}return null;};
var s=function(h){h.camera={};};var b=function(h){if(typeof h.camera==="object"&&h.camera!==null){h.camera.matrices=false;}};var c=function(h){if(typeof h.camera==="object"&&h.camera!==null){h.camera.useTransitionCamera=false;}};var e=function(h){h.animation=true;};var f=function(h){h.visibility=false;};var g=function(h){if(typeof h.visibility==="object"&&h.visibility!==null){h.visibility.mode=sap.ui.vk.VisibilityMode.Complete;}};
a.prototype.getViewInfo=function(h){if(!this._dvlSceneId){return null;}var i={};if(typeof h!=="object"||h===null){s(i);b(i);c(i);e(i);f(i);g(i);}else{if(typeof h.camera==="object"&&h.camera!==null){i.camera={};if(typeof h.camera.matrices==="boolean"){i.camera.matrices=h.camera.matrices;}else if("matrices"in h.camera){i.camera.matrices=false;}else{b(i);}if(typeof h.camera.useTransitionCamera==="boolean"){i.camera.useTransitionCamera=h.camera.useTransitionCamera;}else if("useTransitionCamera"in h.camera){i.camera.useTransitionCamera=false;}else{c(i);}}else if(typeof h.camera==="boolean"){if(h.camera===true){i.camera={};b(i);c(i);}else{i.camera=false;}}else if("camera"in h){i.camera=false;}else{s(i);b(i);c(i);}if(typeof h.animation==="boolean"){i.animation=h.animation;}else if("animation"in h){i.animation=false;}else{e(i);}if(typeof h.visibility==="object"&&h.visibility!==null){i.visibility={};if(h.visibility.mode===sap.ui.vk.VisibilityMode.Complete||h.visibility.mode===sap.ui.vk.VisibilityMode.Differences){i.visibility.mode=h.visibility.mode;}else{g(i);}}else if(typeof h.visibility==="boolean"){if(h.visibility===true){i.visibility={};g(i);}else{i.visibility=false;}}else if("visibility"in h){i.visibility=false;}else{f(i);g(i);}}var v={};if(i.camera){var j=null;if(i.camera.useTransitionCamera){j=this._dvl.Renderer.GetTransitionCamera(this._dvlRendererId);if(j===sap.ve.dvl.DVLID_INVALID){j=null;}}if(j===null){j=this._dvl.Renderer.GetCurrentCamera(this._dvlRendererId);}var k=this._dvl.Camera.GetRotation(j),m=this._dvl.Camera.GetOrigin(j);v.camera={rotation:{yaw:k[0],pitch:k[1],roll:k[2]},position:{x:m[0],y:m[1],z:m[2]},projectionType:d.encodedProjectionType[this._dvl.Camera.GetProjection(j)],bindingType:d.encodedBindingType[this._dvl.Camera.GetFOVBinding(j)]};if(v.camera.projectionType===sap.ui.vk.CameraProjectionType.Perspective){v.camera.fieldOfView=this._dvl.Camera.GetFOV(j);}else if(v.camera.projectionType===sap.ui.vk.CameraProjectionType.Orthographic){v.camera.zoomFactor=this._dvl.Camera.GetOrthoZoomFactor(j);}if(i.camera.matrices){var n=this._dvl.Renderer.GetCameraMatrices(this._dvlRendererId);v.camera.matrices={view:n.view,projection:n.projection};}}if(i.animation){var t=this._dvl.Scene.RetrieveSceneInfo(this._dvlSceneId,sap.ve.dvl.DVLSCENEINFO.DVLSCENEINFO_STEP_INFO),u=t.StepId!==sap.ve.dvl.DVLID_INVALID;var w=u?t.StepId:this._lastPlayedStep,x=u?t.StepTime:0,y=this._dvl.Scene.RetrieveProcedures(this._dvlSceneId),z=this._getStepAndProcedureIndexes(y.procedures,w),A=this._getStepVeIdById(w);v.animation={animationTime:x,stepIndex:z.stepIndex,procedureIndex:z.procedureIndex};if(A){v.animation.stepVeId=A;}}if(i.visibility&&this._viewStateManager){if(this._viewStateManager.getCanTrackVisibilityChanges()){v.visibility={mode:i.visibility.mode};if(i.visibility.mode===sap.ui.vk.VisibilityMode.Complete){var B=this._viewStateManager.getVisibilityComplete();v.visibility.visible=B.visible;v.visibility.hidden=B.hidden;}else{v.visibility.changes=this._viewStateManager.getVisibilityChanges();}}else{q.sap.log.warning(sap.ui.vk.getResourceBundle().getText(M.VIT32.summary),M.VIT32.code,"sap.ui.vk.Viewport");}}return v;};
a.prototype.setViewInfo=function(v,h){var i=false;if(v.animation){var j=this._dvl.Scene.RetrieveProcedures(this._dvlSceneId),k=v.animation.procedureIndex,m=v.animation.stepIndex,n=v.animation.stepVeId,t,u=v.animation.animationTime||0;if(n||m>=0&&k>=0){if(n){t=this._getStepIdByVeId(j.procedures,v.animation.stepVeId);}else if(k>=0&&k<j.procedures.length){if(m>=0&&m<j.procedures[k].steps.length){t=j.procedures[k].steps[m].id;}else{q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT26.summary),M.VIT26.code,"sap.ui.vk.Viewport");}}else{q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT27.summary),M.VIT27.code,"sap.ui.vk.Viewport");}if(t){this._dvl.Renderer.ActivateStep(this._dvlRendererId,t,false,false,u);this._dvl.Renderer.PauseCurrentStep(this._dvlRendererId);}}else{i=true;}}if(v.camera){var w;if(v.camera.projectionType===sap.ui.vk.CameraProjectionType.Perspective||v.camera.projectionType===sap.ui.vk.CameraProjectionType.Orthographic){w=d.decodedProjectionType[v.camera.projectionType];}else{q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT19.summary),M.VIT19.code,"sap.ui.vk.Viewport");w=sap.ve.dvl.DVLCAMERAPROJECTION.PERSPECTIVE;}var x=this._dvl.Scene.CreateCamera(this._dvlSceneId,w,sap.ve.dvl.DVLID_INVALID);if(w===sap.ve.dvl.DVLCAMERAPROJECTION.PERSPECTIVE){this._dvl.Camera.SetFOV(x,v.camera.fieldOfView);}else if(w===sap.ve.dvl.DVLCAMERAPROJECTION.ORTHOGRAPHIC){this._dvl.Camera.SetOrthoZoomFactor(x,v.camera.zoomFactor);}if(v.camera.position){this._dvl.Camera.SetOrigin(x,v.camera.position.x,v.camera.position.y,v.camera.position.z);}if(v.camera.rotation){this._dvl.Camera.SetRotation(x,v.camera.rotation.yaw,v.camera.rotation.pitch,v.camera.rotation.roll);}if(v.camera.bindingType){var y=d.decodedBindingType[v.camera.bindingType]||sap.ve.dvl.DVLCAMERAFOVBINDING.MIN;this._dvl.Camera.SetFOVBinding(x,y);}h=h||0;this._dvl.Renderer.ActivateCamera(this._dvlRendererId,x,h);this._dvl.Scene.DeleteNode(this._dvlSceneId,x);}if(v.visibility){var z=this._viewStateManager.getNodeHierarchy(),A=new Map(),B=z.findNodesByName();B.forEach(function(F){var H=z.createNodeProxy(F),I=q.grep(H.getVeIds(),function(I){return I.type==="VE_LOCATOR";})[0].fields[0].value;z.destroyNodeProxy(H);A.set(I,F);});switch(v.visibility.mode){case sap.ui.vk.VisibilityMode.Complete:var D=v.visibility.visible,E=v.visibility.hidden;D.forEach(function(F){this._viewStateManager.setVisibilityState(A.get(F),true,false);},this);E.forEach(function(F){this._viewStateManager.setVisibilityState(A.get(F),false,false);},this);break;case sap.ui.vk.VisibilityMode.Differences:if(i){this.resetView({camera:false,visibility:true,transition:false});}v.visibility.changes.forEach(function(F){var H=A.get(F);this._viewStateManager.setVisibilityState(H,!this._viewStateManager.getVisibilityState(H),false);},this);break;default:q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT28.summary),M.VIT28.code,"sap.ui.vk.Viewport");break;}}return this;};
a.prototype.onBeforeRendering=function(){if(this._resizeListenerId){R.deregister(this._resizeListenerId);this._resizeListenerId=null;}};
a.prototype.getOutputSize=function(){var h=this.getViewInfo().camera.bindingType,i=this.getDomRef().getBoundingClientRect(),v=i.width,j=i.height,k;switch(d.decodedBindingType[h]){case sap.ve.dvl.DVLCAMERAFOVBINDING.MIN:k=Math.min(v,j);break;case sap.ve.dvl.DVLCAMERAFOVBINDING.MAX:k=Math.max(v,j);break;case sap.ve.dvl.DVLCAMERAFOVBINDING.HORZ:k=v;break;case sap.ve.dvl.DVLCAMERAFOVBINDING.VERT:k=j;break;default:break;}return{left:(v-k)/2,top:(j-k)/2,sideLength:k};};
a.prototype.onAfterRendering=function(){if(this._canvas){var h=this.getDomRef();h.appendChild(this._canvas);this._resizeListenerId=R.register(this,this._handleResize.bind(this));this._handleResize({size:{width:h.clientWidth,height:h.clientHeight}});}};
a.prototype._handleResize=function(h){if(this._dvlRendererId&&this._canvas){var i=h.size.width*window.devicePixelRatio;var j=h.size.height*window.devicePixelRatio;this._dvl.Renderer.SetDimensions(i,j,this._dvlRendererId);this._dvl.Renderer.SetOptionF(sap.ve.dvl.DVLRENDEROPTIONF.DVLRENDEROPTIONF_DPI,96*window.devicePixelRatio,this._dvlRendererId);this._canvas.width=i;this._canvas.height=j;this._canvas.style.width=h.size.width+"px";this._canvas.style.height=h.size.height+"px";this.fireResize({size:{width:h.size.width,height:h.size.height}});return true;}};
a.prototype.setViewStateManager=function(v){if(this._dvl){if(this._viewStateManager){this._viewStateManager.detachTintColorChanged(this._handleTintColorChanged,this);this._viewStateManager.detachOpacityChanged(this._handleOpacityChanged,this);this._viewStateManager.detachSelectionChanged(this._handleSelectionChanged,this);this._viewStateManager.detachVisibilityChanged(this._handleVisibilityChanged,this);}this._viewStateManager=v;this._dvl.Renderer.SetViewStateManager(v,this._dvlRendererId);if(this._viewStateManager&&(this._isSmart2DContent()||this._isSmart2DContentLegacy())){this._initializeSmart2DHandler();}if(this._viewStateManager){this._viewStateManager.attachVisibilityChanged(this._handleVisibilityChanged,this);this._viewStateManager.attachSelectionChanged(this._handleSelectionChanged,this);this._viewStateManager.attachOpacityChanged(this._handleOpacityChanged,this);this._viewStateManager.attachTintColorChanged(this._handleTintColorChanged,this);}}return this;};
a.prototype._handleVisibilityChanged=a.prototype._handleSelectionChanged=a.prototype._handleOpacityChanged=a.prototype._handleTintColorChanged=function(h){this.renderFrame();};
a.prototype.showHotspots=function(n,h,i){var j=sap.ui.vk.NodeProxy.prototype[typeof i==="string"?"setTintColor":"setTintColorABGR"];var k=function(t,i,x){var y=t.createNodeProxy(x);j.call(y,i);t.destroyNodeProxy(y);};if(!Array.isArray(n)){n=[n];}var m=i===undefined?this.getHotspotColorABGR():i;if(!h){m=0;}var t=this._viewStateManager.getNodeHierarchy();if(this._isSmart2DContent()){var u=[];n.forEach(function(x){var y=sap.ui.vk.dvl.getJSONObject(this._dvl.Scene.RetrieveNodeInfo(this._dvlSceneId,x,sap.ve.dvl.DVLNODEINFO.DVLNODEINFO_CHILDREN).ChildNodes);Array.prototype.push.apply(u,y);}.bind(this));Array.prototype.push.apply(u,n);u.forEach(k.bind(null,t,m));}else{var v=[];var w=function(x){var u=t.getChildren(x);Array.prototype.push.apply(v,u);u.forEach(w);};n.forEach(w);Array.prototype.push.apply(v,n);v.forEach(k.bind(null,t,m));}return this;};
a.prototype.setHotspotColorABGR=function(v){this.setProperty("hotspotColorABGR",v,true);this.setProperty("hotspotColor",sap.ui.vk.colorToCSSColor(sap.ui.vk.abgrToColor(v)),true);return this;};
a.prototype.setHotspotColor=function(v){this.setProperty("hotspotColor",v,true);this.setProperty("hotspotColorABGR",sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(v)),true);return this;};
a.prototype._getDecomposedABGR=function(i){return{red:(i>>>0&0xff)/255,green:(i>>>8&0xff)/255,blue:(i>>>16&0xff)/255,alpha:(i>>>24&0xff)/255};};
a.prototype._setBackgroundColor=function(){var t=this._getDecomposedABGR(this.getBackgroundColorTopABGR()),h=this._getDecomposedABGR(this.getBackgroundColorBottomABGR());this._dvl.Renderer.SetBackgroundColor(t.red,t.green,t.blue,t.alpha,h.red,h.green,h.blue,h.alpha,this._dvlRendererId);};
a.prototype.setBackgroundColorTopABGR=function(i){this.setProperty("backgroundColorTopABGR",i,true);this._setBackgroundColor();return this;};
a.prototype.setBackgroundColorTop=function(v){this.setProperty("backgroundColorTop",v,true);return this.setBackgroundColorTopABGR(sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(v)));};
a.prototype.setBackgroundColorBottomABGR=function(i){this.setProperty("backgroundColorBottomABGR",i,true);this._setBackgroundColor();return this;};
a.prototype.setBackgroundColorBottom=function(v){this.setProperty("backgroundColorBottom",v,true);return this.setBackgroundColorBottomABGR(sap.ui.vk.colorToABGR(sap.ui.vk.cssColorToColor(v)));};
a.prototype.shouldRenderFrame=function(){return this._dvlRendererId&&this._dvl.Renderer.ShouldRenderFrame(this._dvlRendererId);};
a.prototype.renderFrame=function(){if(this._dvlRendererId){this._dvl.Renderer.RenderFrame(this._dvlRendererId);}return this;};
a.prototype.renderFrameEx=function(v,h){if(this._dvlRendererId){this._dvl.Renderer.RenderFrameEx.apply(this,[].concat(v,h),this._dvlRendererId);}return this;};
a.prototype.resetView=function(h){if(h!==undefined&&!q.isPlainObject(h)){q.sap.log.error(sap.ui.vk.getResourceBundle().getText(M.VIT31.summary),M.VIT31.code,"sap.ui.vk.Viewport");}var i={camera:true,transition:true,visibility:false};q.extend(i,h);if(i.camera||i.visibility){var j=(i.camera?sap.ve.dvl.DVLRESETVIEWFLAG.CAMERA:0)|(i.transition?sap.ve.dvl.DVLRESETVIEWFLAG.SMOOTHTRANSITION:0)|(i.visibility?sap.ve.dvl.DVLRESETVIEWFLAG.VISIBILITY:0);if(this._dvlRendererId){this._dvl.Renderer.ResetView(j,this._dvlRendererId);this._lastPlayedStep=null;}}return this;};
a.prototype.canIsolateNode=function(n){if(this._dvlRendererId){return this._dvl.Renderer.CanIsolateNode(n,this._dvlRendererId);}else{return false;}};
a.prototype.setIsolatedNode=function(n){if(this._dvlRendererId){this._dvl.Renderer.SetIsolatedNode(n,this._dvlRendererId);}return this;};
a.prototype.getIsolatedNode=function(){if(this._dvlRendererId){return this._dvl.Renderer.GetIsolatedNode(this._dvlRendererId);}else{return sap.ve.dvl.DVLID_INVALID;}};
a.prototype.hitTest=function(x,y){if(this._dvlRendererId){var h=this._dvl.Renderer.HitTest(x*window.devicePixelRatio,y*window.devicePixelRatio,this._dvlRendererId).id;this.renderFrame();return h;}else{return sap.ve.dvl.DVLID_INVALID;}};
a.prototype.setShowDebugInfo=function(v){this.setProperty("showDebugInfo",v,true);if(this._dvlRendererId){this._dvl.Renderer.SetOption(sap.ve.dvl.DVLRENDEROPTION.DVLRENDEROPTION_SHOW_DEBUG_INFO,v,this._dvlRendererId);}return this;};
a.prototype._handleFrameFinished=function(h){if(h.rendererId===this._dvlRendererId){this.fireFrameRenderingFinished();}};
a.prototype.beginGesture=function(x,y){if(this._dvlRendererId){this._dvl.Renderer.BeginGesture(x*window.devicePixelRatio,y*window.devicePixelRatio,this._dvlRendererId);}return this;};
a.prototype.endGesture=function(){if(this._dvlRendererId){this._dvl.Renderer.EndGesture(this._dvlRendererId);}return this;};
a.prototype.pan=function(h,i){if(this._dvlRendererId){this._dvl.Renderer.Pan(h*window.devicePixelRatio,i*window.devicePixelRatio,this._dvlRendererId);this.firePan({dx:h,dy:i});}return this;};
a.prototype.rotate=function(h,i){if(this._dvlRendererId){this._dvl.Renderer.Rotate(h*window.devicePixelRatio,i*window.devicePixelRatio,this._dvlRendererId);this.fireRotate({dx:h,dy:i});}return this;};
a.prototype.zoom=function(h){if(this._dvlRendererId){this._dvl.Renderer.Zoom(h,this._dvlRendererId);this.fireZoom({zoomFactor:h});}return this;};
a.prototype.zoomTo=function(w,n,h,m){if(this._dvlRendererId){var j=0;if(Array.isArray(w)){for(var i in w){j|=d.decodedZoomTo[w[i]];}}else{j=d.decodedZoomTo[w];}this._dvl.Renderer.ZoomTo(j,n,h,m,this._dvlRendererId);}return this;};
a.prototype.tap=function(x,y,i){if(this._dvlRendererId){var h=x*window.devicePixelRatio,j=y*window.devicePixelRatio;if(!i){var n=this.hitTest(x,y);if(this._viewStateManager&&(n===sap.ve.dvl.DVLID_INVALID||!this._viewStateManager.getSelectionState(n))){var k=[];this._viewStateManager.enumerateSelection(Array.prototype.push.bind(k));if(k.length>0){this._viewStateManager.setSelectionState(k,false,false);}}if(n!==sap.ve.dvl.DVLID_INVALID){this.fireNodeClicked({nodeId:n,x:x,y:y},true,true);if(this._viewStateManager){this._viewStateManager.setSelectionState(n,true);}}}else{this._dvl.Renderer.Tap(h,j,i,this._dvlRendererId);}}return this;};
a.prototype.queueCommand=function(h){if(this._dvlRendererId){this._dvl.Renderer._queueCommand(h,this._dvlRendererId);}return this;};
var o={x:-2,y:-2};var r=2;var p=5;[{key:"left",dx:-r,dy:0},{key:"right",dx:+r,dy:0},{key:"up",dx:0,dy:-r},{key:"down",dx:0,dy:+r}].forEach(function(i){a.prototype["onsap"+i.key]=function(h){this.beginGesture(o.x,o.y);this.rotate(i.dx,i.dy);this.endGesture();this.renderFrame();h.preventDefault();h.stopPropagation();};});[{key:"left",dx:-p,dy:0},{key:"right",dx:+p,dy:0},{key:"up",dx:0,dy:-p},{key:"down",dx:0,dy:+p}].forEach(function(i){a.prototype["onsap"+i.key+"modifiers"]=function(h){if(h.shiftKey&&!(h.ctrlKey||h.altKey||h.metaKey)){this.beginGesture(o.x,o.y);this.pan(i.dx,i.dy);this.endGesture();this.renderFrame();h.preventDefault();h.stopPropagation();}};});[{key:"minus",d:0.98},{key:"plus",d:1.02}].forEach(function(i){a.prototype["onsap"+i.key]=function(h){this.beginGesture(this.$().width()/2,this.$().height()/2);this.zoom(i.d);this.endGesture();this.renderFrame();h.preventDefault();h.stopPropagation();};});return a;});
sap.ui.predefine('sap/ui/vk/ViewportHandler',["jquery.sap.global","sap/ui/base/EventProvider","sap/ui/core/ResizeHandler"],function(q,E,R){"use strict";
var V=E.extend("sap.ui.vk.ViewportHandler",{
metadata:{publicMethods:["beginGesture","move","endGesture","click","doubleClick","contextMenu","getViewport"]},
constructor:function(a){this._viewport=a;this._rect=null;this._evt={x:0,y:0,z:0,d:0,tdx:0,tdy:0,tdd:0,initd:0};this._gesture=false;this._viewport.attachEvent("resize",this,this._onresize);this._nomenu=false;}
});
V.prototype.destroy=function(){this._viewport=null;this._rect=null;this._evt=null;this._gesture=false;};
V.prototype._getOffset=function(o){var r=o.getBoundingClientRect();var p={x:r.left+window.pageXOffset,y:r.top+window.pageYOffset};return p;};
V.prototype._inside=function(e){if(this._rect==null||true){var i=this._viewport.getIdForLabel();var d=document.getElementById(i);if(d==null){return false;}var o=this._getOffset(d);this._rect={x:o.x,y:o.y,w:d.offsetWidth,h:d.offsetHeight};}return(e.x>=this._rect.x&&e.x<=this._rect.x+this._rect.w&&e.y>=this._rect.y&&e.y<=this._rect.y+this._rect.h);};
V.prototype._onresize=function(e){this._gesture=false;this._rect=null;};
V.prototype.beginGesture=function(a){if(this._inside(a)&&!this._gesture){this._gesture=true;var x=a.x-this._rect.x,y=a.y-this._rect.y;this._evt.tdx=0;this._evt.tdy=0;this._evt.tdd=0;this._evt.x=x;this._evt.y=y;this._evt.d=a.d;this._evt.initd=a.d;this._evt.avgd=a.d;this._evt.avgx=0;this._evt.avgy=0;q.sap.log.debug("Loco: beginGesture: "+x+", "+y);this._viewport.queueCommand(function(){this._viewport.beginGesture(x,y);}.bind(this));a.handled=true;if(document.activeElement){try{document.activeElement.blur();}catch(e){}}var d=document.getElementById(this._viewport.getIdForLabel());d.focus();}this._nomenu=false;};
V.prototype.move=function(e){if(this._gesture){var x=e.x-this._rect.x,y=e.y-this._rect.y;var d=x-this._evt.x;var a=y-this._evt.y;var b=e.d-this._evt.d;this._evt.tdx=this._evt.tdx+d;this._evt.tdy=this._evt.tdy+a;this._evt.tdd=this._evt.tdd+b;this._evt.x=x;this._evt.y=y;this._evt.d=e.d;this._evt.avgx=this._evt.avgx*0.99+d*0.01;this._evt.avgy=this._evt.avgy*0.99+a*0.01;var z=1.0;if(this._evt.initd>0){z=1.0+b*(1.0/this._evt.initd);}else if(e.n==2){if(e.points[0].y>e.points[1].y){z=1.0-b*0.005;if(z<0.333){z=0.333;}}else{z=1.0+b*0.005;if(z>3){z=3;}}}if(this._evt.initd>0){var c=Math.sqrt(this._evt.avgx*this._evt.avgx+this._evt.avgy*this._evt.avgy);q.sap.log.debug("AvgDist: "+c);if((Math.abs(e.d-this._evt.avgd)/this._evt.avgd)<(c/10)){z=1.0;}}this._evt.avgd=this._evt.avgd*0.97+e.d*0.03;this._evt.n=e.n;switch(e.n){case 1:q.sap.log.debug("Loco: Rotate: "+(d)+", "+(a));this._viewport.queueCommand(function(){this._viewport.rotate(d,a);}.bind(this));break;case 2:q.sap.log.debug("Loco: Pan: "+(d)+", "+(a));if(z!=0&&z!=1.0){q.sap.log.debug("Loco: Zoom: "+(z));}this._viewport.queueCommand(function(){if(this._evt.tdx!==0&&this._evt.tdy!==0){this._viewport.pan(d,a);}if((d<10&&a<10&&z!=0&&z!=1.0)&&this._evt.tdd!==0){this._viewport.zoom(z);}}.bind(this));break;default:break;}this._nomenu=true;e.handled=true;}};
V.prototype.endGesture=function(e){if(this._gesture){var x=e.x-this._rect.x,y=e.y-this._rect.y;q.sap.log.debug("Loco: endGesture: "+x+", "+y);this._viewport.queueCommand(function(){this._viewport.endGesture();}.bind(this));this._gesture=false;e.handled=true;}};
V.prototype.click=function(e){if(this._inside(e)&&e.buttons<=1){var x=e.x-this._rect.x,y=e.y-this._rect.y;q.sap.log.debug("Loco: click: "+(x)+", "+(y));this._viewport.queueCommand(function(){this._viewport.tap(x,y,false);}.bind(this));e.handled=true;}};
V.prototype.doubleClick=function(e){if(this._inside(e)&&e.buttons<=1){var x=e.x-this._rect.x,y=e.y-this._rect.y;q.sap.log.debug("Loco: doubleClick: "+(x)+", "+(y));this._viewport.queueCommand(function(){this._viewport.tap(x,y,true);}.bind(this));e.handled=true;}};
V.prototype.contextMenu=function(e){if(this._inside(e)||this._nomenu||e.buttons==5){this._nomenu=false;e.handled=true;}};
V.prototype.keyEventHandler=function(e){};
V.prototype.getViewport=function(){return this._viewport;};
return V;},true);
sap.ui.predefine('sap/ui/vk/ViewportRenderer',["jquery.sap.global"],function(q){"use strict";var V={};
V.render=function(r,c){r.write("<div");r.writeControlData(c);r.addClass("sapVizKitViewport");r.writeClasses();r.writeAttribute("tabindex",0);var a=false;var w=c.getWidth();if(w){r.addStyle("width",w);a=true;}var h=c.getHeight();if(h){r.addStyle("height",h);a=true;}if(a){r.writeStyles();}r.write(">");r.write("</div>");};
return V;},true);
jQuery.sap.registerPreloadedModules({
"name":"sap/ui/vk/library-preload",
"version":"2.0",
"modules":{
	"sap/ui/vk/manifest.json":'{\n  "_version": "1.2.0",\n  "sap.app": {\n    "_version": "1.2.0",\n    "id": "sap.ui.vk",\n    "type": "library",\n    "embeds": [],\n    "applicationVersion": {\n      "version": "1.48.2"\n    },\n    "title": "SAPUI5 Visualization Toolkit.",\n    "description": "SAPUI5 Visualization Toolkit.",\n    "resources": "resources.json",\n    "offline": true\n  },\n  "sap.ui": {\n    "_version": "1.1.0",\n    "technology": "UI5",\n    "supportedThemes": [\n      "base",\n      "sap_belize",\n      "sap_belize_plus",\n      "sap_bluecrystal",\n      "sap_goldreflection",\n      "sap_hcb"\n    ]\n  },\n  "sap.ui5": {\n    "_version": "1.1.0",\n    "dependencies": {\n      "minUI5Version": "1.48",\n      "libs": {\n        "sap.ui.core": {\n          "minVersion": "1.48.0"\n        },\n        "sap.ui.unified": {\n          "minVersion": "1.48.0",\n          "lazy": true\n        },\n        "sap.m": {\n          "minVersion": "1.48.0",\n          "lazy": true\n        },\n        "sap.ui.layout": {\n          "minVersion": "1.48.0",\n          "lazy": true\n        }\n      }\n    }\n  }\n}'
}});
//# sourceMappingURL=library-preload.js.map